<!DOCTYPE html>
<!-- Quantum Nexus v6.31 - Full sound system, tournaments, settings, VIP store, Change name -->
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Nexus v6.31</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0a0e27;
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent !important;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        * {
            -webkit-tap-highlight-color: transparent !important;
            -webkit-focus-ring-color: transparent !important;
            -webkit-touch-callout: none !important;
        }
        
        button:focus,
        button:active {
            outline: none !important;
            box-shadow: none !important;
            border: none !important;
        }
        
        .tap-button:focus,
        .tap-button:active,
        .tap-button:focus-visible {
            outline: none !important;
            box-shadow: none !important;
            border: none !important;
        }
        
        /* Prevent all visual selection highlights */
        .tap-button,
        .tap-button * {
            -webkit-tap-highlight-color: transparent !important;
            -webkit-touch-callout: none !important;
            user-select: none !important;
            -webkit-user-select: none !important;
            -ms-user-select: none !important;
            -moz-user-select: none !important;
            -webkit-focus-ring-color: transparent !important;
        }
        
        /* Remove all possible focus states */
        button.tap-button:hover,
        button.tap-button:active,
        button.tap-button:focus,
        button.tap-button:focus-visible,
        button.tap-button:focus-within,
        button.tap-button:visited {
            outline: none !important;
            border: none !important;
            box-shadow: none !important;
            -webkit-tap-highlight-color: transparent !important;
            -webkit-touch-callout: none !important;
        }
        
        /* Extra protection for Telegram WebView */
        html, body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent !important;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 30%, rgba(102, 126, 234, 0.05) 50%, transparent 70%),
                radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(118, 75, 162, 0.1) 0%, transparent 50%);
            pointer-events: none;
            animation: drift 20s linear infinite;
        }

        @keyframes drift {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(-20px); }
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #667eea, transparent);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 3s ease-in-out infinite;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.5)); }
            50% { filter: drop-shadow(0 0 20px rgba(118, 75, 162, 0.8)); }
        }
        
        /* VIP Styles */
        .vip-container {
            position: relative;
        }
        
        .vip-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        
        @keyframes vip-float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        
        .vip-golden-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                rgba(255, 215, 0, 0.12) 0%,
                rgba(255, 255, 255, 0.05) 25%,
                rgba(255, 215, 0, 0.10) 50%,
                rgba(255, 255, 255, 0.07) 75%,
                rgba(255, 215, 0, 0.12) 100%
            );
            background-size: 400% 400%;
            animation: vip-gradient 15s ease infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        .vip-premium-shine {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(255, 255, 255, 0.03) 0%, transparent 50%);
            animation: vip-premium-shine 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes vip-premium-shine {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        .vip-top-leaders {
            position: fixed;
            top: 10px;
            left: 10px;
            width: 140px;
            background: rgba(0, 0, 0, 0.65);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 215, 0, 0.35);
            border-radius: 12px;
            padding: 12px;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.25);
        }
        
        .vip-profile-icon {
            position: relative;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #a78bfa, #c084fc, #d946ef);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 3px solid rgba(255, 255, 255, 0.4);
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 0 20px rgba(167, 139, 250, 0.6), 0 4px 15px rgba(167, 139, 250, 0.5);
            transition: all 0.3s ease;
            overflow: hidden;
            animation: vip-icon-glow 2s ease-in-out infinite;
        }
        
        @keyframes vip-icon-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(167, 139, 250, 0.6), 0 4px 15px rgba(167, 139, 250, 0.5); }
            50% { box-shadow: 0 0 30px rgba(167, 139, 250, 0.9), 0 6px 20px rgba(167, 139, 250, 0.8); }
        }
        
        .vip-profile-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .vip-profile-icon:hover {
            transform: scale(1.12);
            box-shadow: 0 0 35px rgba(217, 70, 239, 0.8), 0 8px 25px rgba(217, 70, 239, 0.7);
        }
        
        .vip-top-button {
            position: relative;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
            transition: all 0.3s ease;
        }
        
        .vip-top-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.7);
        }
        
        @keyframes vip-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .vip-aura {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,215,0,0.3), transparent);
            animation: vip-aura-pulse 3s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes vip-aura-pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.2; }
        }
        
        .vip-rainbow-border {
            border: 3px solid;
            border-image: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3) 1;
            animation: vip-rainbow 3s linear infinite;
        }
        
        @keyframes vip-rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        
        .vip-shine-effect {
            position: relative;
            overflow: hidden;
        }
        
        .vip-shine-effect::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent);
            animation: vip-shine 3s ease-in-out infinite;
        }
        
        @keyframes vip-shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .vip-glow-box {
            box-shadow: 0 0 30px rgba(255,215,0,0.8), 
                        0 0 60px rgba(255,215,0,0.5),
                        0 0 90px rgba(255,215,0,0.3);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
            20%, 40%, 60%, 80% { transform: translateX(3px); }
        }
        
        @keyframes shine-btn {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes premium-pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), 0 0 60px rgba(255, 140, 0, 0.4); }
            50% { transform: scale(1.03); box-shadow: 0 0 40px rgba(255, 215, 0, 0.8), 0 0 80px rgba(255, 140, 0, 0.6); }
        }

        .stats {
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(26, 29, 46, 0.9) 100%);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 12px;
            margin-bottom: 16px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        .stats::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
            position: relative;
            z-index: 1;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #f093fb;
            text-shadow: 0 0 10px rgba(240, 147, 251, 0.3);
        }

        .stat-compact-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 8px;
        }

        .stat-item-compact {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 8px;
            text-align: center;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        .stat-main-value {
            font-size: 18px;
            font-weight: 900;
            color: #fff;
            margin-bottom: 2px;
        }

        .stat-passive-value {
            font-size: 10px;
            color: #4ade80;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .stat-label-small {
            font-size: 12px;
            color: #94a3b8;
        }

        .energy-bar-container {
            padding-top: 15px;
        }

        .energy-bar {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 5px;
            position: relative;
        }

        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .energy-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: energyFlow 2s infinite;
        }

        @keyframes energyFlow {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .energy-regen {
            font-size: 12px;
            color: #4ade80;
            margin-top: 5px;
            text-align: center;
        }

        .buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .btn {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(102, 126, 234, 0.4);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 600;
            color: white;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%);
            border-color: rgba(102, 126, 234, 0.6);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
        }

        .btn-emoji {
            font-size: 32px;
            filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.3));
        }

        .tap-button {
            width: 280px;
            height: 280px;
            margin: 30px auto;
            border-radius: 50%;
            position: relative;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
            border: 4px solid transparent;
            cursor: pointer;
            box-shadow: 0 15px 50px rgba(102, 126, 234, 0.3);
            transition: all 0.08s cubic-bezier(0.25, 1.8, 0.75, 0.5);
            user-select: none;
            -webkit-tap-highlight-color: transparent !important;
            -webkit-touch-callout: none;
            animation: pulse 2s ease-in-out infinite;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            outline: none !important;
            -webkit-focus-ring-color: transparent !important;
        }

        .tap-button svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 20px rgba(255, 192, 203, 0.6));
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 15px 50px rgba(102, 126, 234, 0.5), 0 0 0 0 rgba(102, 126, 234, 0.4);
                border-color: rgba(102, 126, 234, 0.6);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 20px 60px rgba(102, 126, 234, 0.7), 0 0 40px 20px rgba(102, 126, 234, 0.3);
                border-color: rgba(240, 147, 251, 0.8);
            }
        }
        
        @keyframes tapPress {
            0% { 
                transform: scale(1);
                filter: brightness(1);
            }
            15% {
                transform: scale(0.92);
                filter: brightness(1.1);
            }
            30% {
                transform: scale(1.03);
                filter: brightness(1.08);
            }
            50% {
                transform: scale(0.99);
                filter: brightness(1.05);
            }
            70% {
                transform: scale(1.02);
                filter: brightness(1.04);
            }
            100% {
                transform: scale(1);
                filter: brightness(1);
            }
        }
        
        @keyframes neonBurst {
            0% {
                box-shadow: 0 0 0 0 rgba(240, 147, 251, 0);
            }
            50% {
                box-shadow: 0 0 0 20px rgba(240, 147, 251, 0), 0 0 0 40px rgba(102, 126, 234, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(240, 147, 251, 0), 0 0 0 0 rgba(102, 126, 234, 0);
            }
        }
        
        .tap-button.tap-pressed {
            animation: tapPress 0.3s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .tap-button::before {
            content: '';
            position: absolute;
            inset: -10px;
            border-radius: 50%;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.6), rgba(118, 75, 162, 0.6));
            filter: blur(20px);
            opacity: 0;
            animation: neonPulse 2s ease-in-out infinite;
        }
        
        .tap-button::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            filter: blur(15px);
            opacity: 0;
            animation: neonPulse 2s ease-in-out infinite 0.3s;
        }
        
        @keyframes neonPulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }

        /* Offline Income Notice */
        .offline-notice {
            background: linear-gradient(135deg, rgba(76, 222, 128, 0.2) 0%, rgba(34, 197, 94, 0.2) 100%);
            border: 1px solid rgba(76, 222, 128, 0.5);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Withdraw Section */
        .withdraw-section {
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(26, 29, 46, 0.9) 100%);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .withdraw-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #f093fb;
        }

        .withdraw-info {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .input-group {
            margin-bottom: 10px;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 14px;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .action-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
            backdrop-filter: blur(8px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: linear-gradient(135deg, #0a0e27 0%, #1a1d2e 100%);
            border: 1px solid rgba(102, 126, 234, 0.5);
            border-radius: 20px;
            padding: 20px;
            max-width: 400px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            position: relative;
        }

        /* .modal-content::before - Removed to fix double border issue */

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .close-btn {
            background: linear-gradient(135deg, rgba(239,68,68,0.3), rgba(220,38,38,0.3)) !important;
            border: 2px solid rgba(239,68,68,0.5) !important;
            border-radius: 50% !important;
            width: 42px !important;
            height: 42px !important;
            cursor: pointer !important;
            color: #fff !important;
            font-size: 22px !important;
            font-weight: 900 !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            transition: all 0.3s cubic-bezier(0.34, 1.56, 0.64, 1) !important;
            position: absolute !important;
            top: 15px !important;
            right: 15px !important;
            z-index: 1000 !important;
            box-shadow: 0 4px 15px rgba(239,68,68,0.3), inset 0 0 20px rgba(239,68,68,0.2) !important;
            text-shadow: 0 0 10px rgba(255,255,255,0.5) !important;
        }

        .close-btn:hover {
            background: linear-gradient(135deg, rgba(239,68,68,0.5), rgba(220,38,38,0.5)) !important;
            transform: scale(1.15) rotate(90deg) !important;
            box-shadow: 0 6px 25px rgba(239,68,68,0.6), inset 0 0 30px rgba(239,68,68,0.4) !important;
        }
        
        .close-btn:active {
            transform: scale(0.95) rotate(90deg) !important;
        }


        /* ¦áTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ ¦+¦¬TÏ ¦¦¦-TÂ¦¦¦¦¦-TÀ¦¬¦¦ */
        .category-close-btn {
            width: 100%;
            padding: 16px 24px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: #fff;
            border: 2px solid rgba(255,255,255,0.2);
            border-radius: 16px;
            cursor: pointer;
            font-weight: 800;
            font-size: 16px;
            margin-top: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.4);
            text-shadow: 0 1px 3px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .category-close-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 25px rgba(102, 126, 234, 0.6);
            background: linear-gradient(135deg, #5a67d8, #6b46c1);
            border-color: rgba(255,255,255,0.3);
        }

        .category-close-btn:active {
            transform: translateY(-1px);
        }

        /* VIP TÁTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ */
        .vip-close-btn {
            width: 100%;
            padding: 14px 20px;
            background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700);
            color: #000;
            border: 2px solid #ffd700;
            border-radius: 14px;
            cursor: pointer;
            font-weight: 800;
            font-size: 16px;
            margin-top: 20px;
            transition: all 0.3s ease;
            box-shadow: 0 6px 20px rgba(255, 215, 0, 0.4);
            position: relative;
            overflow: hidden;
            text-shadow: 0 1px 3px rgba(0,0,0,0.2);
        }

        .vip-close-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 35px rgba(255, 215, 0, 0.7);
            background: linear-gradient(135deg, #ffed4e, #ffd700, #ffed4e);
        }

        .vip-close-btn:active {
            transform: translateY(-1px);
        }

        .vip-close-btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.6), transparent);
            transition: left 0.6s;
        }

        .vip-close-btn:hover::before {
            left: 100%;
        }

        /* ¦Ð¦-¦¬¦-¦-TÆ¦¬TÏ ¦¬TÃ¦¬TÌTÁ¦-TÆ¦¬¦¬ ¦+¦¬TÏ VIP ¦¬¦-¦¦¦¬¦+TË */
        @keyframes pulse {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.1); }
        }

        @keyframes shimmer {
            0% { background-position: -200% 0; }
            100% { background-position: 200% 0; }
        }

        .shop-category {
            margin-bottom: 20px;
        }

        .category-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #f093fb;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.2), transparent);
            transition: left 0.5s;
        }

        .item:hover::before {
            left: 100%;
        }

        .item:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.6);
            transform: translateX(5px);
        }

        .item-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .item-emoji {
            font-size: 24px;
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .item-desc {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .item-price {
            font-size: 14px;
            color: #f093fb;
            font-weight: bold;
        }

        .mining-machine {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .machine-tag {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: bold;
        }

        .machine-tag.free {
            background: rgba(76, 222, 128, 0.2);
            color: #4ade80;
            border: 1px solid #4ade80;
        }

        .machine-tag.premium {
            background: rgba(240, 147, 251, 0.2);
            color: #f093fb;
            border: 1px solid #f093fb;
        }

        .machine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        .machine-name {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .machine-level {
            font-size: 14px;
            opacity: 0.8;
        }

        .machine-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 14px;
        }

        .stat-item {
            background: rgba(102, 126, 234, 0.1);
            padding: 8px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            font-size: 11px;
            opacity: 0.7;
            margin-bottom: 4px;
        }

        .stat-value {
            font-weight: bold;
            color: #f093fb;
        }

        .card-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .card-glow {
            position: absolute;
            inset: -2px;
            border-radius: 15px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card-item:hover .card-glow {
            opacity: 1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .card-name {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-level {
            font-size: 14px;
            opacity: 0.8;
        }

        .card-stats {
            display: flex;
            gap: 15px;
            font-size: 14px;
        }

        .stats-window {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .stats-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
        }

        .stats-row:last-child {
            border-bottom: none;
        }

        .stats-label {
            opacity: 0.8;
        }

        .stats-value {
            font-weight: bold;
            color: #f093fb;
        }

        .referral-link {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            padding: 12px;
            margin: 10px 0;
            font-family: monospace;
            word-break: break-all;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .referral-benefits {
            background: rgba(76, 222, 128, 0.1);
            border: 1px solid rgba(76, 222, 128, 0.3);
            border-radius: 10px;
            padding: 12px;
            margin: 10px 0;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            font-size: 14px;
        }

        @keyframes coinFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px) scale(0.5);
            }
        }

        .coin-animation {
            position: fixed;
            font-size: 32px;
            font-weight: 900;
            pointer-events: none;
            animation: coinFloat 2s ease-out forwards;
            z-index: 9999;
            color: #ffd700;
            text-shadow: 
                0 0 10px rgba(255, 215, 0, 1),
                0 0 20px rgba(255, 215, 0, 0.8),
                0 0 30px rgba(255, 215, 0, 0.6),
                0 0 40px rgba(255, 215, 0, 0.4),
                0 0 50px rgba(255, 215, 0, 0.2);
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 1));
            will-change: transform, opacity, filter;
        }

        @keyframes coinFloat {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0.5) rotate(0deg);
                filter: blur(0px) brightness(1);
            }
            10% {
                opacity: 1;
                transform: translate(-50%, -80%) scale(0.7) rotate(90deg);
                filter: blur(0px) brightness(1.2);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -120%) scale(0.9) rotate(180deg);
                filter: blur(0px) brightness(1.3);
            }
            30% {
                opacity: 1;
                transform: translate(-50%, -170%) scale(1.1) rotate(270deg);
                filter: blur(1px) brightness(1.2);
            }
            40% {
                opacity: 1;
                transform: translate(-50%, -230%) scale(1.3) rotate(360deg);
                filter: blur(1px) brightness(1.1);
            }
            50% {
                opacity: 1;
                transform: translate(-50%, -300%) scale(1.5) rotate(450deg);
                filter: blur(2px) brightness(1);
            }
            60% {
                opacity: 0.9;
                transform: translate(-50%, -380%) scale(1.7) rotate(540deg);
                filter: blur(2px) brightness(0.9);
            }
            70% {
                opacity: 0.7;
                transform: translate(-50%, -470%) scale(1.9) rotate(630deg);
                filter: blur(3px) brightness(0.7);
            }
            80% {
                opacity: 0.5;
                transform: translate(-50%, -570%) scale(2.1) rotate(720deg);
                filter: blur(4px) brightness(0.5);
            }
            90% {
                opacity: 0.3;
                transform: translate(-50%, -680%) scale(2.3) rotate(810deg);
                filter: blur(5px) brightness(0.3);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -800%) scale(2.5) rotate(900deg);
                filter: blur(6px) brightness(0);
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header" style="position: relative;">
            <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px;">
                <div class="vip-top-button" style="width: 45px; height: 45px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 24px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5); transition: all 0.3s; flex-shrink: 0;" onclick="openVIPTopLeaders();" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">¨ßÏÆ</div>
                
                <h1 id="mainTitle" style="margin: 0; text-align: center; font-size: 26px; white-space: nowrap;">Quantum Nexus</h1>
                
                <div class="vip-profile-icon" style="width: 45px; height: 45px; background: linear-gradient(135deg, #a78bfa, #c084fc); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 24px; box-shadow: 0 4px 15px rgba(167, 139, 250, 0.5); transition: all 0.3s; flex-shrink: 0;" onclick="openVIPProfileModal();" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">¨ßÑä</div>
            </div>
            
            <div id="vipPrivileges" style="display:none;margin-top:5px;font-size:11px;color:#94a3b8;"></div>
        </div>

        <!-- Offline Income Popup -->
        <div id="offlinePopup" class="modal">
            <div class="modal-content" style="max-width: 350px;">
                <div class="modal-header">
                    <div class="modal-title">¨ßÒ- ¦ÞTÄTÄ¦¬¦-¦¦¦- ¦+¦-TÅ¦-¦+</div>
                    <button class="close-btn" onclick="closeModal('offlinePopup')">òÜÕ</button>
                </div>
                <div id="offlineContent"></div>
            </div>
        </div>

        <div class="stats">
            <div class="stat-compact-row">
                <div class="stat-item-compact">
                    <div class="stat-main-value" id="coins">0</div>
                    <div class="stat-passive-value" id="passiveCoins">+0/TÇ¦-TÁ</div>
                    <div class="stat-label-small">¨ßÒ- ¦Ú¦-¦¬¦-TË</div>
                </div>
                <div class="stat-item-compact">
                    <div class="stat-main-value" id="quanhash">0</div>
                    <div class="stat-passive-value" id="passiveHash">+0/TÇ¦-TÁ</div>
                    <div class="stat-label-small">¨ßÒÎ QuanHash</div>
                </div>
            </div>
            <div class="energy-bar-container" style="margin-bottom: 16px;">
                <div class="energy-bar-wrapper" style="position: relative; background: linear-gradient(135deg, rgba(15,15,30,0.92), rgba(20,20,35,0.95)); border: 2px solid rgba(118,75,162,0.4); border-radius: 18px; padding: 16px 12px; box-shadow: 0 0 30px rgba(118,75,162,0.3), 0 4px 20px rgba(0,0,0,0.5); width: 100%;">
                    <!-- Ultra-wide progress bar with everything inside -->
                    <div class="energy-bar" style="width: 100%; height: 44px; background: rgba(0,0,0,0.4); border-radius: 14px; overflow: visible; position: relative; box-shadow: inset 0 2px 10px rgba(0,0,0,0.7), 0 0 10px rgba(118,75,162,0.2); border: 1px solid rgba(118,75,162,0.3);">
                        <!-- Energy fill with tap button colors (soft purple gradient) -->
                        <div class="energy-fill" id="energy-bar-fill" style="width: 0%; height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #8b5cf6 100%); box-shadow: 0 0 30px rgba(102,126,234,0.6), inset 0 0 20px rgba(118,75,162,0.3), 0 2px 10px rgba(102,126,234,0.4); position: absolute; top: 0; left: 0; transition: width 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); border-radius: 12px;">
                            <!-- Soft shine effect -->
                            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%); animation: softShine 3s infinite; border-radius: 12px;"></div>
                        </div>
                        
                        <!-- Label: Energy - Value - Percentage with soft readable text -->
                        <div style="position: absolute; top: 50%; left: 0; right: 0; transform: translateY(-50%); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; pointer-events: none; z-index: 10;">
                            <div style="font-size: 13px; font-weight: 700; color: #a78bfa; text-shadow: 0 1px 3px rgba(0,0,0,0.8), 0 0 10px rgba(167,139,250,0.5); letter-spacing: 0.3px;">òÚá ¦í¦-¦¦TÀ¦¦¦¬TÏ</div>
                            <div id="energy-text" style="font-size: 15px; font-weight: 800; color: #fff; text-shadow: 0 1px 4px rgba(0,0,0,1), 0 0 15px rgba(255,255,255,0.6); letter-spacing: 0.5px; font-variant-numeric: tabular-nums;">0/1000</div>
                            <div id="energy-percent" style="font-size: 13px; font-weight: 700; color: #86efac; text-shadow: 0 1px 3px rgba(0,0,0,0.8), 0 0 10px rgba(134,239,172,0.5); letter-spacing: 0.3px;">0%</div>
                        </div>
                    </div>
                    
                    <!-- Regen info nicely positioned under the bar -->
                    <div class="energy-regen" id="energy-regen-text" style="text-align: center; margin-top: 12px; font-size: 12px; color: #86efac; font-weight: 800; text-shadow: 0 0 10px rgba(134,239,172,0.7); letter-spacing: 0.5px;">¦Ò¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¦¦-¦¬¦¦: +1/TÁ¦¦¦¦</div>
                </div>
                
                <style>
                    @keyframes softShine {
                        0% { transform: translateX(-150%); opacity: 0; }
                        20% { opacity: 0.4; }
                        80% { opacity: 0.4; }
                        100% { transform: translateX(350%); opacity: 0; }
                    }
                </style>
            </div>
            
            <!-- User Level and Rating Section -->
            <div class="level-rating-container" style="margin-bottom: 16px;">
                <div style="position: relative; background: linear-gradient(135deg, rgba(15,15,30,0.92), rgba(20,20,35,0.95)); border: 2px solid rgba(255,215,0,0.4); border-radius: 18px; padding: 16px 12px; box-shadow: 0 0 30px rgba(255,215,0,0.3), 0 4px 20px rgba(0,0,0,0.5); width: 100%;">
                    <!-- Level Progress Bar -->
                    <div style="margin-bottom: 16px;">
                        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px;">
                            <div style="font-size: 14px; font-weight: 800; color: #ffd700; text-shadow: 0 0 10px rgba(255,215,0,0.7);">òíÐ ¦ãTÀ¦-¦-¦¦¦-TÌ <span id="user-level">1</span></div>
                            <div style="font-size: 13px; font-weight: 700; color: #86efac; text-shadow: 0 0 10px rgba(134,239,172,0.7);"><span id="user-experience">0</span> / <span id="user-next-level-exp">100</span> ¦Þ¦ß</div>
                        </div>
                        <div style="width: 100%; height: 32px; background: rgba(0,0,0,0.4); border-radius: 14px; overflow: hidden; position: relative; box-shadow: inset 0 2px 10px rgba(0,0,0,0.7), 0 0 10px rgba(255,215,0,0.2); border: 1px solid rgba(255,215,0,0.3);">
                            <div id="level-progress-fill" style="width: 0%; height: 100%; background: linear-gradient(90deg, #ffd700 0%, #ffed4e 50%, #fff176 100%); box-shadow: 0 0 30px rgba(255,215,0,0.6), inset 0 0 20px rgba(255,215,0,0.3), 0 2px 10px rgba(255,215,0,0.4); position: absolute; top: 0; left: 0; transition: width 0.3s cubic-bezier(0.25, 0.46, 0.45, 0.94); border-radius: 12px;">
                                <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%); animation: softShine 3s infinite; border-radius: 12px;"></div>
                            </div>
                            <div style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 13px; font-weight: 900; color: #000; text-shadow: 0 1px 2px rgba(255,255,255,0.8); z-index: 10;" id="level-progress-percent">0%</div>
                        </div>
                    </div>
                    
                    <!-- Rating Display -->
                    <div style="display: flex; justify-content: space-between; align-items: center; padding-top: 12px; border-top: 1px solid rgba(255,215,0,0.2);">
                        <div style="font-size: 13px; font-weight: 700; color: #94a3b8; text-shadow: 0 0 10px rgba(148,163,184,0.5);">¨ßÏÆ ¦à¦¦¦¦TÂ¦¬¦-¦¦</div>
                        <div style="font-size: 16px; font-weight: 900; color: #ffd700; text-shadow: 0 0 15px rgba(255,215,0,0.7); letter-spacing: 0.5px; font-variant-numeric: tabular-nums;" id="user-rating">0</div>
                    </div>
                </div>
            </div>
            
            <!-- Autobot status display (no toggle button) -->
            <div id="autobotStatusSection" style="display: none; margin-top: 10px; opacity: 1; transition: opacity 0.3s ease;">
                <div id="autobotStatusBtn" style="width: 100%; padding: 12px 16px; background: linear-gradient(135deg, #10b981, #059669); color: #fff; border: none; border-radius: 10px; font-size: 13px; font-weight: 700; box-shadow: 0 4px 12px rgba(16,185,129,0.4); min-height: 44px; text-align: center;">
                    ¨ßäÖ ¦Ð¦-TÂ¦-¦-¦-TÂ ¦-¦¦TÂ¦¬¦-¦¦¦-
                </div>
            </div>
        </div>

        <button class="tap-button" onclick="tap(); return false;" type="button" style="outline:none!important;box-shadow:none!important;-webkit-tap-highlight-color:transparent!important;">
            <svg width="220" height="220" viewBox="0 0 220 220" style="width:100%;height:100%;">
                <defs>
                    <radialGradient id="tapGrad" cx="50%" cy="50%">
                        <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#764ba2;stop-opacity:0.9" />
                    </radialGradient>
                    <filter id="glow">
                        <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                        <feMerge>
                            <feMergeNode in="coloredBlur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                </defs>
                <circle cx="110" cy="110" r="100" fill="url(#tapGrad)" filter="url(#glow)" opacity="0.9"/>
                <circle cx="110" cy="110" r="90" fill="none" stroke="#f093fb" stroke-width="2" opacity="0.6"/>
                <text x="110" y="150" font-size="100" text-anchor="middle" fill="#fff" font-weight="bold" style="filter: drop-shadow(0 0 15px rgba(255, 192, 203, 0.8));">¨ßÒ-</text>
            </svg>
        </button>
        <div class="buttons">
            <a href="#" class="btn" onclick="openShop(event)">
                <div class="btn-emoji">¨ßÛÒ</div>
                <div>¦Ü¦-¦¦¦-¦¬¦¬¦-</div>
            </a>
            <a href="#" class="btn" onclick="openMining(event)">
                <div class="btn-emoji">¨ßÏí</div>
                <div>¦Ü¦-¦¦¦-¦¬¦-¦¦</div>
            </a>
            <a href="#" class="btn" onclick="openCards(event)">
                <div class="btn-emoji">¨ßÒ¦</div>
                <div>¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬</div>
            </a>
            <a href="#" class="btn" onclick="openSupport(event)" id="supportBtn" style="position:relative;">
                <div class="btn-emoji">¨ßÒì</div>
                <div>¦ß¦-¦+¦+¦¦TÀ¦¦¦¦¦-</div>
                <span id="supportBadge" style="display:none;position:absolute;top:5px;right:5px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;padding:3px 7px;border-radius:10px;font-size:11px;font-weight:700;box-shadow:0 2px 8px rgba(239,68,68,0.5);animation:pulse 2s ease-in-out infinite;">0</span>
            </a>
            <a href="#" class="btn" onclick="openReferrals(event)">
                <div class="btn-emoji">¨ßÑå</div>
                <div>¦à¦¦TÄ¦¦TÀ¦-¦¬TË</div>
            </a>
            <a href="#" class="btn" onclick="openWithdrawModal(event)">
                <div class="btn-emoji">¨ßÒ¬</div>
                <div>¦ÒTË¦-¦-¦+</div>
            </a>
            <a href="#" class="btn" onclick="openDailyBonus(event)">
                <div class="btn-emoji">¨ßÎÁ</div>
                <div>¦Õ¦¦¦¦¦+¦-¦¦¦-¦-TË¦¦ ¦¬¦-¦+¦-¦-¦¬TÏ</div>
            </a>
            <a href="#" class="btn" onclick="openBuyCurrency(event)" style="background:linear-gradient(135deg,rgba(255,215,0,0.3),rgba(255,140,0,0.3));border:2px solid rgba(255,215,0,0.6);box-shadow:0 4px 15px rgba(255,215,0,0.3);">
                <div class="btn-emoji">òíÐ</div>
                <div style="font-weight:700;">¦ÚTÃ¦¬¦¬TÂTÌ ¦-¦-¦¬TÎTÂTÃ</div>
            </a>
        </div>
    </div>

    <!-- Stats Modal -->
    <div id="statsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">¨ßÓÊ ¦áTÂ¦-TÂ¦¬TÁTÂ¦¬¦¦¦-</div>
                <button class="close-btn" onclick="closeModal('statsModal')">òÜÕ</button>
            </div>
            <div class="stats-window" id="statsContent"></div>
            
            <!-- ¦áTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ -->
            <button class="category-close-btn" onclick="closeModal('statsModal')">
                òÜÕ ¦×¦-¦¦TÀTËTÂTÌ TÁTÂ¦-TÂ¦¬TÁTÂ¦¬¦¦TÃ
            </button>
        </div>
    </div>

    <!-- Shop Modal -->
    <div id="shopModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">¨ßÛÒ ¦Ü¦-¦¦¦-¦¬¦¬¦-</div>
                <button class="close-btn" onclick="closeModal('shopModal')">òÜÕ</button>
            </div>
            <div class="shop-category">
                <div class="category-title">òÚá ¦ÑTÃTÁTÂTË</div>
                <div id="boostsList"></div>
            </div>
            <div class="shop-category">
                <div class="category-title">¨ßäÖ ¦Ð¦-TÂ¦-¦-¦-TÂ¦¬¦¬¦-TÆ¦¬TÏ</div>
                <div id="automationList"></div>
            </div>
            <div class="shop-category">
                <div class="category-title">òÚá ¦í¦-¦¦TÀ¦¦¦¬TÏ</div>
                <div id="energyList"></div>
            </div>
            <div class="shop-category">
                <div class="category-title">¨ßÒ¦ ¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬</div>
                <div id="cardsList"></div>
            </div>
            
            <!-- ¦áTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ ¦+¦¬TÏ TÁTÂ¦-TÀ¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦¬¦-¦- -->
            <button class="category-close-btn" onclick="closeModal('shopModal')">
                òÜÕ ¦×¦-¦¦TÀTËTÂTÌ ¦-¦-¦¦¦-¦¬¦¬¦-
            </button>
        </div>
    </div>

    <!-- Mining Modal -->
    <div id="miningModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">¨ßÏí ¦Ü¦-¦¦¦-¦¬¦-¦¦</div>
                <button class="close-btn" onclick="closeModal('miningModal')">òÜÕ</button>
            </div>
            <div id="machinesList"></div>
            <button class="btn" onclick="closeModal('miningModal'); openShop(event)">òÞÕ ¦ÚTÃ¦¬¦¬TÂTÌ ¦-¦-TÈ¦¬¦-TÃ</button>
            
            <!-- ¦áTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ -->
            <button class="category-close-btn" onclick="closeModal('miningModal')" style="margin-top: 15px;">
                òÜÕ ¦×¦-¦¦TÀTËTÂTÌ ¦-¦-¦¦¦-¦¬¦-¦¦
            </button>
        </div>
    </div>

    <!-- Cards Modal -->
    <div id="cardsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">¨ßÒ¦ ¦Ü¦-¦¬ ¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬</div>
                <button class="close-btn" onclick="closeModal('cardsModal')">òÜÕ</button>
            </div>
            <div id="myCardsList"></div>
            
            <!-- ¦áTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ -->
            <button class="category-close-btn" onclick="closeModal('cardsModal')">
                òÜÕ ¦×¦-¦¦TÀTËTÂTÌ ¦¦¦-TÀTÂ¦-TÇ¦¦¦¬
            </button>
        </div>
    </div>

    <!-- Withdraw Modal -->
    <div id="withdrawModal" class="modal">
        <div class="modal-content" style="max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">
                <div class="modal-title">¨ßÒ¬ ¦ÒTË¦-¦-¦+ TÁTÀ¦¦¦+TÁTÂ¦-</div>
                <button class="close-btn" onclick="closeModal('withdrawModal')">òÜÕ</button>
            </div>
            <div id="withdrawContent"></div>
            
            <!-- ¦áTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ -->
            <button class="category-close-btn" onclick="closeModal('withdrawModal')">
                òÜÕ ¦×¦-¦¦TÀTËTÂTÌ ¦-TË¦-¦-¦+
            </button>
        </div>
    </div>

    <!-- Referrals Modal -->
    <div id="referralsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">¨ßÑå ¦à¦¦TÄ¦¦TÀ¦-¦¬TÌ¦-¦-TÏ TÁ¦¬TÁTÂ¦¦¦-¦-</div>
                <button class="close-btn" onclick="closeModal('referralsModal')">òÜÕ</button>
            </div>
            <div class="referral-benefits">
                <div class="benefit-item">òÜÅ 5% ¦¬¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+ ¦-TÂ ¦¬TÀ¦¬¦¦¦¬¦-TÈ¦¦¦-¦-TËTÅ</div>
                <div class="benefit-item">¨ßÎÁ 100 ¨ßêÙ ¦¬¦- ¦¦¦-¦¦¦+¦-¦¦¦- TÀ¦¦TÄ¦¦TÀ¦-¦¬¦-</div>
                <div class="benefit-item">¨ßÒ- ¦Ô¦-TÅ¦-¦+ ¦- TÀ¦¦¦-¦¬TÌ¦-¦-¦- ¦-TÀ¦¦¦-¦¦¦-¦¬</div>
            </div>
            <div class="stats-window">
                <div class="stats-row">
                    <span class="stats-label">¦à¦¦TÄ¦¦TÀ¦-¦¬¦-¦-</span>
                    <span class="stats-value" id="refCount">0</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">¦à¦¦TÄ¦¦TÀ¦-¦¬TÌ¦-TË¦¦ ¦+¦-TÅ¦-¦+</span>
                    <span class="stats-value" id="refIncome">0 ¨ßêÙ</span>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <div style="margin-bottom: 10px; font-weight: bold;">¦Ò¦-TÈ¦- TÀ¦¦TÄ¦¦TÀ¦-¦¬TÌ¦-¦-TÏ TÁTÁTË¦¬¦¦¦-:</div>
                <div class="referral-link" id="refLink">-</div>
                <button class="btn" onclick="copyRefLink()">¨ßÓË ¦Ú¦-¦¬¦¬TÀ¦-¦-¦-TÂTÌ TÁTÁTË¦¬¦¦TÃ</button>
            </div>
            
            <!-- ¦áTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ -->
            <button class="category-close-btn" onclick="closeModal('referralsModal')">
                òÜÕ ¦×¦-¦¦TÀTËTÂTÌ TÀ¦¦TÄ¦¦TÀ¦-¦¬TË
            </button>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // Make user globally available
        window.user = tg.initDataUnsafe?.user;
        if (window.user) {
            const usernameEl = document.getElementById('username');
            if (usernameEl) {
                usernameEl.textContent = window.user.first_name || '¦Ü¦-¦¦¦-¦¦TÀ';
            }
        }

        let energyRegenInterval;
        

        // VIP Status Management
        function loadVIPStatus(userData) {
            const vipLevel = userData.vip_level || 0;
            const vipBadge = userData.vip_badge || '';
            const hasPremium = userData.has_premium_support || false;
            const hasGolden = userData.has_golden_profile || false;
            const hasTop = userData.has_top_place || false;
            const hasUnique = userData.has_unique_design || false;
            
            // Buttons are now in the header, no need to add them dynamically
            
            if (vipLevel > 0) {
                const badgeEl = document.getElementById('vipBadge');
                const privEl = document.getElementById('vipPrivileges');
                
                // VIP badge display
                const badges = {
                    'bronze_vip': '¨ßåÉ BRONZE VIP',
                    'silver_vip': '¨ßåÈ SILVER VIP',
                    'gold_vip': '¨ßåÇ GOLD VIP',
                    'platinum_vip': '¨ßÒÎ PLATINUM VIP',
                    'diamond_vip': '¨ßÒà DIAMOND VIP',
                    'absolute_vip': '¨ßÑÑ ABSOLUTE VIP'
                };
                
                if (badgeEl && vipBadge && vipLevel > 0) {
                    badgeEl.innerHTML = '<span style="background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;padding:4px 10px;border-radius:8px;font-size:10px;font-weight:700;">' + (badges[vipBadge] || 'VIP') + '</span>';
                    badgeEl.style.display = 'inline';
                } else if (badgeEl) {
                    badgeEl.style.display = 'none';
                }
                
                // VIP privileges display
                if (privEl) {
                    const privs = [];
                    if (hasPremium && vipLevel > 0) privs.push('òíÐ Premium Support');
                    if (hasGolden && vipLevel > 0) privs.push('¨ßÌß Golden Profile');
                    if (hasTop && vipLevel > 0) privs.push('¨ßÏÆ Top Place');
                    if (hasUnique && vipLevel > 0) privs.push('òÜè Unique Design');
                    
                    if (privs.length > 0) {
                        privEl.textContent = privs.join(' òÀâ ');
                        privEl.style.display = 'block';
                    } else {
                        privEl.style.display = 'none';
                    }
                }
                
                // Apply VIP styling to header
                if (hasGolden && document.getElementById('mainTitle')) {
                    document.getElementById('mainTitle').style.background = 'linear-gradient(135deg, #ffd700, #ffed4e)';
                    document.getElementById('mainTitle').style.webkitBackgroundClip = 'text';
                    document.getElementById('mainTitle').style.webkitTextFillColor = 'transparent';
                    document.getElementById('mainTitle').style.filter = 'drop-shadow(0 0 20px rgba(255,215,0,0.5))';
                }
                
                // Add VIP premium background effect
                if (vipLevel >= 3) {
                    let bgExists = document.querySelector('.vip-golden-bg');
                    if (!bgExists) {
                        const goldenBg = document.createElement('div');
                        goldenBg.className = 'vip-golden-bg';
                        document.body.appendChild(goldenBg);
                        
                        // Add premium shine effect
                        const premiumShine = document.createElement('div');
                        premiumShine.className = 'vip-premium-shine';
                        document.body.appendChild(premiumShine);
                    }
                }
                
                // Add VIP particle effects
                if (vipLevel >= 4) {
                    startVIPParticles();
                }
                
                // Add Aura effect for VIP level 6
                if (vipLevel >= 6) {
                    addVIPAura();
                    addRainbowEffects();
                }
                
                // Apply VIP glow to all clickable elements
                if (vipLevel >= 3) {
                    document.querySelectorAll('.btn, .tap-button').forEach(el => {
                        el.classList.add('vip-glow-box');
                    });
                }
                
                // Show VIP sections if user has appropriate level
                if (vipLevel >= 5) {
                    showVIPMiningSection();
                }
                
                if (vipLevel >= 4) {
                    showVIPEventsSection();
                }
            }
        }
        
        function showVIPMiningSection() {
            // This will be called when VIP user opens mining modal
            const miningModal = document.getElementById('miningModal2');
            if (miningModal && !miningModal.querySelector('#vipMiningSection')) {
                const vipSection = document.createElement('div');
                vipSection.innerHTML = document.getElementById('vipMiningSection')?.innerHTML || '';
                if (miningModal.querySelector('.machinesList')) {
                    miningModal.querySelector('.machinesList').appendChild(vipSection);
                }
            }
        }
        
        function showVIPEventsSection() {
            // VIP events accessible from menu
            // Will be integrated into main interface
        }
        function openVIPProfileModal() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(userData => {
                const vipLevel = userData.vip_level || 0;
                const badges = {
                    'bronze_vip': '¨ßåÉ BRONZE VIP',
                    'silver_vip': '¨ßåÈ SILVER VIP',
                    'gold_vip': '¨ßåÇ GOLD VIP',
                    'platinum_vip': '¨ßÒÎ PLATINUM VIP',
                    'diamond_vip': '¨ßÒà DIAMOND VIP',
                    'absolute_vip': '¨ßÑÑ ABSOLUTE VIP'
                };
                
                const savedPhoto = localStorage.getItem('vip_profile_photo') || '';
                const photoPlaceholder = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiM2NjdFZUEiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiM3NjRCRUEiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgZmlsbD0idXJsKCNnKSIgcng9IjUwJSIvPjx0ZXh0IHg9IjYwIiB5PSI2NSIgZm9udC1zaXplPSI1MCIgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iIGZvbnQtZmFtaWx5PSJBcmlhbCI+4piCPC90ZXh0Pjwvc3ZnPg==';
                
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.style.zIndex = '10000';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 400px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;border: 2px solid rgba(167,139,250,0.4);box-shadow: 0 10px 40px rgba(167,139,250,0.3);">
                        <div style="background:linear-gradient(135deg,#a78bfa,#c084fc,#d946ef);padding:24px;border-radius:22px 22px 0 0;text-align:center;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px;">
                                <h2 style="font-size: 24px; color: #fff; margin: 0; font-weight: 900;">¨ßÑÑ ${userData.username || '¦Ü¦-¦¦¦-¦¦TÀ'}</h2>
                                <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                            </div>
                            
                            <div style="position:relative;width:110px;height:110px;margin:0 auto 18px;border-radius:50%;background:linear-gradient(135deg,#a78bfa,#c084fc,#d946ef);padding:4px;cursor:pointer;transition:all 0.3s ease;" onclick="document.getElementById('photoInput').click()" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                <img id="profilePhoto" src="${savedPhoto || photoPlaceholder}" style="width:100%;height:100%;border-radius:50%;object-fit:cover;border:3px solid rgba(255,255,255,0.3);">
                                <div style="position:absolute;bottom:0;right:0;width:36px;height:36px;background:#000;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;border:3px solid #fff;box-shadow:0 2px 10px rgba(0,0,0,0.3);">¨ßÓ¬</div>
                            </div>
                            <input type="file" id="photoInput" accept="image/*" style="display:none;" onchange="handlePhotoUpload(event)">
                            
                            <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:12px;color:#fff;margin-bottom:10px;">
                                <div style="font-size:18px;font-weight:900;color:#fff;">${vipLevel > 0 ? (badges[userData.vip_badge || ''] || 'VIP') + ' (¦ãTÀ¦-¦-¦¦¦-TÌ ' + vipLevel + ')' : '¦Þ¦-TËTÇ¦-TË¦¦ ¦¬¦¦TÀ¦-¦¦'}</div>
                                <div style="font-size:13px;margin-top:5px;opacity:0.8;color:#fff;">${userData.username || '¦Ü¦-¦¦¦-¦¦TÀ'}</div>
                            </div>
                        </div>
                        
                        <div style="padding:20px;">
                            ${vipLevel >= 3 ? `
                            <div style="background:linear-gradient(135deg,rgba(255,215,0,0.1),rgba(255,255,255,0.05));padding:12px;border-radius:12px;border:1px solid rgba(255,215,0,0.2);margin-bottom:12px;">
                                <div style="font-size:13px;font-weight:700;margin-bottom:8px;color:#ffd700;">òÜè VIP ¦ß¦à¦Ø¦Ò¦Ø¦Û¦Õ¦Ó¦Ø¦Ø</div>
                                <div style="font-size:11px;color:#fff;line-height:1.8;">
                                    ${userData.has_premium_support ? 'òíÐ Premium Support ' : ''}
                                    ${userData.has_golden_profile ? '¨ßÌß Golden Profile ' : ''}
                                    ${userData.has_top_place ? '¨ßÏÆ Top Place ' : ''}
                                    ${userData.has_unique_design ? 'òÜè Unique Design' : ''}
                                </div>
                            </div>
                            ` : `
                            <button onclick="openBuyVIPModal(); this.closest('.modal').remove();" style="width:100%;padding:14px;background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;border:none;border-radius:12px;cursor:pointer;font-weight:800;font-size:15px;margin-bottom:15px;box-shadow:0 4px 15px rgba(255,215,0,0.5);">¨ßÑÑ ¦ÚTÃ¦¬¦¬TÂTÌ VIP</button>
                            `}
                            
                            <div style="background:rgba(0,0,0,0.2);padding:15px;border-radius:12px;margin-bottom:15px;border:1px solid rgba(255,255,255,0.2);">
                                <div style="font-size:14px;font-weight:700;margin-bottom:12px;color:#fff;text-align:center;">¨ßÓÊ ¦á¦â¦Ð¦â¦Ø¦á¦â¦Ø¦Ú¦Ð</div>
                                <div style="font-size:12px;line-height:1.9;">
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">¨ßÒ- ¦Ú¦-¦¬¦-TË:</span>
                                        <span data-stat="coins" style="font-weight:700;color:#fff;">${Math.floor(userData.coins || 0)}</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">¨ßÒÎ QuanHash:</span>
                                        <span data-stat="quanhash" style="font-weight:700;color:#fff;">${Math.floor(userData.quanhash || 0)}</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">òÚá ¦í¦-¦¦TÀ¦¦¦¬TÏ:</span>
                                        <span data-stat="energy" style="font-weight:700;color:#fff;">${Math.floor(userData.energy || 0)}/${userData.max_energy || 1000}</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">¨ßÑÆ ¦ÒTÁ¦¦¦¦¦- TÂ¦-¦¬¦-¦-:</span>
                                        <span data-stat="total_taps" style="font-weight:700;color:#fff;">${Math.floor(userData.total_taps || 0)}</span>
                                    </div>
                                    ${userData.active_multiplier > 1 ? `
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">òÚá ¦ãTÁ¦¬¦¬¦¬TÂ¦¦¦¬TÌ TÂ¦-¦¬¦-:</span>
                                        <span style="font-weight:700;color:#fbbf24;">+${userData.active_multiplier - 1} TÂ¦-¦¬¦-¦-</span>
                                    </div>
                                    ` : ''}
                                    <div style="display:flex;justify-content:space-between;padding:10px;">
                                        <span style="color:#94a3b8;">¨ßÒ¦ ¦Þ¦-TÉ¦¬¦¦ ¦+¦-TÅ¦-¦+:</span>
                                        <span data-stat="total_earned" style="font-weight:700;color:#10b981;">${Math.floor(userData.total_earned || 0)}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:15px;">
                                <!-- My Purchases Button -->
                                <div id="myPurchasesBtn" style="cursor:pointer;padding:14px;background:linear-gradient(135deg,#10b981,#059669);border-radius:12px;text-align:center;font-weight:800;font-size:13px;color:#fff;transition:all 0.3s;box-shadow:0 4px 12px rgba(16,185,129,0.3);" onmouseover="this.style.transform='scale(1.05)';this.style.boxShadow='0 6px 16px rgba(16,185,129,0.4)'" onmouseout="this.style.transform='scale(1)';this.style.boxShadow='0 4px 12px rgba(16,185,129,0.3)'">
                                    ¨ßÛÍÿ¬Ï ¦ß¦-¦¦TÃ¦¬¦¦¦¬
                                </div>
                                
                                <!-- Achievements Button -->
                                <div onclick="openAchievements(); this.closest('.modal').remove();" style="cursor:pointer;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:12px;text-align:center;font-weight:800;font-size:13px;color:#fff;transition:all 0.3s;box-shadow:0 4px 12px rgba(102,126,234,0.3);" onmouseover="this.style.transform='scale(1.05)';this.style.boxShadow='0 6px 16px rgba(102,126,234,0.4)'" onmouseout="this.style.transform='scale(1)';this.style.boxShadow='0 4px 12px rgba(102,126,234,0.3)'">
                                    ¨ßÏÆ ¦Ô¦-TÁTÂ¦¬¦¦¦¦¦-¦¬TÏ
                                </div>
                            </div>
                            
                            <!-- Settings Button -->
                            <div onclick="openSettingsModal(); this.closest('.modal').remove();" style="cursor:pointer;padding:14px;background:linear-gradient(135deg,#4b5563,#374151);border-radius:12px;text-align:center;font-weight:800;font-size:14px;color:#fff;transition:all 0.3s;box-shadow:0 4px 12px rgba(75,85,99,0.3);margin-bottom:15px;" onmouseover="this.style.transform='scale(1.02)';this.style.boxShadow='0 6px 16px rgba(75,85,99,0.4)'" onmouseout="this.style.transform='scale(1)';this.style.boxShadow='0 4px 12px rgba(75,85,99,0.3)'">
                                òÚÙÿ¬Ï ¦Ý¦-TÁTÂTÀ¦-¦¦¦¦¦¬
                            </div>
                            
                            <button onclick="this.closest('.modal').remove()" style="width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:15px;margin-top:10px;">¦×¦-¦¦TÀTËTÂTÌ</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                modal.onclick = (e) => {if(e.target === modal) modal.remove();};
                
                // Add click handler for My Purchases button
                const purchasesBtn = document.getElementById('myPurchasesBtn');
                if (purchasesBtn) {
                    purchasesBtn.addEventListener('click', () => {
                        openMyPurchases(userData);
                    });
                }
            });
        }
        
        function openMyPurchases(userData) {
            // Close profile modal first
            document.querySelectorAll('.modal.active').forEach(m => m.remove());
            
            // Fetch detailed purchase data
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.style.zIndex = '10001';
                
                // Get current time for time remaining calculations
                const now = new Date();
                
                let purchasesContent = `
                    <div style="background:linear-gradient(135deg,rgba(10,14,39,0.98),rgba(15,23,42,0.98));border-radius:24px;border:2px solid rgba(167,139,250,0.4);box-shadow:0 10px 40px rgba(167,139,250,0.3);max-width:450px;max-height:85vh;overflow-y:auto;">
                        <div style="background:linear-gradient(135deg,#10b981,#059669);padding:20px;border-radius:22px 22px 0 0;text-align:center;">
                            <h2 style="font-size:22px;color:#fff;margin:0;font-weight:900;">¨ßÛÍÿ¬Ï ¦Ü¦Þ¦Ø ¦ß¦Þ¦Ú¦ã¦ß¦Ú¦Ø</h2>
                            <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                        </div>
                        <div style="padding:20px;">
                `;
                
                // Shop purchases: Tap Boost Amplifiers - Show total only
                if (data.active_multiplier > 1 || (data.tap_boost_levels && Object.keys(data.tap_boost_levels).some(k => data.tap_boost_levels[k] > 0))) {
                    purchasesContent += `
                        <div style="margin-bottom:16px;">
                            <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(251,191,36,0.2);border-radius:8px;">òÚá ¦ã¦á¦Ø¦Û¦Ø¦â¦Õ¦Û¦ì ¦â¦Ð¦ß¦Ð</div>
                    `;
                    
                    // Show total combined effect
                    const totalTapsFromActiveMultiplier = data.active_multiplier > 1 ? (data.active_multiplier - 1) : 0;
                    purchasesContent += `
                        <div style="background:rgba(251,191,36,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(251,191,36,0.5);">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                <span style="color:#fff;font-weight:700;font-size:13px;">¦Þ¦-TÉ¦¬¦¦ TÃTÁ¦¬¦¬¦¬TÂ¦¦¦¬TÌ TÂ¦-¦¬¦-</span>
                                <span style="color:#4ade80;font-weight:700;font-size:13px;">+${totalTapsFromActiveMultiplier} TÂ¦-¦¬¦-¦-</span>
                            </div>
                            <div style="color:#86efac;font-size:11px;font-weight:600;">òÜè ¦Ý¦-¦-TÁ¦¦¦¦¦+¦-</div>
                        </div>
                    `;
                    
                    purchasesContent += `</div>`;
                }
                
                // Shop purchases: Energy Buy (Energy per second recovery) - Show total only
                if (data.energy_regen_rate > 1 || (data.energy_buy_levels && Object.keys(data.energy_buy_levels).some(k => data.energy_buy_levels[k] > 0))) {
                    purchasesContent += `
                        <div style="margin-bottom:16px;">
                            <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(16,185,129,0.2);border-radius:8px;">òÚá ¦Ò¦Þ¦á¦á¦â¦Ð¦Ý¦Þ¦Ò¦Û¦Õ¦Ý¦Ø¦Õ ¦í¦Ý¦Õ¦à¦Ó¦Ø¦Ø</div>
                    `;
                    
                    // Show total regen rate (includes base 1.0 + upgrades)
                    const totalRegen = data.energy_regen_rate || 1.0;
                    const bonusRegen = (totalRegen - 1.0).toFixed(2);
                    if (bonusRegen > 0) {
                        purchasesContent += `
                            <div style="background:rgba(16,185,129,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(16,185,129,0.5);">
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                    <span style="color:#fff;font-weight:700;font-size:13px;">¦Þ¦-TÉ¦-TÏ TÁ¦¦¦-TÀ¦-TÁTÂTÌ ¦-¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¦¦-¦¬TÏ</span>
                                    <span style="color:#4ade80;font-weight:700;font-size:13px;">+${bonusRegen}/TÁ¦¦¦¦</span>
                                </div>
                                <div style="color:#86efac;font-size:11px;font-weight:600;">òÜè ¦Ý¦-¦-TÁ¦¦¦¦¦+¦-</div>
                            </div>
                        `;
                    }
                    
                    purchasesContent += `</div>`;
                }
                
                // Shop purchases: Energy Expand (Max Energy) - Show total only
                if (data.max_energy > 1000 || (data.energy_expand_levels && Object.keys(data.energy_expand_levels).some(k => data.energy_expand_levels[k] > 0))) {
                    purchasesContent += `
                        <div style="margin-bottom:16px;">
                            <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(59,130,246,0.2);border-radius:8px;">òÚá ¦à¦Ð¦á¦è¦Ø¦à¦Õ¦Ý¦Ø¦Õ ¦í¦Ý¦Õ¦à¦Ó¦Ø¦Ø</div>
                    `;
                    
                    // Show total max energy (includes base 1000 + upgrades)
                    const totalMaxEnergy = data.max_energy || 1000;
                    const bonusEnergy = totalMaxEnergy - 1000;
                    if (bonusEnergy > 0) {
                        purchasesContent += `
                            <div style="background:rgba(59,130,246,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(59,130,246,0.5);">
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                    <span style="color:#fff;font-weight:700;font-size:13px;">¦Þ¦-TÉ¦-TÏ ¦-¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-¦-TÏ TÍ¦-¦¦TÀ¦¦¦¬TÏ</span>
                                    <span style="color:#4ade80;font-weight:700;font-size:13px;">+${bonusEnergy} TÍ¦-¦¦TÀ¦¦¦¬¦¬</span>
                                </div>
                                <div style="color:#86efac;font-size:11px;font-weight:600;">òÜè ¦Ý¦-¦-TÁ¦¦¦¦¦+¦-</div>
                            </div>
                        `;
                    }
                    
                    purchasesContent += `</div>`;
                }
                
                // Autobot status
                if (data.auto_tap_level > 0 && data.auto_tap_expires_at) {
                    const expiresAt = new Date(data.auto_tap_expires_at);
                    if (expiresAt > now) {
                        const remaining = Math.max(0, Math.floor((expiresAt - now) / 1000));
                        const days = Math.floor(remaining / 86400);
                        const hours = Math.floor((remaining % 86400) / 3600);
                        const minutes = Math.floor((remaining % 3600) / 60);
                        
                        purchasesContent += `
                            <div style="margin-bottom:16px;">
                                <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(16,185,129,0.2);border-radius:8px;">¨ßäÖ ¦Ð¦Ò¦â¦Þ¦Ñ¦Þ¦â</div>
                                <div style="background:rgba(16,185,129,0.3);padding:12px;border-radius:10px;border:1px solid rgba(16,185,129,0.5);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                        <span style="color:#fff;font-weight:700;font-size:13px;">¦ãTÀ¦-¦-¦¦¦-TÌ ${data.auto_tap_level} | ¦á¦¦¦-TÀ¦-TÁTÂTÌ ${data.auto_tap_speed}/TÁ¦¦¦¦</span>
                                        <span style="color:#4ade80;font-weight:700;font-size:13px;">${data.auto_tap_enabled ? '¨ßßâ ¦Ð¦¦TÂ¦¬¦-¦¦¦-' : 'òÚê ¦ÞTÁTÂ¦-¦-¦-¦-¦¬¦¦¦-'}</span>
                                    </div>
                                    <div style="color:#94a3b8;font-size:11px;font-weight:600;">òÏ-ÿ¬Ï ¦ÞTÁTÂ¦-¦¬¦-TÁTÌ: ${days}¦+ ${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}</div>
                                </div>
                            </div>
                        `;
                    }
                }
                
                // Group and display purchased cards
                if (data.cards && data.cards.length > 0) {
                    const cardGroups = {};
                    data.cards.forEach(card => {
                        if (!cardGroups[card.name]) {
                            cardGroups[card.name] = { count: 0, totalIncome: 0 };
                        }
                        cardGroups[card.name].count++;
                        cardGroups[card.name].totalIncome += (card.income || 0);
                    });
                    
                    const cardsList = Object.entries(cardGroups);
                    if (cardsList.length > 0) {
                        purchasesContent += `
                            <div style="margin-bottom:16px;">
                                <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(59,130,246,0.2);border-radius:8px;">¨ßÒ¦ ¦Ü¦Þ¦Ø ¦Ú¦Ð¦à¦â¦Þ¦ç¦Ú¦Ø</div>
                        `;
                        
                        cardsList.forEach(([name, info]) => {
                            // Convert per minute income to per hour
                            const incomePerHour = Math.floor(info.totalIncome * 60);
                            purchasesContent += `
                                <div style="background:rgba(59,130,246,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(59,130,246,0.5);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                        <span style="color:#fff;font-weight:700;font-size:13px;">${name} ${info.count > 1 ? `x${info.count}` : ''}</span>
                                        <span style="color:#4ade80;font-weight:700;font-size:13px;">+${incomePerHour}/TÇ¦-TÁ</span>
                                    </div>
                                    <div style="color:#86efac;font-size:11px;font-weight:600;">òÜè ¦ß¦-TÁTÂ¦-TÏ¦-¦-¦-TÏ ¦¦¦-TÀTÂ¦-TÇ¦¦¦-</div>
                                </div>
                            `;
                        });
                        
                        purchasesContent += `</div>`;
                    }
                }
                
                // Group and display purchased machines
                if (data.machines && data.machines.length > 0) {
                    const machineGroups = {};
                    data.machines.forEach(machine => {
                        if (!machineGroups[machine.name]) {
                            machineGroups[machine.name] = { count: 0, totalHashRate: 0 };
                        }
                        machineGroups[machine.name].count++;
                        machineGroups[machine.name].totalHashRate += (machine.hash_rate || 0);
                    });
                    
                    const machinesList = Object.entries(machineGroups);
                    if (machinesList.length > 0) {
                        purchasesContent += `
                            <div style="margin-bottom:16px;">
                                <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(168,85,247,0.2);border-radius:8px;">¨ßÏí ¦Ü¦Þ¦Ø ¦Ü¦Ð¦Ù¦Ý¦Ø¦Ý¦Ó¦Ø</div>
                        `;
                        
                        machinesList.forEach(([name, info]) => {
                            purchasesContent += `
                                <div style="background:rgba(168,85,247,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(168,85,247,0.5);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                        <span style="color:#fff;font-weight:700;font-size:13px;">${name} ${info.count > 1 ? `x${info.count}` : ''}</span>
                                        <span style="color:#4ade80;font-weight:700;font-size:13px;">+${(info.totalHashRate * 3600).toFixed(2)}/TÇ¦-TÁ</span>
                                    </div>
                                    <div style="color:#86efac;font-size:11px;font-weight:600;">òÜè ¦ß¦-TÁTÂ¦-TÏ¦-¦-¦-TÏ ¦-¦-¦¦¦-¦¬¦-¦¦-TÄ¦¦TÀ¦-¦-</div>
                                </div>
                            `;
                        });
                        
                        purchasesContent += `</div>`;
                    }
                }
                
                purchasesContent += `
                        </div>
                    </div>
                `;
                
                modal.innerHTML = purchasesContent;
                document.body.appendChild(modal);
                modal.onclick = (e) => {if(e.target === modal) modal.remove();};
            })
            .catch(err => {
                console.error('Error loading purchases:', err);
                tg.showAlert('òÝÌ ¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÀTÃ¦¬¦¦¦¬ ¦¬¦-¦¦TÃ¦¬¦-¦¦');
            });
        }
        
        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const photoUrl = e.target.result;
                    localStorage.setItem('vip_profile_photo', photoUrl);
                    document.getElementById('profilePhoto').src = photoUrl;
                    const icon = document.querySelector('.vip-profile-icon');
                    if (icon) {
                        icon.innerHTML = '';
                        const img = document.createElement('img');
                        img.src = photoUrl;
                        icon.appendChild(img);
                    }
                };
                reader.readAsDataURL(file);
            }
        }
        function openVIPTopLeaders() {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.style.zIndex = '10000';
            
            function loadTopData() {
                fetch('/api/top_users', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({limit: 999, user_id: window.user?.id})
                })
                .then(res => {
                    console.log('[TOP_LEADERS] Response status:', res.status);
                    return res.json();
                })
                .then(topData => {
                    console.log('[TOP_LEADERS] Received data:', topData);
                    const topUsers = topData.users || [];
                    console.log('[TOP_LEADERS] Users count:', topUsers.length);
                    
                    // Store current user info globally
                    window.currentUserInTop = topData.current_user || null;
                    window.currentUserPosition = topData.current_user_position || null;
                    
                    // Sort: VIPs first, then by rating descending (backend already does this, but keep for consistency)
                    const sortedUsers = [...topUsers].sort((a, b) => {
                        const aVip = a.vip_level || 0;
                        const bVip = b.vip_level || 0;
                        if (aVip !== bVip) return bVip - aVip; // VIPs first
                        return (b.rating || 0) - (a.rating || 0); // Then by rating
                    });
                    
                    let topHTML = sortedUsers.map((u, idx) => {
                        const medal = idx === 0 ? '¨ßåÇ' : idx === 1 ? '¨ßåÈ' : idx === 2 ? '¨ßåÉ' : '';
                        const rankColor = idx === 0 ? '#ffd700' : idx === 1 ? '#c0c0c0' : idx === 2 ? '#cd7f32' : '#94a3b8';
                        const isVIP = u.vip_level && u.vip_level > 0;
                        const vipBadge = isVIP ? `<span style="background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;padding:2px 8px;border-radius:8px;font-size:10px;font-weight:800;">¨ßÑÑ VIP ${u.vip_level}</span>` : '';
                        
                        const vipNames = {1: 'Bronze', 2: 'Silver', 3: 'Gold', 4: 'Platinum', 5: 'Diamond', 6: 'Absolute'};
                        const vipName = vipNames[u.vip_level] || '';
                        const vipInfo = isVIP ? `<div style="font-size:10px;color:#ffd700;margin-top:2px;">${vipName} VIP</div>` : '';
                        
                        const passiveIncome = (u.passive_income || 0).toLocaleString();
                        const totalEarned = (u.total_earned || 0).toLocaleString();
                        const totalTaps = (u.total_taps || 0).toLocaleString();
                        const quanhash = (u.quanhash || 0).toLocaleString();
                        
                        return `<div style="padding:14px;background:${isVIP ? 'linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,255,255,0.08))' : 'rgba(0,0,0,0.25)'};border-radius:12px;margin-bottom:12px;border:2px solid ${isVIP ? 'rgba(255,215,0,0.4)' : 'rgba(255,255,255,0.1)'};">
                            <div style="display:flex;align-items:center;gap:14px;margin-bottom:10px;">
                                <div style="width:50px;height:50px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:900;color:${rankColor};${idx < 3 ? 'box-shadow:0 0 15px rgba(255,215,0,0.5);' : ''}">${medal || (idx + 1)}</div>
                                <div style="flex:1;">
                                    <div style="font-size:16px;font-weight:800;color:#fff;margin-bottom:3px;">${u.username}</div>
                                    <div style="font-size:11px;color:#94a3b8;">¦ãTÀ¦-¦-¦¦¦-TÌ ${u.level || 1}</div>
                                    ${vipInfo}
                                    ${vipBadge}
                                </div>
                            </div>
                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px;padding-top:10px;border-top:1px solid rgba(255,255,255,0.1);">
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">¨ßÒ- ¦Ú¦-¦¬¦-TË</div>
                                    <div style="font-size:14px;font-weight:800;color:#ffd700;">${u.coins ? (u.coins).toLocaleString() : 0}</div>
                                </div>
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">¨ßÒÎ QuanHash</div>
                                    <div style="font-size:14px;font-weight:800;color:#10b981;">${quanhash}</div>
                                </div>
                                <div style="padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">¨ßÓÈ ¦ß¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+</div>
                                    <div style="font-size:14px;font-weight:800;color:#f093fb;">+${passiveIncome}/TÇ¦-TÁ</div>
                                </div>
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">¨ßÒ¦ ¦ÒTÁ¦¦¦¦¦- ¦¬¦-TÀ¦-¦-¦-TÂ¦-¦-¦-</div>
                                    <div style="font-size:14px;font-weight:800;color:#10b981;">${totalEarned}</div>
                                </div>
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">¨ßÑÆ ¦ÒTÁ¦¦¦¦¦- TÂ¦-¦¬¦-¦-</div>
                                    <div style="font-size:14px;font-weight:800;color:#94a3b8;">${totalTaps}</div>
                                </div>
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">¨ßÏÆ ¦à¦¦¦¦TÂ¦¬¦-¦¦</div>
                                    <div style="font-size:14px;font-weight:800;color:#667eea;">${u.rating ? Math.round(u.rating).toLocaleString() : 0}</div>
                                </div>
                            </div>
                        </div>`;
                    }).join('');
                    
                    const contentDiv = modal.querySelector('#topLeadersContent');
                    if (contentDiv) {
                        contentDiv.innerHTML = topUsers.length > 0 ? topHTML : '<div style="text-align:center;color:#94a3b8;padding:40px;font-size:14px;">¦à¦¦¦¦TÂ¦¬¦-¦¦ ¦¬TÃTÁTÂ</div>';
                    }
                    
                    // Auto-update current user position display
                    const positionDiv = modal.querySelector('#currentUserPosition');
                    const infoDiv = modal.querySelector('#currentUserInfo');
                    if (positionDiv && infoDiv) {
                        const currentUserPos = window.currentUserPosition;
                        const currentUser = window.currentUserInTop;
                        
                        if (currentUser && currentUserPos) {
                            positionDiv.style.display = 'block';
                            const level = currentUser.level || 1;
                            const rating = currentUser.rating || 0;
                            const vipBadge = currentUser.vip_level && currentUser.vip_level > 0 ? `¨ßÑÑ VIP ${currentUser.vip_level}` : '';
                            infoDiv.innerHTML = `<div style="font-size:16px;font-weight:900;color:#ffd700;margin-bottom:5px;">${currentUser.username}</div><div style="font-size:13px;color:#fff;">¦Ü¦¦TÁTÂ¦- #${currentUserPos} òÀâ ¦ãTÀ¦-¦-¦¦¦-TÌ ${level} òÀâ ¦à¦¦¦¦TÂ¦¬¦-¦¦ ${Math.round(rating).toLocaleString()} ${vipBadge}</div>`;
                        } else if (currentUserPos === null) {
                            // Position is null means user not in top, but hide block initially
                            // Only show if user manually clicks "Find Yourself" button
                            positionDiv.style.display = 'none';
                        }
                    }
                })
                .catch(err => {
                    console.error('[TOP_LEADERS] Error loading top users:', err);
                    const contentDiv = modal.querySelector('#topLeadersContent');
                    if (contentDiv) {
                        contentDiv.innerHTML = '<div style="text-align:center;color:#ef4444;padding:40px;font-size:14px;">¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÀTÃ¦¬¦¦¦¬ TÀ¦¦¦¦TÂ¦¬¦-¦¦¦-</div>';
                    }
                });
            }
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 450px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 20px;border: 2px solid rgba(102,126,234,0.4);">
                    <div style="background:linear-gradient(135deg,#667eea,#764ba2);padding:20px;border-radius:18px 18px 0 0;text-align:center;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                            <h2 style="font-size: 24px; color: #fff; margin: 0; font-weight: 900;">¨ßÏÆ ¦â¦Þ¦ß ¦Û¦Ø¦Ô¦Õ¦à¦ë</h2>
                            <button class="close-btn" onclick="const modal = this.closest('.modal'); modal.remove(); if(window.topLeadersInterval) clearInterval(window.topLeadersInterval); if(window.tournamentInterval) clearInterval(window.tournamentInterval);">òÜÕ</button>
                        </div>
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-top:10px;">
                            <div style="font-size:13px;color:rgba(255,255,255,0.8);">¨ßÔÄ ¦Ð¦-TÂ¦-¦-¦-¦-¦-¦-¦¬¦¦¦-¦¬¦¦ ¦¦¦-¦¦¦+TË¦¦ 2.5 TÁ¦¦¦¦</div>
                            <button id="tournamentBtn" onclick="openTournamentModal();" style="padding:8px 16px;background:rgba(16,185,129,0.3);color:#10b981;border:2px solid rgba(16,185,129,0.5);border-radius:10px;cursor:pointer;font-weight:700;font-size:12px;transition:all 0.3s;" onmouseover="this.style.background='rgba(16,185,129,0.4)';this.style.transform='scale(1.05)'" onmouseout="this.style.background='rgba(16,185,129,0.3)';this.style.transform='scale(1)'">¨ßÏÆ ¦âTÃTÀ¦-¦¬TÀ</button>
                        </div>
                    </div>
                    
                    <div style="padding:20px;">
                        <div id="currentUserPosition" style="display:none;margin-bottom:15px;padding:12px;background:linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,255,255,0.08));border:2px solid rgba(255,215,0,0.4);border-radius:12px;text-align:center;">
                            <div style="font-size:14px;font-weight:800;color:#ffd700;margin-bottom:5px;">¨ßÓÍ ¦Ò¦-TÈ¦- ¦¬¦-¦¬¦¬TÆ¦¬TÏ ¦- ¦â¦Þ¦ß</div>
                            <div style="font-size:11px;color:#94a3b8;" id="currentUserInfo">¦×¦-¦¦TÀTÃ¦¬¦¦¦-...</div>
                        </div>
                        <div id="tournamentInfo" style="display:none;margin-bottom:15px;padding:12px;background:linear-gradient(135deg,rgba(16,185,129,0.15),rgba(255,255,255,0.08));border:2px solid rgba(16,185,129,0.4);border-radius:12px;">
                            <div style="font-size:14px;font-weight:800;color:#10b981;margin-bottom:8px;">òÏ- ¦Ý¦¦¦+¦¦¦¬TÌ¦-TË¦¦ ¦âTÃTÀ¦-¦¬TÀ ¦â¦Þ¦ß-20</div>
                            <div style="font-size:12px;color:#fff;margin-bottom:6px;">¦Ô¦- ¦¦¦-¦-TÆ¦- TÂTÃTÀ¦-¦¬TÀ¦-: <span id="tournamentTimer">--:--:--</span></div>
                            <div style="font-size:11px;color:#86efac;">¨ßÒ- ¦Ñ¦-¦-TÃTÁTË ¦+¦¬TÏ ¦â¦Þ¦ß-20 ¦- ¦¦¦-¦-TÆ¦¦ ¦-¦¦¦+¦¦¦¬¦¬!</div>
                        </div>
                        <div id="topLeadersContent" style="max-height:550px;overflow-y:auto;">
                            <div style="text-align:center;color:#94a3b8;padding:40px;font-size:14px;">¦×¦-¦¦TÀTÃ¦¬¦¦¦-...</div>
                        </div>
                        
                        <button onclick="const modal = this.closest('.modal'); modal.remove(); if(window.topLeadersInterval) clearInterval(window.topLeadersInterval); if(window.tournamentInterval) clearInterval(window.tournamentInterval);" style="width:100%;margin-top:15px;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:15px;">¦×¦-¦¦TÀTËTÂTÌ</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            modal.onclick = (e) => {if(e.target === modal) { modal.remove(); if(window.topLeadersInterval) clearInterval(window.topLeadersInterval); if(window.tournamentInterval) clearInterval(window.tournamentInterval); }};
            
            // Tournament timer function
            function updateTournamentTimer() {
                const tournamentInfo = modal.querySelector('#tournamentInfo');
                const timerEl = modal.querySelector('#tournamentTimer');
                
                if (!tournamentInfo || !timerEl) return;
                
                // Calculate time until next Monday 00:00
                const now = new Date();
                const dayOfWeek = now.getDay(); // 0 = Sunday, 1 = Monday, etc.
                const daysUntilMonday = dayOfWeek === 0 ? 1 : (8 - dayOfWeek) % 7 || 7;
                const nextMonday = new Date(now);
                nextMonday.setDate(now.getDate() + daysUntilMonday);
                nextMonday.setHours(0, 0, 0, 0);
                
                const timeLeft = nextMonday - now;
                
                if (timeLeft > 0) {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    timerEl.textContent = `${days}¦+ ${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                    tournamentInfo.style.display = 'block';
                } else {
                    tournamentInfo.style.display = 'none';
                }
            }
            
            // Update tournament info periodically
            window.tournamentInterval = setInterval(updateTournamentTimer, 1000);
            
            // Load data immediately
            loadTopData();
            updateTournamentTimer();
            
            // Auto-refresh every 2.5 seconds
            window.topLeadersInterval = setInterval(loadTopData, 2500);
        }
        
        function addVIPAura() {
            let aura = document.querySelector('.vip-aura');
            if (!aura) {
                aura = document.createElement('div');
                aura.className = 'vip-aura';
                document.body.appendChild(aura);
            }
        }
        
        function openTournamentModal() {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.style.zIndex = '10001';
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 20px;border: 2px solid rgba(16,185,129,0.4);">
                    <div style="background:linear-gradient(135deg,#10b981,#059669);padding:20px;border-radius:18px 18px 0 0;text-align:center;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                            <h2 style="font-size: 24px; color: #fff; margin: 0; font-weight: 900;">¨ßÏÆ ¦Ý¦¦¦+¦¦¦¬TÌ¦-TË¦¦ ¦âTÃTÀ¦-¦¬TÀ ¦â¦Þ¦ß-20</h2>
                            <button class="close-btn" onclick="this.closest('.modal').remove(); if(window.tournamentModalInterval) clearInterval(window.tournamentModalInterval);">òÜÕ</button>
                        </div>
                        <div style="font-size:14px;color:rgba(255,255,255,0.9);margin-top:10px;">
                            òÏ- ¦Ô¦- ¦¦¦-¦-TÆ¦- TÂTÃTÀ¦-¦¬TÀ¦-: <span id="tournamentModalTimer" style="font-weight:900;font-size:16px;">--:--:--</span>
                        </div>
                    </div>
                    
                    <div style="padding:20px;">
                        <div style="background:linear-gradient(135deg,rgba(16,185,129,0.15),rgba(255,255,255,0.08));padding:16px;border-radius:12px;border:2px solid rgba(16,185,129,0.3);margin-bottom:20px;">
                            <div style="font-size:16px;font-weight:800;color:#10b981;margin-bottom:10px;">¨ßÒ- ¦Ý¦-¦¦TÀ¦-¦+TË ¦¬¦- ¦â¦Þ¦ß-20</div>
                            <div style="font-size:13px;color:#fff;line-height:1.8;">
                                <div>¨ßåÇ 1 ¦-¦¦TÁTÂ¦-: <span style="color:#ffd700;font-weight:800;">10,000,000 ¨ßÒ-</span> + <span style="color:#10b981;font-weight:800;">50,000 ¨ßÒÎ</span></div>
                                <div>¨ßåÈ 2 ¦-¦¦TÁTÂ¦-: <span style="color:#c0c0c0;font-weight:800;">7,500,000 ¨ßÒ-</span> + <span style="color:#10b981;font-weight:800;">37,500 ¨ßÒÎ</span></div>
                                <div>¨ßåÉ 3 ¦-¦¦TÁTÂ¦-: <span style="color:#cd7f32;font-weight:800;">5,000,000 ¨ßÒ-</span> + <span style="color:#10b981;font-weight:800;">25,000 ¨ßÒÎ</span></div>
                                <div>4-10 ¦-¦¦TÁTÂ¦-: <span style="color:#86efac;font-weight:800;">2,500,000 ¨ßÒ-</span> + <span style="color:#10b981;font-weight:800;">12,500 ¨ßÒÎ</span></div>
                                <div>11-20 ¦-¦¦TÁTÂ¦-: <span style="color:#86efac;font-weight:800;">1,000,000 ¨ßÒ-</span> + <span style="color:#10b981;font-weight:800;">5,000 ¨ßÒÎ</span></div>
                            </div>
                        </div>
                        
                        <div style="background:rgba(16,185,129,0.1);padding:14px;border-radius:12px;border:2px solid rgba(16,185,129,0.2);margin-bottom:20px;">
                            <div style="font-size:14px;font-weight:800;color:#10b981;margin-bottom:8px;">¨ßÓË ¦ßTÀ¦-¦-¦¬¦¬¦- TÂTÃTÀ¦-¦¬TÀ¦-</div>
                            <div style="font-size:12px;color:#86efac;line-height:1.6;">
                                òÀâ ¦âTÃTÀ¦-¦¬TÀ ¦¬TÀ¦-¦-¦-¦+¦¬TÂTÁTÏ ¦¦¦-¦¦¦+TÃTÎ ¦-¦¦¦+¦¦¦¬TÎ<br>
                                òÀâ ¦ß¦-¦+TÁTÇTÑTÂ ¦¬¦- TÀ¦¦¦¦TÂ¦¬¦-¦¦TÃ ¦â¦Þ¦ß-20 ¦¬¦¦TÀ¦-¦¦¦-¦-<br>
                                òÀâ ¦Ý¦-¦¦TÀ¦-¦+TË TÀ¦-TÁ¦¬TÀ¦¦¦+¦¦¦¬TÏTÎTÂTÁTÏ ¦- ¦¬¦-¦-¦¦¦+¦¦¦¬TÌ¦-¦¬¦¦ 00:00<br>
                                òÀâ ¦Ý¦-¦-TË¦¦ TÂTÃTÀ¦-¦¬TÀ ¦-¦-TÇ¦¬¦-¦-¦¦TÂTÁTÏ ¦¦¦-¦¦¦+TÃTÎ ¦-¦¦¦+¦¦¦¬TÎ<br>
                                òÀâ ¦Ñ¦-¦-TÃTÁTË ¦+¦-¦-¦-¦-¦¬TÏTÎTÂTÁTÏ ¦-¦-TÂ¦-¦-¦-TÂ¦¬TÇ¦¦TÁ¦¦¦¬
                            </div>
                        </div>
                        
                        <div style="background:linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,255,255,0.08));padding:14px;border-radius:12px;border:2px solid rgba(255,215,0,0.3);margin-bottom:20px;">
                            <div style="font-size:14px;font-weight:800;color:#ffd700;margin-bottom:8px;">¨ßÌß ¦Ô¦-¦¬¦-¦¬¦-¦¬TÂ¦¦¦¬TÌ¦-TË¦¦ ¦-¦-¦-TÃTÁTË</div>
                            <div style="font-size:12px;color:#fff;line-height:1.6;">
                                òÀâ VIP ¦¬¦¦TÀ¦-¦¦¦¬ ¦¬¦-¦¬TÃTÇ¦-TÎTÂ x2 ¦-¦-¦-TÃTÁTË<br>
                                òÀâ ¦ßTÀ¦¬¦¬¦-¦-¦-¦¦ TÄ¦-¦-¦+ ¦-¦-¦-¦-¦-¦¬TÏ¦¦TÂTÁTÏ ¦¦¦¦¦¦¦-¦¦¦+¦¦¦¬TÌ¦-¦-<br>
                                òÀâ ¦Ý¦-¦¦TÀ¦-¦+TË ¦-¦-TÇ¦¬TÁ¦¬TÏTÎTÂTÁTÏ ¦-¦-TÂ¦-¦-¦-TÂ¦¬TÇ¦¦TÁ¦¦¦¬<br>
                                òÀâ ¦ÒTÁ¦¦ TÃTÇ¦-TÁTÂ¦-¦¬¦¦¦¬ ¦â¦Þ¦ß-100 ¦-¦¬¦+TÏTÂ TÁ¦-¦-¦¦ ¦¬TÀ¦-¦¦TÀ¦¦TÁTÁ
                            </div>
                        </div>
                        
                        <button onclick="this.closest('.modal').remove(); if(window.tournamentModalInterval) clearInterval(window.tournamentModalInterval);" style="width:100%;padding:14px;background:linear-gradient(135deg,#10b981,#059669);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:15px;">¦ß¦-¦-TÏTÂ¦-¦-</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            modal.onclick = (e) => {if(e.target === modal) { modal.remove(); if(window.tournamentModalInterval) clearInterval(window.tournamentModalInterval); }};
            
            // Tournament timer in modal
            function updateTournamentModalTimer() {
                const timerEl = modal.querySelector('#tournamentModalTimer');
                if (!timerEl) return;
                
                const now = new Date();
                const dayOfWeek = now.getDay();
                const daysUntilMonday = dayOfWeek === 0 ? 1 : (8 - dayOfWeek) % 7 || 7;
                const nextMonday = new Date(now);
                nextMonday.setDate(now.getDate() + daysUntilMonday);
                nextMonday.setHours(0, 0, 0, 0);
                
                const timeLeft = nextMonday - now;
                
                if (timeLeft > 0) {
                    const days = Math.floor(timeLeft / (1000 * 60 * 60 * 24));
                    const hours = Math.floor((timeLeft % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60));
                    const minutes = Math.floor((timeLeft % (1000 * 60 * 60)) / (1000 * 60));
                    const seconds = Math.floor((timeLeft % (1000 * 60)) / 1000);
                    
                    timerEl.textContent = `${days}¦+ ${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                }
            }
            
            window.tournamentModalInterval = setInterval(updateTournamentModalTimer, 1000);
            updateTournamentModalTimer();
        }
        
        function openBuyVIPModal() {
            const vipPackages = [
                {level: 1, name: 'Bronze VIP', stars: 300, color: '#cd7f32', badge: '¨ßåÉ', benefits: ['òíÐ Premium Support', 'òÜè ¦ã¦-¦¬¦¦¦-¦¬TÌ¦-TË¦¦ ¦-¦-TÀ¦¦¦¦TÀ', 'òÞÕ 20% ¦¦ TÂ¦-¦¬TÃ'], productId: 51},
                {level: 2, name: 'Silver VIP', stars: 600, color: '#c0c0c0', badge: '¨ßåÈ', benefits: ['òíÐ Premium Support', 'òÜè ¦ã¦-¦¬¦¦¦-¦¬TÌ¦-TË¦¦ ¦-¦-TÀ¦¦¦¦TÀ', '¨ßÏÆ Top Place', 'òÞÕ 50% ¦¦ TÂ¦-¦¬TÃ'], productId: 52},
                {level: 3, name: 'Gold VIP', stars: 1000, color: '#ffd700', badge: '¨ßåÇ', benefits: ['òíÐ Premium Support', '¨ßÌß Golden Profile', '¨ßÏÆ Top Place', 'òÜè Unique Design', 'òÞÕ 100% ¦¦ TÂ¦-¦¬TÃ', 'òÚá 50% TÍ¦-¦¦TÀ¦¦¦¬¦¬'], productId: 53},
                {level: 4, name: 'Platinum VIP', stars: 1500, color: '#e5e4e2', badge: '¨ßÒÎ', benefits: ['¦ÒTÁ¦¦ ¦¬¦¬ Gold VIP', '¨ßÎÉ VIP ¦âTÃTÀ¦-¦¬TÀTË', 'òÜè ¦ç¦-TÁTÂ¦¬TÆTË', 'òÞÕ 150% ¦¦ TÂ¦-¦¬TÃ'], productId: 54},
                {level: 5, name: 'Diamond VIP', stars: 2000, color: '#b9f2ff', badge: '¨ßÒà', benefits: ['¦ÒTÁ¦¦ ¦¬¦¬ Platinum VIP', '¨ßÑÑ ¦Ú¦-TÀ¦-¦-¦-', '¨ßÒ- 0% ¦¦¦-¦-¦¬TÁTÁ¦¬TÏ', 'òÞÕ 250% ¦¦ TÂ¦-¦¬TÃ', '¨ßÒÎ VIP Boost 50x'], productId: 55},
                {level: 6, name: 'Absolute VIP', stars: 3000, color: '#ff69b4', badge: '¨ßÑÑ', benefits: ['¦ÒTÁ¦¦ ¦¬¦¬ Diamond VIP', 'òÜè ¦ÐTÃTÀ¦-', '¨ßÌÈ ¦à¦-¦+TÃ¦¦¦-', 'òÞÕ 450% ¦¦ TÂ¦-¦¬TÃ', '¨ßÌÐ VIP ¦Ü¦-TÈ¦¬¦-TË'], productId: 56}
            ];
            
            let vipHTML = vipPackages.map(pkg => `
                <div style="background:linear-gradient(135deg,${pkg.color},rgba(255,255,255,0.1));padding:14px;border-radius:12px;margin-bottom:12px;border:2px solid ${pkg.color};box-shadow:0 4px 15px ${pkg.color}40;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                        <div style="display:flex;align-items:center;gap:10px;">
                            <span style="font-size:28px;">${pkg.badge}</span>
                            <div>
                                <div style="font-size:16px;font-weight:900;color:#000;">${pkg.name}</div>
                                <div style="font-size:12px;color:rgba(0,0,0,0.7);">¦ãTÀ¦-¦-¦¦¦-TÌ ${pkg.level}</div>
                            </div>
                        </div>
                        <div style="text-align:right;">
                            <div style="font-size:20px;font-weight:900;color:#000;">${pkg.stars}</div>
                            <div style="font-size:11px;color:rgba(0,0,0,0.7);">òíÐ ¦¬¦-¦¦¦¬¦+</div>
                        </div>
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:8px;margin-bottom:10px;">
                        <div style="font-size:11px;color:rgba(0,0,0,0.8);line-height:1.8;">
                            ${pkg.benefits.map(b => `<div>òÜÓ ${b}</div>`).join('')}
                        </div>
                    </div>
                    <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_${pkg.productId}')" style="width:100%;padding:10px;background:#000;color:${pkg.color};border:none;border-radius:8px;font-weight:900;font-size:13px;cursor:pointer;">¦ÚTÃ¦¬¦¬TÂTÌ VIP ¦¬¦- ${pkg.stars} òíÐ</button>
                </div>
            `).join('');
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.style.zIndex = '10000';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 420px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;border: 2px solid rgba(255,215,0,0.4);box-shadow: 0 10px 40px rgba(255,215,0,0.3);">
                    <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:24px;border-radius:22px 22px 0 0;text-align:center;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                            <h2 style="font-size: 26px; color: #000; margin: 0; font-weight: 900;">¨ßÑÑ VIP ¦á¦â¦Ð¦â¦ã¦á¦ë</h2>
                            <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                        </div>
                        <div style="font-size:14px;color:rgba(0,0,0,0.7);">¦ÒTË¦-¦¦TÀ¦¬TÂ¦¦ VIP ¦¬¦-¦¦¦¦TÂ</div>
                    </div>
                    
                    <div style="padding:20px;">
                        ${vipHTML}
                        
                        <button onclick="this.closest('.modal').remove()" style="width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:15px;margin-top:10px;">¦×¦-¦¦TÀTËTÂTÌ</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            modal.onclick = (e) => {if(e.target === modal) modal.remove();};
        }
        
        function addRainbowEffects() {
            // Apply rainbow border to key elements
            const elements = document.querySelectorAll('.stat-item-compact, .btn');
            elements.forEach(el => {
                el.style.border = '3px solid #ffd700';
                el.style.animation = 'vip-rainbow 3s linear infinite';
            });
        }
        
        function startVIPParticles() {
            // Remove existing particles
            const existing = document.querySelector('.vip-particles');
            if (existing) existing.remove();
            
            const particles = document.createElement('div');
            particles.className = 'vip-particles';
            
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    if (!particles.parentNode) return;
                    const particle = document.createElement('div');
                    particle.style.position = 'absolute';
                    particle.style.width = Math.random() * 6 + 2 + 'px';
                    particle.style.height = particle.style.width;
                    particle.style.background = '#ffd700';
                    particle.style.borderRadius = '50%';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = '100%';
                    particle.style.boxShadow = '0 0 10px #ffd700, 0 0 20px #ffed4e';
                    particle.style.animation = `vip-float ${10 + Math.random() * 10}s linear infinite`;
                    particles.appendChild(particle);
                }, i * 200);
            }
            
            document.body.appendChild(particles);
        }
        
        const shopItems = {
            boosts: [
                {name: "2x ¦Ü¦-¦-¦¦¦¬TÂ¦¦¦¬TÌ", emoji: "òÚá", price: 1000, desc: "¦ãTÁ¦¬¦¬¦¬¦-¦-¦¦TÂ ¦-¦-TÈ¦¬ TÂ¦-¦¬TË ¦¬ TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-¦¦TÂ ¦¦¦-¦¬¦¬TÇ¦¦TÁTÂ¦-¦- ¦¦¦¬¦¬¦¦¦-¦-", type: "multiplier_2x"},
                {name: "5x ¦Ü¦-¦-¦¦¦¬TÂ¦¦¦¬TÌ", emoji: "¨ßÔå", price: 5000, desc: "¦Ü¦-TÉ¦-¦- TÃTÁ¦¬¦¬¦¬¦-¦-¦¦TÂ ¦-¦-TÈ¦¬ TÂ¦-¦¬TË ¦¬ TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-¦¦TÂ ¦¦¦-¦¬¦¬TÇ¦¦TÁTÂ¦-¦- ¦¦¦¬¦¬¦¦¦-¦-", type: "multiplier_5x"},
                {name: "10x ¦Ü¦-¦-¦¦¦¬TÂ¦¦¦¬TÌ", emoji: "¨ßÒå", price: 20000, desc: "¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-¦- TÃTÁ¦¬¦¬¦¬¦-¦-¦¦TÂ ¦-¦-TÈ¦¬ TÂ¦-¦¬TË ¦¬ TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-¦¦TÂ ¦¦¦-¦¬¦¬TÇ¦¦TÁTÂ¦-¦- ¦¦¦¬¦¬¦¦¦-¦-", type: "multiplier_10x"},
            ],
            automation: [
                {name: "¨ßäÖ ¦Ð¦-TÂ¦--¦-¦-TÂ TÂ¦-¦¬¦-¦-", emoji: "¨ßäÖ", price: 50000, desc: "¦Ð¦-TÂ¦-¦-¦-TÂ¦¬TÇ¦¦TÁ¦¦¦¬ TÂ¦-¦¬¦-¦¦TÂ ¦¬¦- ¦-¦-TÁ", type: "auto_bot"},
                {name: "òÚá ¦Ô¦-¦-¦¦¦-¦-TÏ TÍ¦-¦¦TÀ¦¦¦¬TÏ", emoji: "òÚá", price: 30000, desc: "¦ã¦-¦¦¦¬¦¬TÇ¦¬¦-¦-¦¦TÂ ¦-¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦ ¦¬¦-¦¬¦-TÁ ¦-¦-TÈ¦¦¦¦ TÍ¦-¦¦TÀ¦¦¦¬¦¬", type: "double_energy"},
                {name: "¨ßÔÄ ¦ãTÁ¦¦¦-TÀ¦¦¦-¦¬¦¦ TÀ¦¦¦¦¦¦¦-¦¦TÀ¦-TÆ¦¬¦¬", emoji: "¨ßÔÄ", price: 40000, desc: "¦ãTÁ¦¦¦-TÀTÏ¦¦TÂ ¦-¦-TÂ¦-¦-¦-TÂ¦¬TÇ¦¦TÁ¦¦¦-¦¦ ¦-¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¦¦-¦¬¦¦ ¦-¦-TÈ¦¦¦¦ TÍ¦-¦¦TÀ¦¦¦¬¦¬", type: "regen_boost"},
            ],
            energy: [
                {name: "¦í¦-¦¦TÀ¦¦¦¬TÏ +50", emoji: "òÚá", price: 1000, amount: 50},
                {name: "¦í¦-¦¦TÀ¦¦¦¬TÏ +200", emoji: "òÚáòÚá", price: 3500, amount: 200},
                {name: "¦í¦-¦¦TÀ¦¦¦¬TÏ +500", emoji: "òÚáòÚáòÚá", price: 8000, amount: 500},
            ],
            cards: [
                {name: "¦Þ¦-TËTÇ¦-¦-TÏ ¦¦¦-TÀTÂ¦-TÇ¦¦¦-", emoji: "¨ßßâ", price: 500, desc: "¦ß¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+: 0.5 ¨ßêÙ/¦-¦¬¦-", type: "common"},
                {name: "¦à¦¦¦+¦¦¦-TÏ ¦¦¦-TÀTÂ¦-TÇ¦¦¦-", emoji: "¨ßÔ¦", price: 2000, desc: "¦ß¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+: 2 ¨ßêÙ/¦-¦¬¦-", type: "rare"},
                {name: "¦í¦¬¦¬TÇ¦¦TÁ¦¦¦-TÏ ¦¦¦-TÀTÂ¦-TÇ¦¦¦-", emoji: "¨ßßã", price: 10000, desc: "¦ß¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+: 10 ¨ßêÙ/¦-¦¬¦-", type: "epic"},
                {name: "¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-¦-TÏ ¦¦¦-TÀTÂ¦-TÇ¦¦¦-", emoji: "¨ßßà", price: 50000, desc: "¦ß¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+: 50 ¨ßêÙ/¦-¦¬¦-", type: "legendary"},
            ]
        };

        function loadData() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                // Save user data globally for shop calculations
                window.userData = data;
                
                const coins = Math.floor(data.coins || 0);
                const quanhash = Math.floor(data.quanhash || 0);
                const energy = parseInt(data.energy || 0);
                const maxEnergy = parseInt(data.max_energy || 1000);
                const energyRegenRate = parseFloat(data.energy_regen_rate || 1.0);
                const passiveCoins = Math.floor(data.passive_coins_per_hour || 0);
                const passiveHash = Math.floor(data.passive_hash_per_hour || 0);
                
                document.getElementById('coins').textContent = coins.toLocaleString();
                document.getElementById('quanhash').textContent = quanhash.toLocaleString();
                document.getElementById('energy-text').textContent = `${energy}/${maxEnergy}`;
                document.getElementById('passiveCoins').textContent = `+${passiveCoins.toLocaleString()}/TÇ¦-TÁ`;
                document.getElementById('passiveHash').textContent = `+${passiveHash.toLocaleString()}/TÇ¦-TÁ`;
                
                // Update username from database or localStorage or Telegram
                const savedUsername = localStorage.getItem('username');
                const dbUsername = data.username || null;
                const usernameEl = document.getElementById('username');
                
                if (usernameEl) {
                    if (dbUsername) {
                        // Database username takes priority
                        usernameEl.textContent = dbUsername;
                        // Sync to localStorage
                        if (!savedUsername || savedUsername !== dbUsername) {
                            localStorage.setItem('username', dbUsername);
                        }
                    } else if (savedUsername) {
                        // Fallback to localStorage
                        usernameEl.textContent = savedUsername;
                    } else if (window.user) {
                        // Fallback to Telegram name
                        usernameEl.textContent = window.user.first_name || '¦Ü¦-¦¦¦-¦¦TÀ';
                    } else {
                        usernameEl.textContent = '¦Ü¦-¦¦¦-¦¦TÀ';
                    }
                }
                
                const energyPercent = Math.min(100, Math.max(0, (energy / maxEnergy) * 100));
                const fillBar = document.getElementById('energy-bar-fill');
                const percentText = document.getElementById('energy-percent');
                if (fillBar) {
                    fillBar.style.width = energyPercent + '%';
                }
                if (percentText) {
                    percentText.textContent = Math.round(energyPercent) + '%';
                }

                // Update energy regeneration rate display
                const energyRegenText = document.getElementById('energy-regen-text');
                if (energyRegenText) {
                    energyRegenText.textContent = `¦Ò¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¦¦-¦¬¦¦: +${energyRegenRate.toFixed(1)}/TÁ¦¦¦¦`;
                }
                
                // Update energy regeneration rate in the running interval
                if (window.energyRegenRate !== undefined) {
                    window.energyRegenRate = energyRegenRate;
                }

                // Update user level and rating
                const level = data.level || 1;
                const experience = data.experience || 0;
                const rating = data.rating || 0;
                
                // Calculate experience needed for current and next level
                const currentLevelExp = (level - 1) ** 2 * 100;
                const nextLevelExp = (level ** 2) * 100;
                const expProgress = experience - currentLevelExp;
                const expNeeded = nextLevelExp - currentLevelExp;
                const levelPercent = Math.min(100, Math.max(0, (expProgress / expNeeded) * 100));
                
                // Update level display
                const levelEl = document.getElementById('user-level');
                const expEl = document.getElementById('user-experience');
                const nextExpEl = document.getElementById('user-next-level-exp');
                const ratingEl = document.getElementById('user-rating');
                const levelProgressFill = document.getElementById('level-progress-fill');
                const levelProgressPercent = document.getElementById('level-progress-percent');
                
                if (levelEl) levelEl.textContent = level;
                if (expEl) expEl.textContent = Math.round(expProgress).toLocaleString();
                if (nextExpEl) nextExpEl.textContent = Math.round(expNeeded).toLocaleString();
                if (ratingEl) ratingEl.textContent = Math.round(rating).toLocaleString();
                if (levelProgressFill) levelProgressFill.style.width = levelPercent + '%';
                if (levelProgressPercent) levelProgressPercent.textContent = Math.round(levelPercent) + '%';
                
                // Load VIP status and display it
                loadVIPStatus(data);
                
                // Update autobot toggle button
                updateAutobotToggle(data);
                
                // Update autobot shop buttons
                updateAutobotShopButtons(data);

                // Show withdraw button if user has 500k+ quanhash
                
                // Load shop levels after user data is loaded
                loadShopLevels();
                
                // Force refresh of current shop category if it's open
                setTimeout(() => {
                    const activeBtn = document.querySelector('.shop-cat-btn[style*="linear-gradient"]');
                    if (activeBtn && activeBtn.dataset.category) {
                        loadShopCategory(activeBtn.dataset.category);
                    }
                }, 100);
            })
            .catch(err => console.error('Error:', err));
        }
        function updateAutobotToggle(data) {
            const autobotStatusSection = document.getElementById('autobotStatusSection');
            const autobotStatusBtn = document.getElementById('autobotStatusBtn');
            
            if (!autobotStatusSection || !autobotStatusBtn) return;
            
            const autobotLevel = data.auto_tap_level || 0;
            const autobotSpeed = data.auto_tap_speed || 2.0;
            const autobotExpiresAt = data.auto_tap_expires_at || 0;
            
            // Show status if user has autobot (level > 0 and not expired)
            if (autobotLevel > 0 && autobotExpiresAt > Date.now()) {
                autobotStatusSection.style.display = 'block';
                
                // Store current state globally
                window.autobotExpiresAt = autobotExpiresAt;
                
                // Calculate remaining time
                const remainingMs = autobotExpiresAt - Date.now();
                const hours = Math.floor(remainingMs / 3600000);
                const minutes = Math.floor((remainingMs % 3600000) / 60000);
                const seconds = Math.floor((remainingMs % 60000) / 1000);
                const timeText = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                
                // Update status text
                autobotStatusBtn.innerHTML = `¨ßäÖ ¦Ð¦-TÂ¦-¦-¦-TÂ ¦-¦¦TÂ¦¬¦-¦¦¦- | ¦ãTÀ¦-¦-¦¦¦-TÌ ${autobotLevel} | ¦á¦¦¦-TÀ¦-TÁTÂTÌ ${autobotSpeed}/TÁ¦¦¦¦ | òÏ-ÿ¬Ï ¦ÞTÁTÂ¦-¦¬¦-TÁTÌ: ${timeText}`;
                
                // Update countdown
                if (window.autobotInterval) clearInterval(window.autobotInterval);
                window.autobotInterval = setInterval(() => {
                    const now = Date.now();
                    const remainingMs = window.autobotExpiresAt - now;
                    
                    if (remainingMs <= 0) {
                        clearInterval(window.autobotInterval);
                        autobotStatusSection.style.display = 'none';
                        return;
                    }
                    
                    const hours = Math.floor(remainingMs / 3600000);
                    const minutes = Math.floor((remainingMs % 3600000) / 60000);
                    const seconds = Math.floor((remainingMs % 60000) / 1000);
                    const timeText = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                    
                    autobotStatusBtn.innerHTML = `¨ßäÖ ¦Ð¦-TÂ¦-¦-¦-TÂ ¦-¦¦TÂ¦¬¦-¦¦¦- | ¦ãTÀ¦-¦-¦¦¦-TÌ ${autobotLevel} | ¦á¦¦¦-TÀ¦-TÁTÂTÌ ${autobotSpeed}/TÁ¦¦¦¦ | òÏ-ÿ¬Ï ¦ÞTÁTÂ¦-¦¬¦-TÁTÌ: ${timeText}`;
                }, 1000);
            } else {
                autobotStatusSection.style.display = 'none';
                if (window.autobotInterval) clearInterval(window.autobotInterval);
            }
        }
        
        function updateAutobotShopButtons(data) {
            const autobotExpiresAt = data.auto_tap_expires_at || 0;
            const autobotLevel = data.auto_tap_level || 0;
            const currentTime = Date.now();
            
            // Check if autobot is active
            if (autobotExpiresAt > currentTime && autobotLevel > 0) {
                const remainingMs = autobotExpiresAt - currentTime;
                const hours = Math.floor(remainingMs / 3600000);
                const minutes = Math.floor((remainingMs % 3600000) / 60000);
                const seconds = Math.floor((remainingMs % 60000) / 1000);
                const timeText = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                
                // Block all autobot buttons
                for (let i = 1; i <= 20; i++) {
                    const btn = document.getElementById(`autobot-btn-${i}`);
                    if (btn) {
                        btn.disabled = true;
                        btn.style.background = 'rgba(148,163,184,0.3)';
                        btn.style.cursor = 'not-allowed';
                        
                        // Show countdown only on the purchased button
                        if (i === autobotLevel) {
                            btn.innerHTML = `òÏ-ÿ¬Ï ¦ÞTÁTÂ¦-¦¬¦-TÁTÌ: ${timeText}`;
                            btn.style.background = 'rgba(239,68,68,0.6)';
                        } else {
                            btn.innerHTML = '¨ßÔÒ ¦Ý¦¦¦+¦-TÁTÂTÃ¦¬¦-¦-';
                        }
                    }
                }
                
                // Update countdown
                if (window.autobotShopInterval) clearInterval(window.autobotShopInterval);
                window.autobotShopInterval = setInterval(() => {
                    const now = Date.now();
                    const remainingMs = autobotExpiresAt - now;
                    
                    if (remainingMs <= 0) {
                        clearInterval(window.autobotShopInterval);
                        // Unblock all buttons
                        for (let i = 1; i <= 20; i++) {
                            const btn = document.getElementById(`autobot-btn-${i}`);
                            if (btn) {
                                btn.disabled = false;
                                btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                                btn.style.cursor = 'pointer';
                                btn.innerHTML = `¦ÚTÃ¦¬¦¬TÂTÌ ${window.shopData?.autobot?.items?.[i-1]?.price?.toLocaleString() || 0} ¨ßêÙ`;
                            }
                        }
                        return;
                    }
                    
                    const hours = Math.floor(remainingMs / 3600000);
                    const minutes = Math.floor((remainingMs % 3600000) / 60000);
                    const seconds = Math.floor((remainingMs % 60000) / 1000);
                    const timeText = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                    
                    // Update only the purchased button with countdown
                    const purchasedBtn = document.getElementById(`autobot-btn-${autobotLevel}`);
                    if (purchasedBtn) {
                        purchasedBtn.innerHTML = `òÏ-ÿ¬Ï ¦ÞTÁTÂ¦-¦¬¦-TÁTÌ: ${timeText}`;
                    }
                }, 1000);
            } else {
                // Unblock all buttons
                if (window.autobotShopInterval) clearInterval(window.autobotShopInterval);
                for (let i = 1; i <= 20; i++) {
                    const btn = document.getElementById(`autobot-btn-${i}`);
                    if (btn) {
                        btn.disabled = false;
                        btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                        btn.style.cursor = 'pointer';
                        btn.innerHTML = `¦ÚTÃ¦¬¦¬TÂTÌ ${window.shopData?.autobot?.items?.[i-1]?.price?.toLocaleString() || 0} ¨ßêÙ`;
                    }
                }
            }
        }

        function checkOfflineIncome() {
            fetch('/api/offline_income', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                if (data.offline_time > 0 && data.offline_income > 0) {
                    const hours = Math.floor(data.offline_time / 3600);
                    const minutes = Math.floor((data.offline_time % 3600) / 60);
                    
                    // Check for offline QuanHash income too
                    const offlineHash = data.offline_hash || 0;
                    
                    const offlineContent = `
                        <div style="text-align: center; padding: 25px 15px;">
                            <div style="margin-bottom: 16px;">
                                <div style="font-size: 50px; filter: drop-shadow(0 0 15px rgba(74,222,128,0.6)); margin-bottom: 10px;">¨ßÒ-</div>
                                <div style="font-size: 16px; font-weight: 700; color: #4ade80; margin-bottom: 8px;">¦ßTÀ¦¬¦-¦¦TÂ, TÁ ¦-¦-¦¬¦-TÀ¦-TÉ¦¦¦-¦¬¦¦¦-!</div>
                                <div style="font-size: 11px; color: rgba(255,255,255,0.6); padding: 5px 12px; background: rgba(102,126,234,0.12); border-radius: 12px; display: inline-block;">òÏ-ÿ¬Ï ${hours}TÇ ${minutes}¦-</div>
                            </div>
                            
                            <div style="display: grid; gap: 10px; margin-bottom: 12px;">
                                ${data.offline_income > 0 ? `
                                <div style="background: linear-gradient(135deg, rgba(102,126,234,0.2), rgba(118,75,162,0.2)); border: 1px solid rgba(102,126,234,0.5); border-radius: 14px; padding: 12px 16px; backdrop-filter: blur(10px);">
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.7); margin-bottom: 4px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                        <span>¨ßêÙ</span> <span>¦Ú¦Þ¦Ø¦Ý¦ë</span>
                                    </div>
                                    <div style="font-size: 32px; font-weight: 900; color: #4ade80; letter-spacing: -1px;">+${Math.floor(data.offline_income).toLocaleString()}</div>
                                </div>
                                ` : ''}
                                
                                ${offlineHash > 0 ? `
                                <div style="background: linear-gradient(135deg, rgba(118,75,162,0.2), rgba(240,147,251,0.2)); border: 1px solid rgba(118,75,162,0.5); border-radius: 14px; padding: 12px 16px; backdrop-filter: blur(10px);">
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.7); margin-bottom: 4px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                        <span>¨ßÒÎ</span> <span>QUANHASH</span>
                                    </div>
                                    <div style="font-size: 32px; font-weight: 900; color: #f093fb; letter-spacing: -1px;">+${Math.floor(offlineHash).toLocaleString()}</div>
                                </div>
                                ` : ''}
                            </div>
                            
                            <div style="font-size: 10px; opacity: 0.4; font-style: italic; margin-top: 12px;">òÜè ¦Ô¦-¦-¦-¦-¦¬¦¦¦-¦- ¦-¦- ¦-¦-¦¬¦-¦-TÁ</div>
                        </div>
                    `;
                    document.getElementById('offlineContent').innerHTML = offlineContent;
                    document.getElementById('offlinePopup').classList.add('active');
                    
                    // Update user data
                    fetch('/api/user_data', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({user_id: window.user?.id})
                    })
                    .then(res => res.json())
                    .then(data => {
                        const coins = Math.floor(data.coins || 0);
                        document.getElementById('coins').textContent = coins;
                    });
                }
            });
        }

        // Sound and audio management
        let audioContext = null;
        const sounds = {};
        
        function initAudio() {
            if (!audioContext) {
                try {
                    audioContext = new (window.AudioContext || window.webkitAudioContext)();
                    console.log('AudioContext created, state:', audioContext.state);
                } catch(e) {
                    console.log('Audio not supported:', e);
                    return;
                }
            }
            // Resume AudioContext if suspended (required by modern browsers)
            if (audioContext.state === 'suspended') {
                console.log('AudioContext suspended, attempting to resume...');
                audioContext.resume().then(() => {
                    console.log('AudioContext resumed successfully, state:', audioContext.state);
                }).catch(e => {
                    console.log('Audio resume failed:', e);
                });
            }
        }
        
        function playSound(type) {
            try {
                const soundSetting = localStorage.getItem('soundEnabled');
                // Must be explicitly 'true' to play sound
                const soundEnabled = soundSetting === 'true';
                if (!soundEnabled) {
                    console.log('Sound disabled, setting:', soundSetting);
                    return;
                }
                
                console.log('Playing sound:', type);
                initAudio();
                if (!audioContext) {
                    console.log('AudioContext not available');
                    return;
                }
                
                console.log('AudioContext state:', audioContext.state);
                // Ensure AudioContext is running - resume if suspended
                if (audioContext.state === 'suspended') {
                    console.log('Resuming AudioContext...');
                    audioContext.resume().then(() => {
                        // Context is now running, retry playing sound
                        console.log('AudioContext resumed, retrying sound');
                        playSound(type);
                    }).catch(e => {
                        console.log('Audio resume failed:', e);
                    });
                    return; // Exit and wait for resume to complete
                }
                
                console.log('Creating oscillator for sound:', type, 'AudioContext:', audioContext);
                let oscillator = audioContext.createOscillator();
                console.log('Oscillator created:', oscillator);
                let gainNode = audioContext.createGain();
                console.log('Gain node created:', gainNode);
                
                oscillator.connect(gainNode);
                console.log('Oscillator connected to gain');
                gainNode.connect(audioContext.destination);
                console.log('Gain connected to destination:', audioContext.destination);
                
                gainNode.gain.setValueAtTime(0.3, audioContext.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                console.log('Gain envelope set');
                
                switch(type) {
                    case 'tap':
                        oscillator.frequency.value = 440;
                        oscillator.type = 'sine';
                        oscillator.stop(audioContext.currentTime + 0.1);
                        break;
                    case 'coin':
                        oscillator.frequency.value = 880;
                        oscillator.type = 'square';
                        oscillator.stop(audioContext.currentTime + 0.15);
                        break;
                    case 'levelup':
                        oscillator.frequency.value = 660;
                        oscillator.type = 'sine';
                        oscillator.frequency.exponentialRampToValueAtTime(1320, audioContext.currentTime + 0.3);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                        oscillator.stop(audioContext.currentTime + 0.5);
                        break;
                    case 'error':
                        oscillator.frequency.value = 220;
                        oscillator.type = 'sawtooth';
                        oscillator.frequency.exponentialRampToValueAtTime(110, audioContext.currentTime + 0.3);
                        oscillator.stop(audioContext.currentTime + 0.3);
                        break;
                    case 'success':
                        // Success sound - ascending chime
                        oscillator.frequency.value = 523;
                        oscillator.type = 'triangle';
                        oscillator.frequency.exponentialRampToValueAtTime(1046, audioContext.currentTime + 0.2);
                        oscillator.stop(audioContext.currentTime + 0.3);
                        break;
                    case 'purchase':
                        // Purchase sound - satisfying bell
                        oscillator.frequency.value = 698;
                        oscillator.type = 'triangle';
                        oscillator.frequency.setValueAtTime(698, audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(1397, audioContext.currentTime + 0.15);
                        oscillator.frequency.exponentialRampToValueAtTime(932, audioContext.currentTime + 0.3);
                        oscillator.stop(audioContext.currentTime + 0.4);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                        break;
                    case 'mining':
                        // Mining sound - tech beep
                        oscillator.frequency.value = 440;
                        oscillator.type = 'square';
                        oscillator.frequency.setValueAtTime(440, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(554, audioContext.currentTime + 0.05);
                        oscillator.frequency.setValueAtTime(440, audioContext.currentTime + 0.1);
                        oscillator.stop(audioContext.currentTime + 0.2);
                        break;
                    case 'card':
                        // Card sound - flip sound
                        oscillator.frequency.value = 1047;
                        oscillator.type = 'triangle';
                        oscillator.frequency.exponentialRampToValueAtTime(523, audioContext.currentTime + 0.15);
                        oscillator.stop(audioContext.currentTime + 0.2);
                        break;
                    case 'energy_regen':
                        // Energy regeneration sound - subtle shimmer
                        oscillator.frequency.value = 660;
                        oscillator.type = 'sine';
                        oscillator.frequency.exponentialRampToValueAtTime(1320, audioContext.currentTime + 0.1);
                        oscillator.stop(audioContext.currentTime + 0.15);
                        break;
                    case 'achievement':
                        // Achievement unlock sound - triumphant fanfare
                        oscillator.frequency.value = 392;
                        oscillator.type = 'triangle';
                        oscillator.frequency.setValueAtTime(392, audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(784, audioContext.currentTime + 0.1);
                        oscillator.frequency.exponentialRampToValueAtTime(1047, audioContext.currentTime + 0.25);
                        oscillator.stop(audioContext.currentTime + 0.4);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.4);
                        break;
                    case 'click_boost':
                        // Click boost activation sound - energizing zap
                        oscillator.frequency.value = 880;
                        oscillator.type = 'square';
                        oscillator.frequency.setValueAtTime(880, audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(1760, audioContext.currentTime + 0.08);
                        oscillator.stop(audioContext.currentTime + 0.15);
                        break;
                    case 'vip_levelup':
                        // VIP level up sound - luxurious chime
                        oscillator.frequency.value = 523;
                        oscillator.type = 'triangle';
                        oscillator.frequency.exponentialRampToValueAtTime(1047, audioContext.currentTime + 0.15);
                        oscillator.frequency.exponentialRampToValueAtTime(1568, audioContext.currentTime + 0.35);
                        oscillator.stop(audioContext.currentTime + 0.5);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                        break;
                    case 'collection':
                        // Collection sound - satisfying pickup
                        oscillator.frequency.value = 698;
                        oscillator.type = 'sine';
                        oscillator.frequency.exponentialRampToValueAtTime(932, audioContext.currentTime + 0.1);
                        oscillator.stop(audioContext.currentTime + 0.2);
                        break;
                    case 'bonus':
                        // Bonus sound - cheerful ring
                        oscillator.frequency.value = 440;
                        oscillator.type = 'sine';
                        oscillator.frequency.exponentialRampToValueAtTime(880, audioContext.currentTime + 0.1);
                        oscillator.frequency.exponentialRampToValueAtTime(1320, audioContext.currentTime + 0.25);
                        oscillator.stop(audioContext.currentTime + 0.35);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.35);
                        break;
                    case 'crypto_tap':
                        // Crypto tap sound - money drop
                        oscillator.frequency.value = 880;
                        oscillator.type = 'square';
                        oscillator.frequency.exponentialRampToValueAtTime(1108, audioContext.currentTime + 0.05);
                        oscillator.frequency.exponentialRampToValueAtTime(880, audioContext.currentTime + 0.1);
                        oscillator.stop(audioContext.currentTime + 0.15);
                        break;
                    case 'big_coin':
                        // Big coin collect - satisfying ching
                        oscillator.frequency.value = 523;
                        oscillator.type = 'triangle';
                        oscillator.frequency.setValueAtTime(523, audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(784, audioContext.currentTime + 0.1);
                        oscillator.frequency.exponentialRampToValueAtTime(1047, audioContext.currentTime + 0.2);
                        oscillator.stop(audioContext.currentTime + 0.3);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                        break;
                    case 'stars_collect':
                        // Stars collection - magical sparkle
                        oscillator.frequency.value = 1319;
                        oscillator.type = 'sine';
                        oscillator.frequency.setValueAtTime(1319, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(1568, audioContext.currentTime + 0.05);
                        oscillator.frequency.setValueAtTime(1760, audioContext.currentTime + 0.1);
                        oscillator.frequency.setValueAtTime(1319, audioContext.currentTime + 0.15);
                        oscillator.stop(audioContext.currentTime + 0.25);
                        gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.25);
                        break;
                    case 'machine_working':
                        // Mining machine working - deep rumble
                        oscillator.frequency.value = 110;
                        oscillator.type = 'sawtooth';
                        oscillator.frequency.setValueAtTime(110, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(131, audioContext.currentTime + 0.2);
                        oscillator.frequency.setValueAtTime(110, audioContext.currentTime + 0.4);
                        oscillator.stop(audioContext.currentTime + 0.5);
                        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                        break;
                    case 'rebirth':
                        // Rebirth - dramatic transformation
                        oscillator.frequency.value = 175;
                        oscillator.type = 'triangle';
                        oscillator.frequency.exponentialRampToValueAtTime(349, audioContext.currentTime + 0.3);
                        oscillator.frequency.exponentialRampToValueAtTime(523, audioContext.currentTime + 0.6);
                        oscillator.frequency.exponentialRampToValueAtTime(1047, audioContext.currentTime + 0.9);
                        oscillator.stop(audioContext.currentTime + 1.0);
                        gainNode.gain.setValueAtTime(0.4, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 1.0);
                        break;
                    case 'powerup':
                        // Powerup activated - energy surge
                        oscillator.frequency.value = 880;
                        oscillator.type = 'square';
                        oscillator.frequency.exponentialRampToValueAtTime(1760, audioContext.currentTime + 0.1);
                        oscillator.frequency.exponentialRampToValueAtTime(2637, audioContext.currentTime + 0.2);
                        oscillator.stop(audioContext.currentTime + 0.3);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                        break;
                    case 'critical_hit':
                        // Critical hit - explosive boom
                        oscillator.frequency.value = 220;
                        oscillator.type = 'sawtooth';
                        oscillator.frequency.exponentialRampToValueAtTime(330, audioContext.currentTime + 0.05);
                        oscillator.frequency.exponentialRampToValueAtTime(220, audioContext.currentTime + 0.1);
                        oscillator.stop(audioContext.currentTime + 0.2);
                        gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.2);
                        break;
                    case 'level_milestone':
                        // Level milestone - fanfare
                        oscillator.frequency.value = 523;
                        oscillator.type = 'triangle';
                        oscillator.frequency.setValueAtTime(523, audioContext.currentTime);
                        oscillator.frequency.exponentialRampToValueAtTime(659, audioContext.currentTime + 0.1);
                        oscillator.frequency.exponentialRampToValueAtTime(784, audioContext.currentTime + 0.2);
                        oscillator.frequency.exponentialRampToValueAtTime(1047, audioContext.currentTime + 0.35);
                        oscillator.stop(audioContext.currentTime + 0.5);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.5);
                        break;
                    case 'combo':
                        // Combo multiplier - rising pitch
                        oscillator.frequency.value = 392;
                        oscillator.type = 'sine';
                        oscillator.frequency.exponentialRampToValueAtTime(523, audioContext.currentTime + 0.08);
                        oscillator.frequency.exponentialRampToValueAtTime(659, audioContext.currentTime + 0.16);
                        oscillator.frequency.exponentialRampToValueAtTime(784, audioContext.currentTime + 0.24);
                        oscillator.stop(audioContext.currentTime + 0.3);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
                        break;
                    case 'daily_bonus':
                        // Daily bonus - celebration
                        oscillator.frequency.value = 523;
                        oscillator.type = 'triangle';
                        oscillator.frequency.setValueAtTime(523, audioContext.currentTime);
                        oscillator.frequency.setValueAtTime(659, audioContext.currentTime + 0.1);
                        oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.2);
                        oscillator.frequency.setValueAtTime(1047, audioContext.currentTime + 0.3);
                        oscillator.frequency.setValueAtTime(784, audioContext.currentTime + 0.4);
                        oscillator.stop(audioContext.currentTime + 0.6);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.6);
                        break;
                    case 'shop_hover':
                        // Shop hover - subtle tick
                        oscillator.frequency.value = 1319;
                        oscillator.type = 'sine';
                        oscillator.stop(audioContext.currentTime + 0.05);
                        gainNode.gain.setValueAtTime(0.15, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.05);
                        break;
                    case 'scroll':
                        // Scroll sound - smooth swipe
                        oscillator.frequency.value = 880;
                        oscillator.type = 'sine';
                        oscillator.frequency.exponentialRampToValueAtTime(1047, audioContext.currentTime + 0.05);
                        oscillator.stop(audioContext.currentTime + 0.1);
                        gainNode.gain.setValueAtTime(0.1, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.1);
                        break;
                    case 'notification':
                        // Notification - gentle ping
                        oscillator.frequency.value = 1319;
                        oscillator.type = 'triangle';
                        oscillator.frequency.exponentialRampToValueAtTime(1568, audioContext.currentTime + 0.08);
                        oscillator.stop(audioContext.currentTime + 0.15);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                        break;
                    case 'wrong_action':
                        // Wrong action - buzz
                        oscillator.frequency.value = 150;
                        oscillator.type = 'sawtooth';
                        oscillator.stop(audioContext.currentTime + 0.15);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                        break;
                    case 'open_menu':
                        // Open menu - whoosh
                        oscillator.frequency.value = 349;
                        oscillator.type = 'sine';
                        oscillator.frequency.exponentialRampToValueAtTime(262, audioContext.currentTime + 0.1);
                        oscillator.stop(audioContext.currentTime + 0.15);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                        break;
                    case 'close_menu':
                        // Close menu - reverse whoosh
                        oscillator.frequency.value = 262;
                        oscillator.type = 'sine';
                        oscillator.frequency.exponentialRampToValueAtTime(349, audioContext.currentTime + 0.1);
                        oscillator.stop(audioContext.currentTime + 0.15);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.15);
                        break;
                    case 'click':
                        // Generic click - click
                        oscillator.frequency.value = 1000;
                        oscillator.type = 'square';
                        oscillator.stop(audioContext.currentTime + 0.03);
                        gainNode.gain.setValueAtTime(0.2, audioContext.currentTime);
                        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.03);
                        break;
                    default:
                        oscillator.frequency.value = 440;
                        oscillator.type = 'sine';
                        oscillator.stop(audioContext.currentTime + 0.2);
                }
                
                oscillator.start(audioContext.currentTime);
                console.log('Sound started successfully:', type);
            } catch(e) {
                console.log('Audio error:', e);
            }
        }
        
        function startEnergyRegen() {
            if (energyRegenInterval) clearInterval(energyRegenInterval);
            
            let lastEnergy = 0;
            window.energyRegenRate = 1.0; // Default rate, stored globally
            let energyAccumulator = 0; // For fractional energy regeneration
            let lastUpdateTime = Date.now();
            
            // Get current regeneration rate from the display
            const regenText = document.getElementById('energy-regen-text');
            if (regenText) {
                const match = regenText.textContent.match(/\+(\d+\.?\d*)\/TÁ¦¦¦¦/);
                if (match) {
                    window.energyRegenRate = parseFloat(match[1]);
                }
            }
            
            energyRegenInterval = setInterval(() => {
                const energyText = document.getElementById('energy-text').textContent;
                const [energy, maxEnergy] = energyText.split('/').map(e => parseInt(e));
                
                if (energy < maxEnergy) {
                    const now = Date.now();
                    const deltaTime = (now - lastUpdateTime) / 1000; // Convert to seconds
                    lastUpdateTime = now;
                    
                    // Accumulate energy based on time passed
                    energyAccumulator += window.energyRegenRate * deltaTime;
                    
                    // Only update when we have at least 1 energy to add
                    if (energyAccumulator >= 1) {
                        const energyToAdd = Math.floor(energyAccumulator);
                        energyAccumulator -= energyToAdd; // Keep the remainder
                        
                        const newEnergy = Math.min(energy + energyToAdd, maxEnergy);
                        if (newEnergy !== lastEnergy) {
                            lastEnergy = newEnergy;
                            document.getElementById('energy-text').textContent = `${newEnergy}/${maxEnergy}`;
                            const energyPercent = Math.min(100, Math.max(0, (newEnergy / maxEnergy) * 100));
                            const fillBar = document.getElementById('energy-bar-fill');
                            const percentText = document.getElementById('energy-percent');
                            if (fillBar) {
                                fillBar.style.width = energyPercent + '%';
                            }
                            if (percentText) {
                                percentText.textContent = Math.round(energyPercent) + '%';
                            }
                            
                            // Update server only when energy actually changes
                            fetch('/api/update_energy', {
                                method: 'POST',
                                headers: {'Content-Type': 'application/json'},
                                body: JSON.stringify({user_id: user?.id, energy: newEnergy})
                            });
                        }
                    }
                }
            }, 100); // Update every 100ms for smoother animation
        }

        function tap() {
            // Sound effect
            const soundEnabled = localStorage.getItem('soundEnabled') === 'true';
            if (soundEnabled) {
                playSound('tap');
            }
            
            // Haptic feedback
            const hapticsEnabled = localStorage.getItem('hapticsEnabled') === 'true';
            if (hapticsEnabled && tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
            
            const button = document.querySelector('.tap-button');
            if(button){
                button.classList.add('tap-pressed');
                setTimeout(()=>{if(button)button.classList.remove('tap-pressed');},300);
            }
            
            const energy = parseInt(document.getElementById('energy-text').textContent.split('/')[0]);
            if (energy < 1) {
                const soundEnabled = localStorage.getItem('soundEnabled') === 'true';
                if (soundEnabled) playSound('error');
                tg.showAlert('òÚàÿ¬Ï ¦Ý¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬¦¬!');
                return;
            }
            
            fetch('/api/tap', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    // Only show animation if no modal is open
                    const hasOpenModal = document.querySelector('.modal.active');
                    if (!hasOpenModal) {
                        const button = document.querySelector('.tap-button');
                        if(button){
                            const rect = button.getBoundingClientRect();
                            const centerX = rect.left + rect.width / 2;
                            const centerY = rect.top + rect.height / 2;
                            
                            const coinAnimation = document.createElement('div');
                            coinAnimation.className = 'coin-animation';
                            coinAnimation.textContent = '+' + data.reward;
                            // Position from center of button
                            coinAnimation.style.left = centerX + 'px';
                            coinAnimation.style.top = centerY + 'px';
                            coinAnimation.style.transform = 'translate(-50%, -50%)';
                            coinAnimation.style.zIndex = '1000'; // Lower than modals
                            document.body.appendChild(coinAnimation);
                            setTimeout(() => { 
                                if(document.body.contains(coinAnimation)) {
                                    document.body.removeChild(coinAnimation); 
                                }
                            }, 2000);
                        }
                    }
                    loadData();
                }
            });
        }

        // ¦äTÃ¦-¦¦TÆ¦¬¦¬ ¦+¦¬TÏ TÀ¦-TÁTÇ¦¦TÂ¦- TÆ¦¦¦-TË ¦¬ TÍTÄTÄ¦¦¦¦TÂ¦- ¦¬¦- TÃTÀ¦-¦-¦-TÏ¦- (1-50)
        function calculateTapBoostEffect(level) {
            return Math.floor(level * Math.pow(1.2, level));
        }
        
        function calculateTapBoostPrice(level) {
            return Math.floor(1000 * Math.pow(1.5, level));
        }
        
        function calculateEnergyEffect(level) {
            return Math.round(level * 0.2 * Math.pow(1.15, level) * 100) / 100;
        }
        
        function calculateEnergyPrice(level) {
            return Math.floor(1000 * Math.pow(1.4, level));
        }
        
        function calculateExpandEffect(level) {
            return Math.floor(level * 50 * Math.pow(1.25, level));
        }
        
        function calculateExpandPrice(level) {
            return Math.floor(2000 * Math.pow(1.6, level));
        }
        
        // Name generation functions - simple names
        function generateTapBoostName(level) {
            return '¨ßÒê ¦ãTÁ¦¬¦¬¦¬TÂ¦¦¦¬TÌ ¦â¦-¦¬¦-';
        }
        
        function generateEnergyName(level) {
            return 'òÚá ¦Ô¦-¦-¦-¦-¦¬¦¦¦-¦¬¦¦ ¦í¦-¦¦TÀ¦¦¦¬¦¬';
        }
        
        function generateExpandName(level) {
            return '¨ßÓÈ ¦à¦-TÁTÈ¦¬TÀ¦¦¦-¦¬¦¦ ¦í¦-¦¦TÀ¦¦¦¬¦¬';
        }
        function openShop(e) {
            e.preventDefault();
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'shopModal2';
            
            // Multilevel shop system - EACH item starts at level 0 and grows to 50
            const shopData = {
                'tap_boost': {
                    name: '¨ßÒê ¦ãTÁ¦¬¦¬¦¬TÂ¦¦¦¬TÌ ¦â¦-¦¬¦-',
                    emoji: '¨ßÒê',
                    items: [
                        {level: 0, name: '¨ßÔË ¦Ñ¦-¦¬¦-¦-TË¦¦ ¦ÚTÀ¦¬¦¬TÂ¦--¦ÑTÃTÁTÂ¦¦TÀ', desc: '¦ã¦-¦¦¦¬¦¬TÇ¦¬¦-¦-¦¦TÂ ¦¦¦-¦¬¦¬TÇ¦¦TÁTÂ¦-¦- ¦¦¦-¦¬¦-¦-¦- ¦¬¦- TÂ¦-¦¬. ¦ßTÀ¦-TÁTÂ¦-TÏ, ¦-¦- TÍTÄTÄ¦¦¦¦TÂ¦¬¦-¦-¦-TÏ TÂ¦¦TÅ¦-¦-¦¬¦-¦¦¦¬TÏ ¦+¦¬TÏ ¦-¦-TÇ¦¬¦-¦-TÎTÉ¦¬TÅ ¦¦TÀ¦¬¦¬TÂ¦--TÍ¦-TÂTÃ¦¬¦¬¦-TÁTÂ¦-¦-.', currency: 'coins', locked: false, basePrice: 1000, baseEffect: 1},
                        {level: 0, name: 'òÚá ¦âTÃTÀ¦-¦--¦Ð¦¦TÁ¦¦¦¬¦¦TÀ¦-TÂ¦-TÀ', desc: '¦ãTÁ¦¦¦-TÀTÏ¦¦TÂ ¦¬TÀ¦-TÆ¦¦TÁTÁ ¦+¦-¦-TËTÇ¦¬ ¦¦TÀ¦¬¦¬TÂ¦-¦-¦-¦¬TÎTÂTË. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ ¦¬¦¦TÀ¦¦¦+¦-¦-TË¦¦ ¦-¦¬¦¦¦-TÀ¦¬TÂ¦-TË ¦-¦¬TÂ¦¬¦-¦¬¦¬¦-TÆ¦¬¦¬.', currency: 'coins', locked: false, basePrice: 2500, baseEffect: 3},
                        {level: 0, name: '¨ßÚÀ ¦Ú¦-¦-¦-TÂ¦-¦-TË¦¦ ¦ãTÁ¦¦¦-TÀ¦¬TÂ¦¦¦¬TÌ', desc: '¦Ü¦-TÉ¦-TË¦¦ ¦-TÃTÁTÂ¦¦TÀ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ TÍTÄTÄ¦¦¦¦TÂ¦¬¦-¦-¦-TÁTÂTÌ ¦-¦-¦¦¦-¦¬¦-¦¦¦-. ¦à¦-¦-¦-TÂ¦-¦¦TÂ ¦-¦- ¦¬TÀ¦¬¦-TÆ¦¬¦¬¦-TÅ ¦¦¦-¦-¦-TÂ¦-¦-¦-¦¦ ¦-¦¦TÅ¦-¦-¦¬¦¦¦¬.', currency: 'coins', locked: false, basePrice: 5000, baseEffect: 6},
                        {level: 0, name: '¨ßÒÎ ¦Ð¦¬¦-¦-¦¬¦-TË¦¦ ¦ßTÀ¦-TÆ¦¦TÁTÁ¦-TÀ', desc: '¦í¦¬¦¬TÂ¦-TË¦¦ TÇ¦¬¦¬ ¦+¦¬TÏ ¦-¦-¦¦¦-¦¬¦-¦¦¦-. ¦á¦-¦¬¦+¦-¦- ¦¬¦¬ ¦-¦-¦-¦--¦-¦¬¦-¦-¦¬¦-¦- ¦+¦¬TÏ ¦-¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-¦-¦¦ ¦¬TÀ¦-¦¬¦¬¦-¦-¦+¦¬TÂ¦¦¦¬TÌ¦-¦-TÁTÂ¦¬.', currency: 'coins', locked: false, basePrice: 10000, baseEffect: 12},
                        {level: 0, name: '¨ßÔå ¦ß¦¬¦-¦¬¦-¦¦¦-¦-TË¦¦ ¦à¦¦¦-¦¦TÂ¦-TÀ', desc: '¦Ø¦-¦-¦-¦-¦-TÆ¦¬¦-¦-¦-¦-TÏ TÂ¦¦TÅ¦-¦-¦¬¦-¦¦¦¬TÏ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦-TÏ ¦+¦-¦-TËTÇTÃ. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ ¦¬¦¬¦-¦¬¦-TË ¦+¦¬TÏ TÁ¦-¦¦TÀTÅ¦-TËTÁTÂTÀ¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-.', currency: 'coins', locked: false, basePrice: 20000, baseEffect: 25},
                        {level: 0, name: '¨ßÌß ¦×¦-¦¦¦¬¦+¦-TË¦¦ ¦Ô¦-¦¬¦¦¦-TÂ¦¦¦¬TÌ', desc: '¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦ ¦-TÃTÁTÂ¦¦TÀ ¦¦¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦-¦¦¦- TÃTÀ¦-¦-¦-TÏ. ¦ß¦¬TÂ¦-¦¦TÂTÁTÏ TÍ¦-¦¦TÀ¦¦¦¬¦¦¦¦ ¦+¦-¦¬¦¦¦¦¦¬TÅ ¦¬¦-¦¦¦¬¦+.', currency: 'coins', locked: false, basePrice: 40000, baseEffect: 50},
                        {level: 0, name: '¨ßÌÌ ¦Ó¦-¦¬¦-¦¦TÂ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦ãTÁ¦¬¦¬¦¬TÂ¦¦¦¬TÌ', desc: '¦Ü¦¬TÄ¦¬TÇ¦¦TÁ¦¦¦-TÏ TÂ¦¦TÅ¦-¦-¦¬¦-¦¦¦¬TÏ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦-TÏ ¦-¦-¦¦¦-¦¬¦-¦¦. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÁ¦¬¦¬TÃ TÆ¦¦¦¬TËTÅ ¦¦¦-¦¬¦-¦¦TÂ¦¬¦¦.', currency: 'coins', locked: false, basePrice: 80000, baseEffect: 100},
                        {level: 0, name: 'òÚÛÿ¬Ï ¦ÐTÂ¦-¦-¦-TË¦¦ ¦á¦¬¦-TÂ¦¦¦¬¦-TÂ¦-TÀ', desc: '¦Ñ¦-¦¦¦¦TÁTÂ¦-¦¦¦-¦-¦-TÏ TÂ¦¦TÅ¦-¦-¦¬¦-¦¦¦¬TÏ TÁ¦¬¦-TÂ¦¦¦¬¦-. ¦à¦-¦-¦-TÂ¦-¦¦TÂ ¦-¦- ¦¬TÀ¦¬¦-TÆ¦¬¦¬¦-TÅ TÏ¦+¦¦TÀ¦-¦-¦¦¦- TÁ¦¬¦-TÂ¦¦¦¬¦-.', currency: 'coins', locked: false, basePrice: 150000, baseEffect: 200},
                        {level: 0, name: '¨ßÌà ¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦-TÏ ¦áTÂ¦-¦-TÆ¦¬TÏ', desc: '¦ÞTÀ¦-¦¬TÂ¦-¦¬TÌ¦-¦-TÏ ¦-¦-¦¦¦-¦¬¦-¦¦-TÁTÂ¦-¦-TÆ¦¬TÏ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦-TÏ ¦+¦-¦-TËTÇTÃ. ¦Ô¦-¦-TË¦-¦-¦¦TÂ ¦¦TÀ¦¬¦¬TÂ¦-¦-¦-¦¬TÎTÂTÃ ¦- ¦¦¦-TÁ¦-¦-TÁ¦¦.', currency: 'coins', locked: false, basePrice: 300000, baseEffect: 400},
                        {level: 0, name: '¨ßÔî ¦Ú¦-¦-¦-TÂ¦-¦-TË¦¦ ¦ß¦-TÀTÂ¦-¦¬', desc: '¦ß¦-TÀTÂ¦-¦¬ ¦- ¦¬¦-TÀ¦-¦¬¦¬¦¦¦¬TÌ¦-TË¦¦ ¦¬¦¬¦-¦¦TÀ¦¦¦-¦¬TÏ. ¦Ü¦-¦¦¦-¦¬TÂ ¦¦TÀ¦¬¦¬TÂ¦-¦-¦-¦¬TÎTÂTÃ ¦¬¦¬ ¦+TÀTÃ¦¦¦¬TÅ ¦-TÁ¦¦¦¬¦¦¦-¦-TËTÅ.', currency: 'coins', locked: false, basePrice: 600000, baseEffect: 800}
                    ]
                },
                'energy_buy': {
                    name: 'òÚá ¦Ò¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¦¦-¦¬¦¦ ¦í¦-¦¦TÀ¦¦¦¬¦¬',
                    emoji: 'òÚá',
                    items: [
                        {level: 0, name: '¨ßÔË ¦á¦-¦¬¦-¦¦TÇ¦-¦-TÏ ¦ß¦-¦-¦¦¦¬TÌ', desc: '¦Ñ¦-¦¬¦-¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ TÍ¦-¦¦TÀ¦¦¦¬¦¬. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÁ¦-¦¬¦-¦¦TÇ¦-TË¦¦ TÁ¦-¦¦TÂ ¦+¦¬TÏ ¦¬¦-¦+¦¬¦-TÀTÏ¦+¦¦¦¬.', currency: 'coins', locked: false, basePrice: 1500, baseEffect: 0.5},
                        {level: 0, name: 'òÚá ¦Ò¦¦TÂTÀTÏ¦-¦-TÏ ¦âTÃTÀ¦-¦¬¦-¦-', desc: '¦ã¦¬TÃTÇTÈ¦¦¦-¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦ßTÀ¦¦¦-¦-TÀ¦-¦¬TÃ¦¦TÂ ¦¦¦¬¦-¦¦TÂ¦¬TÇ¦¦TÁ¦¦TÃTÎ TÍ¦-¦¦TÀ¦¦¦¬TÎ ¦- TÍ¦¬¦¦¦¦TÂTÀ¦¬TÇ¦¦TÁ¦¦TÃTÎ.', currency: 'coins', locked: false, basePrice: 3500, baseEffect: 1.2},
                        {level: 0, name: '¨ßÔå ¦Ó¦¦¦-TÂ¦¦TÀ¦-¦-¦¬TÌ¦-¦-TÏ ¦áTÂ¦-¦-TÆ¦¬TÏ', desc: '¦ßTÀ¦-¦+¦-¦¬¦-TÃTÂTË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÂ¦¦¦¬¦¬¦- ¦¬¦¦¦-¦-TËTÅ ¦-¦¦¦+TÀ.', currency: 'coins', locked: false, basePrice: 7000, baseEffect: 2.5},
                        {level: 0, name: '¨ßÒÎ ¦ÚTÀ¦¬TÁTÂ¦-¦¬TÌ¦-TË¦¦ ¦à¦¦¦-¦¦TÂ¦-TÀ', desc: '¦í¦¬¦¬TÂ¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦à¦-¦-¦-TÂ¦-¦¦TÂ ¦-¦- ¦¦TÀ¦¬TÁTÂ¦-¦¬¦¬¦-TÅ TÁ ¦-TËTÁ¦-¦¦¦-¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌTÎ.', currency: 'coins', locked: false, basePrice: 14000, baseEffect: 5.0},
                        {level: 0, name: '¨ßÌß ¦×¦-¦¦¦¬¦+¦-TË¦¦ ¦Ú¦-¦¬¦¬¦¦¦¦TÂ¦-TÀ', desc: '¦Ü¦-TÁTÂ¦¦TÀ-¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦á¦-¦-¦¬TÀ¦-¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ ¦+¦-¦¬¦¦¦¦¦¬TÅ ¦¬¦-¦¦¦¬¦+.', currency: 'coins', locked: false, basePrice: 28000, baseEffect: 10.0},
                        {level: 0, name: '¨ßÌÌ ¦Ó¦-¦¬¦-¦¦TÂ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦ãTÁ¦¦¦-TÀ¦¬TÂ¦¦¦¬TÌ', desc: '¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÁ¦¬¦¬TÃ ¦-TÀ¦-TÉ¦¦¦-¦¬TÏ ¦¦¦-¦¬¦-¦¦TÂ¦¬¦¦.', currency: 'coins', locked: false, basePrice: 55000, baseEffect: 20.0},
                        {level: 0, name: 'òÚÛÿ¬Ï ¦ÐTÂ¦-¦-¦-TË¦¦ ¦á¦¬¦-TÂ¦¦¦¬¦-TÂ¦-TÀ', desc: '¦Ü¦¬TÄ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦à¦-¦-¦-TÂ¦-¦¦TÂ ¦-¦- ¦¬TÀ¦¬¦-TÆ¦¬¦¬¦-TÅ TÂ¦¦TÀ¦-¦-TÏ¦+¦¦TÀ¦-¦-¦¦¦- TÁ¦¬¦-TÂ¦¦¦¬¦-.', currency: 'coins', locked: false, basePrice: 110000, baseEffect: 40.0},
                        {level: 0, name: '¨ßÌà ¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦-TÏ ¦áTÂ¦-¦-TÆ¦¬TÏ', desc: '¦Ñ¦-¦¦¦¦TÁTÂ¦-¦¦¦-¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦ÞTÀ¦-¦¬TÂ¦-¦¬TÌ¦-¦-TÏ TÁTÂ¦-¦-TÆ¦¬TÏ TÁ ¦-¦¦¦-¦¦TÀ¦-¦-¦¬TÇ¦¦¦-¦-TË¦-¦¬ TÀ¦¦TÁTÃTÀTÁ¦-¦-¦¬.', currency: 'coins', locked: false, basePrice: 220000, baseEffect: 80.0},
                        {level: 0, name: '¨ßÔî ¦Ú¦-¦-¦-TÂ¦-¦-TË¦¦ ¦Ú¦-¦-¦+¦¦¦-TÁ¦-TÂ¦-TÀ', desc: '¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ ¦¦¦-¦-¦-TÂ¦-¦-TË¦¦ TÄ¦¬TÃ¦¦TÂTÃ¦-TÆ¦¬¦¬ ¦-¦-¦¦TÃTÃ¦-¦-.', currency: 'coins', locked: false, basePrice: 440000, baseEffect: 160.0},
                        {level: 0, name: '¨ßÌÌ ¦â¦¦¦-¦-¦-TÏ ¦Ü¦-TÂ¦¦TÀ¦¬TÏ', desc: '¦Ú¦-¦-¦-TÂ¦-¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ. ¦ßTÀ¦¦¦-¦-TÀ¦-¦¬TÃ¦¦TÂ TÂ¦¦¦-¦-TÃTÎ ¦-¦-TÂ¦¦TÀ¦¬TÎ ¦- TÇ¦¬TÁTÂTÃTÎ TÍ¦-¦¦TÀ¦¦¦¬TÎ.', currency: 'coins', locked: false, basePrice: 880000, baseEffect: 320.0}
                    ]
                },
                'energy_expand': {
                    name: '¨ßÓÈ ¦à¦-TÁTÈ¦¬TÀ¦¦¦-¦¬¦¦ ¦í¦-¦¦TÀ¦¦¦¬¦¬',
                    emoji: '¨ßÓÈ',
                    items: [
                        {level: 0, name: '¨ßÔË ¦Û¦¬TÂ¦¬¦¦-¦Ø¦-¦-¦-¦-TÏ ¦Ñ¦-TÂ¦-TÀ¦¦TÏ', desc: '¦Ñ¦-¦¬¦-¦-TË¦¦ ¦-¦¦¦¦TÃ¦-TÃ¦¬TÏTÂ¦-TÀ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TÃTÎ TÍ¦-¦¦TÀ¦¦¦¬TÎ. ¦á¦-¦-TÀ¦¦¦-¦¦¦-¦-¦-TÏ TÂ¦¦TÅ¦-¦-¦¬¦-¦¦¦¬TÏ ¦+¦¬TÏ ¦-¦-¦+¦¦¦¦¦-¦-¦¦¦- TÅTÀ¦-¦-¦¦¦-¦¬TÏ TÍ¦-¦¦TÀ¦¦¦¬¦¬.', currency: 'coins', locked: false, basePrice: 2000, baseEffect: 50},
                        {level: 0, name: 'òÚá ¦áTÃ¦¬¦¦TÀ¦¦¦-¦-¦+¦¦¦-TÁ¦-TÂ¦-TÀ', desc: '¦ã¦¬TÃTÇTÈ¦¦¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÀ¦-TÁTÈ¦¬TÀTÏTÎTÉ¦¬¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌ. ¦Ü¦¦¦-¦-¦-¦¦¦-¦-¦-TÏ ¦¬¦-TÀTÏ¦+¦¦¦- ¦¬ TÀ¦-¦¬TÀTÏ¦+¦¦¦- TÁ ¦-TËTÁ¦-¦¦¦-¦¦ TÍTÄTÄ¦¦¦¦TÂ¦¬¦-¦-¦-TÁTÂTÌTÎ.', currency: 'coins', locked: false, basePrice: 5000, baseEffect: 120},
                        {level: 0, name: '¨ßÔå ¦â¦¦TÀ¦-¦-TÏ¦+¦¦TÀ¦-¦-TÏ ¦Ñ¦-TÂ¦-TÀ¦¦TÏ', desc: '¦ßTÀ¦-¦+¦-¦¬¦-TÃTÂTË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦TÁ¦¬¦-TÃ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ TÂ¦¦TÀ¦-¦-TÏ¦+¦¦TÀ¦-¦-¦¦¦- TÁ¦¬¦-TÂ¦¦¦¬¦-.', currency: 'coins', locked: false, basePrice: 10000, baseEffect: 250},
                        {level: 0, name: '¨ßÒÎ ¦ÚTÀ¦¬TÁTÂ¦-¦¬TÌ¦-¦-TÏ ¦Ü¦-TÂTÀ¦¬TÆ¦-', desc: '¦í¦¬¦¬TÂ¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÀ¦-TÁTÈ¦¬TÀTÏTÎTÉ¦¬¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌ. ¦Ü¦-TÂTÀ¦¬TÆ¦- ¦¬¦¬ ¦¦TÀ¦¬TÁTÂ¦-¦¬¦¬¦-¦- TÁ ¦-¦¦¦-¦¦TÀ¦-TÏTÂ¦-¦-¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌTÎ.', currency: 'coins', locked: false, basePrice: 20000, baseEffect: 500},
                        {level: 0, name: '¨ßÌß ¦×¦-¦¦¦¬¦+¦-¦-¦¦ ¦ï¦+TÀ¦-', desc: '¦Ü¦-TÁTÂ¦¦TÀ-¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦TÁ¦¬¦-TÃ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬. ¦á¦-¦+¦¦TÀ¦¦¦¬TÂ TÁ¦¦¦-TÂTÃTÎ TÍ¦-¦¦TÀ¦¦¦¬TÎ ¦¬¦-¦¦¦¬¦+TË.', currency: 'coins', locked: false, basePrice: 40000, baseEffect: 1000},
                        {level: 0, name: '¨ßÌÌ ¦Ó¦-¦¬¦-¦¦TÂ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦à¦¦¦¬¦¦TÀ¦-TÃ¦-TÀ', desc: '¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÀ¦-TÁTÈ¦¬TÀTÏTÎTÉ¦¬¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌ. ¦åTÀ¦-¦-¦¬TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ TÆ¦¦¦¬¦-¦¦ ¦¦¦-¦¬¦-¦¦TÂ¦¬¦¦¦¬.', currency: 'coins', locked: false, basePrice: 80000, baseEffect: 2000},
                        {level: 0, name: 'òÚÛÿ¬Ï ¦Ú¦-¦-¦-TÂ¦-¦-¦-TÏ ¦áTÃ¦¬¦¦TÀ¦¬¦-¦¬¦¬TÆ¦¬TÏ', desc: '¦Ü¦¬TÄ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦TÁ¦¬¦-TÃ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ ¦¦¦-¦-¦-TÂ¦-¦-TÃTÎ TÁTÃ¦¬¦¦TÀ¦¬¦-¦¬¦¬TÆ¦¬TÎ ¦+¦¬TÏ TÅTÀ¦-¦-¦¦¦-¦¬TÏ.', currency: 'coins', locked: false, basePrice: 160000, baseEffect: 4000},
                        {level: 0, name: '¨ßÌà ¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦ß¦-TÀTÂ¦-¦¬', desc: '¦Ñ¦-¦¦¦¦TÁTÂ¦-¦¦¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÀ¦-TÁTÈ¦¬TÀTÏTÎTÉ¦¬¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌ. ¦ß¦-¦+¦¦¦¬TÎTÇ¦-¦¦TÂTÁTÏ ¦¦ TÍ¦-¦¦TÀ¦¦¦¦TÂ¦¬TÇ¦¦TÁ¦¦¦¬¦- ¦¬¦-TÀTÂ¦-¦¬¦-¦- ¦-TÁ¦¦¦¬¦¦¦-¦-¦-¦¦.', currency: 'coins', locked: false, basePrice: 320000, baseEffect: 8000},
                        {level: 0, name: '¨ßÔî ¦â¦¦¦-¦-¦-TÏ ¦í¦-¦¦TÀ¦¦¦¬TÏ', desc: '¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦TÁ¦¬¦-TÃ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ ¦¬¦-¦¦¦-¦+¦-TÇ¦-TÃTÎ TÂ¦¦¦-¦-TÃTÎ TÍ¦-¦¦TÀ¦¦¦¬TÎ.', currency: 'coins', locked: false, basePrice: 640000, baseEffect: 16000},
                        {level: 0, name: '¨ßÌÌ ¦ÜTÃ¦¬TÌTÂ¦¬¦-TÁ¦¦¦¬¦¦¦-¦-¦-TÏ', desc: '¦Ú¦-¦-¦-TÂ¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÀ¦-TÁTÈ¦¬TÀTÏTÎTÉ¦¬¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌ. ¦ß¦-¦+¦¦¦¬TÎTÇ¦-¦¦TÂTÁTÏ ¦¦ TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦¬¦-TÀ¦-¦¬¦¬¦¦¦¬TÌ¦-TËTÅ ¦-TÁ¦¦¦¬¦¦¦-¦-TËTÅ.', currency: 'coins', locked: false, basePrice: 1280000, baseEffect: 32000}
                    ]
                },
                'autobot': {
                    name: '¨ßäÖ ¦ÚTÀ¦¬¦¬TÂ¦--¦Ñ¦-TÂTË',
                    emoji: '¨ßäÖ',
                    items: [
                        // 10 ¦¬¦-¦¬¦¬TÆ¦¬¦¦ ¦¬¦- ¦¦¦-¦¬¦-TË (¦-TÁ¦¦¦¦¦+¦- 1 TÂ¦-¦¬/TÁ¦¦¦¦)
                        {level: 1, name: '¨ßäÖ ¦Ñ¦-¦¬¦-¦-TË¦¦ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 15 ¦-¦¬¦-TÃTÂ', speed: 1, duration: 15, price: 2000, currency: 'coins', locked: false},
                        {level: 2, name: 'òÚá ¦ã¦¬TÃTÇTÈ¦¦¦-¦-TË¦¦ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 30 ¦-¦¬¦-TÃTÂ', speed: 1, duration: 30, price: 5000, currency: 'coins', locked: false},
                        {level: 3, name: '¨ßÌß ¦ßTÀ¦-¦+¦-¦¬¦-TÃTÂTË¦¦ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 1 TÇ¦-TÁ', speed: 1, duration: 60, price: 10000, currency: 'coins', locked: false},
                        {level: 4, name: '¨ßÒÎ ¦í¦¬¦¬TÂ¦-TË¦¦ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 2 TÇ¦-TÁ¦-', speed: 1, duration: 120, price: 20000, currency: 'coins', locked: false},
                        {level: 5, name: '¨ßÑÑ ¦ßTÀ¦¦¦-¦¬TÃ¦- ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 4 TÇ¦-TÁ¦-', speed: 1, duration: 240, price: 40000, currency: 'coins', locked: false},
                        {level: 6, name: '¨ßÌÌ ¦Ü¦-TÁTÂ¦¦TÀ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 6 TÇ¦-TÁ¦-¦-', speed: 1, duration: 360, price: 80000, currency: 'coins', locked: false},
                        {level: 7, name: '¨ßÒë ¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 12 TÇ¦-TÁ¦-¦-', speed: 1, duration: 720, price: 160000, currency: 'coins', locked: false},
                        {level: 8, name: '¨ßÔå ¦Ü¦¬TÄ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 1 ¦+¦¦¦-TÌ', speed: 1, duration: 1440, price: 320000, currency: 'coins', locked: false},
                        {level: 9, name: 'òÚá ¦Ñ¦-¦¦¦¦TÁTÂ¦-¦¦¦-¦-TË¦¦ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 2 ¦+¦-TÏ', speed: 1, duration: 2880, price: 640000, currency: 'coins', locked: false},
                        {level: 10, name: '¨ßÑÑ ¦Ø¦-¦¬¦¦TÀ¦-TÂ¦-TÀTÁ¦¦¦¬¦¦ ¦Ñ¦-TÂ', desc: '¦Ð¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 3 ¦+¦-TÏ', speed: 1, duration: 4320, price: 1280000, currency: 'coins', locked: false},
                    ]
                }
            };
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 450px; max-height: 85vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;border: 2px solid rgba(167,139,250,0.4);box-shadow: 0 10px 40px rgba(167,139,250,0.3);">
                    <div style="background:linear-gradient(135deg,#a78bfa,#c084fc,#d946ef);padding:20px;border-radius:22px 22px 0 0;text-align:center;position:relative;">
                        <h2 style="font-size: 22px; color: #fff; margin: 0; font-weight: 900;">¨ßÛÒ ¦Ü¦Ð¦Ó¦Ð¦×¦Ø¦Ý</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                    </div>
                    <div style="padding:20px;">
                        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:20px;">
                            <button class="shop-cat-btn" data-category="tap_boost" onclick="loadShopCategory('tap_boost')" style="padding:12px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:13px;">¨ßÒê ¦ãTÁ¦¬¦¬¦¬TÂ¦¦¦¬TÌ ¦â¦-¦¬¦-</button>
                            <button class="shop-cat-btn" data-category="energy_buy" onclick="loadShopCategory('energy_buy')" style="padding:12px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:12px;cursor:pointer;font-weight:700;font-size:13px;">òÚá ¦Ò¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¦¦-¦¬¦¦ ¦í¦-¦¦TÀ¦¦¦¬¦¬</button>
                            <button class="shop-cat-btn" data-category="energy_expand" onclick="loadShopCategory('energy_expand')" style="padding:12px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:12px;cursor:pointer;font-weight:700;font-size:13px;">¨ßÓÈ ¦à¦-TÁTÈ¦¬TÀ¦¦¦-¦¬¦¦ ¦í¦-¦¦TÀ¦¦¦¬¦¬</button>
                            <button class="shop-cat-btn" data-category="autobot" onclick="loadShopCategory('autobot')" style="padding:12px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:12px;cursor:pointer;font-weight:700;font-size:13px;">¨ßäÖ ¦Ð¦-TÂ¦-¦-¦-TÂ</button>
                        </div>
                        <!-- VIP Button Row -->
                        <div id="vipButtonRow" style="margin-bottom:15px;">
                            <div style="padding:6px;background:linear-gradient(135deg,rgba(255,215,0,0.2),rgba(255,237,78,0.2),rgba(255,215,0,0.2));border:2px solid rgba(255,215,0,0.7);border-radius:12px;position:relative;box-shadow:0 4px 15px rgba(255,215,0,0.3);">
                                <!-- Premium Button -->
                                <button id="vipButton" onclick="openVIPModal('tap_boost')" style="width:100%;padding:8px 12px;background:linear-gradient(135deg,#ffd700,#ffed4e,#ffd700);color:#000;border:2px solid #ffd700;border-radius:8px;cursor:pointer;font-weight:800;font-size:14px;transition:all 0.3s;box-shadow:0 3px 10px rgba(255,215,0,0.4);position:relative;display:flex;align-items:center;justify-content:center;" onmousedown="this.style.transform='scale(0.97)'" onmouseup="this.style.transform='scale(1)'" onmouseleave="this.style.transform='scale(1)'">
                                    <span style="font-size:18px;margin-right:8px;text-shadow:0 2px 4px rgba(0,0,0,0.3);filter:drop-shadow(0 0 3px rgba(255,215,0,0.8));">òíÐ</span>
                                    <span style="flex:1;text-align:center;">¦ÚTÃ¦¬¦¬TÂTÌ VIP TÄTÃ¦-¦¦TÆ¦¬¦¬ ¦¬¦- Telegram Stars</span>
                                    <div style="background:linear-gradient(135deg,#000,#333);color:#fff;padding:2px 6px;border-radius:4px;font-size:10px;font-weight:900;margin-left:8px;">VIP</div>
                                </button>
                            </div>
                        </div>
                        <div id="shopItemsList" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;"></div>
                        
                        <!-- ¦áTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ -->
                        <button class="category-close-btn" onclick="this.closest('.modal').remove()">
                            òÜÕ ¦×¦-¦¦TÀTËTÂTÌ ¦-¦-¦¦¦-¦¬¦¬¦-
                        </button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            // Store regular shop data first, then add VIP data
            window.shopData = shopData; // Store regular shop data
            // Add VIP data for VIP categories only
            window.shopData['tap_boost_vip'] = vipData['tap_boost'];
            window.shopData['energy_buy_vip'] = vipData['energy_buy'];
            window.shopData['energy_expand_vip'] = vipData['energy_expand'];
            window.shopData['autobot_vip'] = vipData['autobot'];
            
            // Load user's shop levels from database
            loadShopLevels();
            
            loadShopCategory('tap_boost');
        }
        
        function showVIPShopSection() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const vipLevel = data.vip_level || 0;
                const listDiv = document.getElementById('shopItemsList');
                
                if (vipLevel >= 3 && listDiv && !listDiv.querySelector('.vip-boosts-section')) {
                    const vipSection = document.createElement('div');
                    vipSection.className = 'vip-boosts-section';
                    vipSection.innerHTML = `
                        <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:12px;border-radius:12px;margin-bottom:15px;border:2px solid #ffd700;">
                            <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;">
                                <div style="font-size:14px;font-weight:700;color:#000;margin-bottom:5px;">¨ßÑÑ VIP BOOST 20x</div>
                                <div style="font-size:11px;color:rgba(0,0,0,0.7);margin-bottom:8px;">x20 ¦+¦-TÅ¦-¦+ ¦-¦- 1 TÇ¦-TÁ òÀâ ¦â¦-¦¬TÌ¦¦¦- ¦+¦¬TÏ VIP</div>
                                <div style="font-size:10px;color:#000;margin-bottom:8px;">òÜÅ ¦âTÀ¦¦¦-TÃ¦¦TÂTÁTÏ Gold VIP+</div>
                                <button onclick="buyVIPBoost('vip_boost_20x', 5000000)" style="width:100%;padding:10px;background:#000;color:#ffd700;border:none;border-radius:8px;font-weight:800;font-size:12px;cursor:pointer;">¨ßÒ- 5M ¨ßêÙ</button>
                            </div>
                        </div>
                        ${vipLevel >= 5 ? `
                        <div style="background:linear-gradient(135deg,#c084fc,#a78bfa);padding:12px;border-radius:12px;margin-bottom:15px;border:2px solid #c084fc;">
                            <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;">
                                <div style="font-size:14px;font-weight:700;color:#fff;margin-bottom:5px;">¨ßÒÎ DIAMOND BOOST 50x</div>
                                <div style="font-size:11px;color:rgba(255,255,255,0.8);margin-bottom:8px;">x50 ¦+¦-TÅ¦-¦+ ¦-¦- 24 TÇ¦-TÁ¦-</div>
                                <div style="font-size:10px;color:#c084fc;margin-bottom:8px;">òÜÅ ¦â¦-¦¬TÌ¦¦¦- ¦+¦¬TÏ Diamond VIP</div>
                                <button onclick="buyVIPBoost('diamond_boost_50x', 20000000)" style="width:100%;padding:10px;background:#fff;color:#a78bfa;border:none;border-radius:8px;font-weight:800;font-size:12px;cursor:pointer;">¨ßÒ- 20M ¨ßêÙ</button>
                            </div>
                        </div>
                        ` : ''}
                    `;
                    if (listDiv) {
                        listDiv.insertBefore(vipSection, listDiv.firstChild);
                    }
                }
            });
        }
        
        function buyVIPBoost(boostType, price) {
            fetch('/api/buy_vip_boost', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: user?.id,
                    boost_type: boostType,
                    price: price
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('òÜÅ VIP ¦-TÃTÁTÂ ¦-¦¦TÂ¦¬¦-¦¬TÀ¦-¦-¦-¦-!');
                    loadData();
                } else {
                    tg.showAlert('òÝÌ ' + data.error);
                }
            })
            .catch(err => tg.showAlert('òÝÌ ¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÃ¦¬¦¦¦¬'));
        }
        
        function openVIPModal(category) {
            const vipCategory = category + '_vip';
            const vipItems = window.shopData[vipCategory];
            if (!vipItems) return;
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'vipModal';
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 480px; max-height: 80vh; overflow-y: auto; background: linear-gradient(135deg, rgba(0,0,0,0.95), rgba(20,20,30,0.98)); border-radius: 24px; border: 2px solid rgba(255,215,0,0.7); box-shadow: 0 20px 60px rgba(255,215,0,0.3), 0 0 0 1px rgba(255,255,255,0.1); backdrop-filter: blur(20px);">
                    <div style="background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700); padding: 20px 50px 20px 20px; border-radius: 22px 22px 0 0; text-align: center; position: relative; box-shadow: 0 8px 30px rgba(255,215,0,0.4);">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 12px;">
                            <div style="font-size: 36px; text-shadow: 0 3px 10px rgba(0,0,0,0.3); filter: drop-shadow(0 0 6px rgba(255,215,0,0.8)); animation: pulse 2s infinite;">òíÐ</div>
                            <div>
                                <h2 style="font-size: 24px; color: #000; margin: 0; font-weight: 900; text-shadow: 0 2px 6px rgba(0,0,0,0.2);">${vipItems.name}</h2>
                                <div style="font-size: 14px; color: rgba(0,0,0,0.7); margin-top: 4px; font-weight: 600;">VIP TÄTÃ¦-¦¦TÆ¦¬¦¬ ¦¬¦- Telegram Stars</div>
                            </div>
                        </div>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                    </div>
                    
                    <div style="padding: 20px;">
                        <div style="display: grid; gap: 12px;">
                            ${vipItems.items.map(item => `
                                <div style="background: linear-gradient(135deg, rgba(255,215,0,0.12), rgba(255,237,78,0.18)); padding: 16px; border-radius: 16px; border: 1px solid rgba(255,215,0,0.3); position: relative; backdrop-filter: blur(8px); box-shadow: 0 6px 20px rgba(255,215,0,0.15); transition: all 0.3s ease; overflow: hidden; background-size: 200% 200%; animation: shimmer 3s ease-in-out infinite;" onmouseover="this.style.transform='translateY(-3px) scale(1.02)';this.style.boxShadow='0 10px 30px rgba(255,215,0,0.25)';this.style.background='linear-gradient(135deg, rgba(255,215,0,0.2), rgba(255,237,78,0.25))'" onmouseout="this.style.transform='translateY(0) scale(1)';this.style.boxShadow='0 6px 20px rgba(255,215,0,0.15)';this.style.background='linear-gradient(135deg, rgba(255,215,0,0.12), rgba(255,237,78,0.18))'">
                                    <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 6px;">
                                        <span style="font-size: 20px; filter: drop-shadow(0 0 4px rgba(255,215,0,0.6));">${item.name.split(' ')[0]}</span>
                                        <div style="flex: 1;">
                                            <div style="font-weight: 800; font-size: 14px; color: #fff; text-shadow: 0 1px 3px rgba(0,0,0,0.3);">${item.name.split(' ').slice(1).join(' ')}</div>
                                            <div style="font-size: 11px; color: rgba(255,255,255,0.8); margin-top: 2px;">${item.desc}</div>
                                        </div>
                                        <div style="background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700); color: #000; padding: 4px 8px; border-radius: 8px; font-size: 11px; font-weight: 900; text-shadow: 0 1px 3px rgba(0,0,0,0.3); border: 1px solid #ffd700; box-shadow: 0 3px 8px rgba(255,215,0,0.4); position: relative; overflow: hidden;">
                                            <div style="position: absolute; top: 0; left: -100%; width: 100%; height: 100%; background: linear-gradient(90deg, transparent, rgba(255,255,255,0.4), transparent); animation: shimmer 2s infinite;"></div>
                                            <span style="font-size: 12px; font-weight: 900; text-shadow: 0 1px 2px rgba(0,0,0,0.4);">VIP</span>
                                        </div>
                                    </div>
                                    
                                    ${category === 'autobot' || category === 'autobot_vip' ? `
                                        <div style="background: rgba(74,222,128,0.2); padding: 8px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                                            <span style="color: #4ade80; font-size: 12px; font-weight: 700;">òÏ-ÿ¬Ï ¦Ô¦¬¦¬TÂ¦¦¦¬TÌ¦-¦-TÁTÂTÌ:</span>
                                            <span style="color: #fff; font-size: 12px; font-weight: 800;">${item.duration < 60 ? item.duration + ' ¦-¦¬¦-TÃTÂ' : Math.floor(item.duration / 60) + ' TÇ¦-TÁ¦-¦-'}</span>
                                        </div>
                                        <div style="background: rgba(74,222,128,0.2); padding: 8px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                                            <span style="color: #4ade80; font-size: 12px; font-weight: 700;">òÚá ¦á¦¦¦-TÀ¦-TÁTÂTÌ:</span>
                                            <span style="color: #4ade80; font-size: 12px; font-weight: 800;">${item.speed} TÂ¦-¦¬¦-¦-/TÁ¦¦¦¦</span>
                                        </div>
                                    ` : ''}
                                    
                                    <button onclick="buyWithStars('${category}', ${item.level}, ${item.basePrice || item.price})" 
                                            style="width: 100%; padding: 10px 12px; background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700); color: #000; border: 1px solid #ffd700; border-radius: 10px; cursor: pointer; font-weight: 800; font-size: 13px; transition: all 0.3s; position: relative; overflow: hidden; box-shadow: 0 4px 12px rgba(255,215,0,0.3); text-shadow: 0 1px 2px rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; gap: 6px;"
                                            onmousedown="this.style.transform='scale(0.98)'; this.style.boxShadow='0 6px 16px rgba(255,215,0,0.4)'"
                                            onmouseup="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(255,215,0,0.3)'"
                                            onmouseleave="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 12px rgba(255,215,0,0.3)'">
                                        <span>¦ÚTÃ¦¬¦¬TÂTÌ ¦¬¦- ${item.basePrice || item.price}</span>
                                        <span style="font-size: 16px; filter: drop-shadow(0 0 3px rgba(255,215,0,0.8)); text-shadow: 0 1px 2px rgba(0,0,0,0.3);">òíÐ</span>
                                        <span>Telegram Stars</span>
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                        
                        <!-- VIP TÁTÂ¦¬¦¬TÌ¦-¦-TÏ ¦¦¦-¦-¦¬¦¦¦- ¦¬¦-¦¦TÀTËTÂ¦¬TÏ -->
                        <button class="vip-close-btn" onclick="this.closest('.modal').remove()">
                            ¨ßÑÑ ¦×¦-¦¦TÀTËTÂTÌ VIP TÄTÃ¦-¦¦TÆ¦¬¦¬
                        </button>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function buyWithStars(category, level, price) {
            // Map VIP shop items to product IDs
            const productIdMap = {
                'tap_boost': {0: 21, 1: 22, 2: 23, 3: 24, 4: 25},
                'energy_buy': {0: 26, 1: 27, 2: 28, 3: 29, 4: 30},
                'energy_expand': {0: 31, 1: 32, 2: 33, 3: 34, 4: 35},
                'autobot': {0: 36, 1: 37, 2: 38, 3: 39, 4: 40}
            };
            
            const productId = productIdMap[category]?.[level] || 21;
            
            // Open Telegram payment (same as in currency purchase)
            const paymentUrl = `https://t.me/qanexus_bot?start=buy_stars_${productId}`;
            window.open(paymentUrl, '_blank');
            
            // Show beautiful VIP confirmation message
            const anim = document.createElement('div');
            anim.style.cssText='position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
            anim.innerHTML='<div style="background:linear-gradient(135deg,rgba(255,215,0,0.95),rgba(255,237,78,0.95));padding:25px 50px;border-radius:25px;font-size:26px;box-shadow:0 15px 50px rgba(255,215,0,0.7);color:#000;font-weight:800;display:flex;align-items:center;gap:20px;border:3px solid rgba(255,215,0,0.8);"><span style="font-size:40px;">òíÐ</span><div><div style="font-size:28px;margin-bottom:8px;">VIP ¦ß¦-¦¦TÃ¦¬¦¦¦-</div><div style="font-size:20px;opacity:0.8;">¦ÞTÂ¦¦TÀTË¦-¦-¦¦TÂTÁTÏ ¦-¦¬¦¬¦-TÂ¦- ¦¬¦- ' + price + ' òíÐ Telegram Stars</div></div></div>';
            document.body.appendChild(anim);
            setTimeout(()=>{anim.style.opacity='0';anim.style.transform='translate(-50%,-70%)';setTimeout(()=>{anim.remove();},300);},2000);
        }
        
        // ¦äTÃ¦-¦¦TÆ¦¬TÏ ¦+¦¬TÏ TÀ¦-TÁTÇ¦¦TÂ¦- TÆ¦¦¦-TË ¦¬ ¦-¦-¦-TÃTÁ¦- ¦-¦- ¦-TÁ¦-¦-¦-¦¦ TÃTÀ¦-¦-¦-TÏ
        function calculateItemStats(basePrice, baseBonus, level, userLevel) {
            const priceMultiplier = 1 + (userLevel * 0.1); // +10% ¦¬¦- ¦¦¦-¦¦¦+TË¦¦ TÃTÀ¦-¦-¦¦¦-TÌ
            const bonusMultiplier = 1 + (userLevel * 0.05); // +5% ¦¬¦- ¦¦¦-¦¦¦+TË¦¦ TÃTÀ¦-¦-¦¦¦-TÌ
            return {
                price: Math.floor(basePrice * priceMultiplier),
                bonus: Math.floor(baseBonus * bonusMultiplier)
            };
        }
        
        // VIP ¦+¦-¦-¦-TË¦¦ ¦+¦¬TÏ ¦¦¦-¦¦¦+¦-¦¦ ¦¦¦-TÂ¦¦¦¦¦-TÀ¦¬¦¬ (¦¦¦¬¦-¦-¦-¦¬TÌ¦-TË¦¦)
        const vipData = {
            'tap_boost': {
                name: 'òíÐ VIP ¦ÚTÀ¦¬¦¬TÂ¦--¦ÑTÃTÁTÂ¦¦TÀTË',
                items: [
                    {level: 0, name: '¨ßÌà ¦×¦-¦¦¦¬¦+¦-TË¦¦ ¦èTÂ¦-TÀ¦-', desc: 'VIP ¦-TÃTÁTÂ¦¦TÀ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦¦-¦¬¦-¦¦ ¦-¦- +51 ¦¦¦-¦¬¦- ¦¬¦- TÂ¦-¦¬. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ ¦¬¦-¦¦¦¬¦+¦-TËTÅ ¦-TÁ¦¬TËTÈ¦¦¦¦ ¦+¦¬TÏ TÁ¦-¦¦TÀTÅ¦-¦-TÉ¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-.', currency: 'stars', locked: false, basePrice: 100, baseEffect: 51},
                    {level: 0, name: '¨ßÌÑ ¦ç¦¦TÀ¦-¦-TÏ ¦ÔTËTÀ¦-', desc: '¦í¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-TË¦¦ ¦-TÃTÁTÂ¦¦TÀ, ¦+¦-TÎTÉ¦¬¦¦ +71 ¦¦¦-¦¬¦- ¦¬¦- TÂ¦-¦¬. ¦ß¦-¦¦¦¬¦-TÉ¦-¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ ¦¬TÀ¦-TÁTÂTÀ¦-¦-TÁTÂ¦-¦--¦-TÀ¦¦¦-¦¦¦-¦¬ ¦+¦¬TÏ ¦-¦¦¦-¦¦TÀ¦-TÏTÂ¦-¦-¦¦ ¦¬TÀ¦-¦¬¦¬¦-¦-¦+¦¬TÂ¦¦¦¬TÌ¦-¦-TÁTÂ¦¬.', currency: 'stars', locked: false, basePrice: 200, baseEffect: 71},
                    {level: 0, name: 'òÜè ¦Ð¦-TÁ¦-¦¬TÎTÂ', desc: '¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦ VIP ¦-TÃTÁTÂ¦¦TÀ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦¦-¦¬¦-¦¦ ¦-¦- +101 ¦¦¦-¦¬¦- ¦¬¦- TÂ¦-¦¬. ¦Ð¦-TÁ¦-¦¬TÎTÂ¦-¦-TÏ ¦-¦¬¦-TÁTÂTÌ ¦-¦-¦+ ¦¦TÀ¦¬¦¬TÂ¦-¦-¦-¦¬TÎTÂ¦-TË¦-¦¬ ¦-¦¬¦¦¦-TÀ¦¬TÂ¦-¦-¦-¦¬.', currency: 'stars', locked: false, basePrice: 350, baseEffect: 101},
                    {level: 0, name: '¨ßÑÑ ¦Ø¦-¦¬¦¦TÀTÁ¦¦¦¬¦¦', desc: '¦Ø¦-¦¬¦¦TÀ¦-TÂ¦-TÀTÁ¦¦¦¬¦¦ ¦-TÃTÁTÂ¦¦TÀ, ¦+¦-TÎTÉ¦¬¦¦ +141 ¦¦¦-¦¬¦- ¦¬¦- TÂ¦-¦¬. ¦â¦¦TÅ¦-¦-¦¬¦-¦¦¦¬TÏ, ¦+¦-TÁTÂ¦-¦¦¦-¦-TÏ ¦¦TÀ¦¬¦¬TÂ¦--¦¬¦-¦¬¦¦TÀ¦-TÂ¦-TÀ¦-¦- ¦¬ ¦-¦¬¦-¦¦TÇ¦¦¦¦¦--¦¦¦-TÀ¦-¦¬¦¦¦¦.', currency: 'stars', locked: false, basePrice: 500, baseEffect: 141},
                    {level: 0, name: '¨ßÌß ¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦', desc: '¦Ü¦¬TÄ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ VIP ¦-TÃTÁTÂ¦¦TÀ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦¦-¦¬¦-¦¦ ¦-¦- +201 ¦¦¦-¦¬¦- ¦¬¦- TÂ¦-¦¬. ¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-¦-TÏ TÂ¦¦TÅ¦-¦-¦¬¦-¦¦¦¬TÏ ¦¬¦¬ ¦+TÀ¦¦¦-¦-¦¬TÅ ¦¦TÀ¦¬¦¬TÂ¦--TÆ¦¬¦-¦¬¦¬¦¬¦¬¦-TÆ¦¬¦¦.', currency: 'stars', locked: false, basePrice: 750, baseEffect: 201}
                ]
            },
            'energy_buy': {
                name: 'òíÐ VIP ¦í¦-¦¦TÀ¦¦¦--¦Ó¦¦¦-¦¦TÀ¦-TÂ¦-TÀTË',
                items: [
                    {level: 0, name: 'òØÀÿ¬Ï ¦á¦-¦¬¦-¦¦TÇ¦-¦-TÏ ¦Ú¦-TÀ¦-¦-¦-', desc: 'VIP ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ, ¦-¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¬¦-¦-TÎTÉ¦¬¦¦ +3.0 TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦- TÁ¦¦¦¦TÃ¦-¦+TÃ. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ TÁ¦-¦¬¦-¦¦TÇ¦-¦-¦¦ ¦¦¦-TÀ¦-¦-TË ¦+¦¬TÏ TÁ¦-¦¦TÀTÅ¦-TËTÁTÂTÀ¦-¦¦ ¦¬¦-¦+¦¬¦-TÀTÏ¦+¦¦¦¬.', currency: 'stars', locked: false, basePrice: 120, baseEffect: 3.0},
                    {level: 0, name: '¨ßÌÌ ¦Ó¦-¦¬¦-¦¦TÂ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦ï¦+TÀ¦-', desc: '¦í¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ, ¦+¦-TÎTÉ¦¬¦¦ +4.5 TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦- TÁ¦¦¦¦TÃ¦-¦+TÃ. ¦Ø¦¬¦-¦¬¦¦¦¦¦-¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ ¦¬¦¬ TÏ¦+TÀ¦- ¦¦¦-¦¬¦-¦¦TÂ¦¬¦¦¦¬ TÇ¦¦TÀ¦¦¦¬ ¦¦¦-¦-¦-TÂ¦-¦-TË¦¦ TÂTÃ¦-¦-¦¦¦¬¦¬.', currency: 'stars', locked: false, basePrice: 200, baseEffect: 4.5},
                    {level: 0, name: '¨ßÒë ¦Ý¦-¦-¦-TÏ ¦ÕTÀ¦-', desc: '¦à¦¦¦-¦-¦¬TÎTÆ¦¬¦-¦-¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ, ¦-¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¬¦-¦-TÎTÉ¦¬¦¦ +6.0 TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦- TÁ¦¦¦¦TÃ¦-¦+TÃ. ¦â¦¦TÅ¦-¦-¦¬¦-¦¦¦¬TÏ ¦-¦-¦-¦-¦¦ TÍTÀTË ¦¦TÀ¦¬¦¬TÂ¦-¦-¦-¦¬TÎTÂ¦-¦-¦¦¦- ¦-TÃ¦+TÃTÉ¦¦¦¦¦-.', currency: 'stars', locked: false, basePrice: 300, baseEffect: 6.0},
                    {level: 0, name: 'òÚÛÿ¬Ï ¦Ú¦-¦-¦-TÂ¦-¦-TË¦¦ ¦à¦¦¦-¦¦TÂ¦-TÀ', desc: '¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ, ¦+¦-TÎTÉ¦¬¦¦ +8.0 TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦- TÁ¦¦¦¦TÃ¦-¦+TÃ. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ ¦¦¦-¦-¦-TÂ¦-¦-TË¦¦ TÄ¦¬TÃ¦¦TÂTÃ¦-TÆ¦¬¦¬ ¦+¦¬TÏ ¦-¦¦¦-¦¦TÀ¦-¦-¦¬TÇ¦¦¦-¦-¦-¦¦ TÍ¦-¦¦TÀ¦¦¦¬¦¬.', currency: 'stars', locked: false, basePrice: 450, baseEffect: 8.0},
                    {level: 0, name: '¨ßÌà ¦Ý¦¦¦-¦¦TÁ¦-TË¦¦ ¦ß¦-TÀTÂ¦-¦¬', desc: '¦Ü¦¬TÄ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ, ¦-¦-TÁTÁTÂ¦-¦-¦-¦-¦¬¦¬¦-¦-TÎTÉ¦¬¦¦ +10.0 TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦- TÁ¦¦¦¦TÃ¦-¦+TÃ. ¦ß¦-¦+¦¦¦¬TÎTÇ¦-¦¦TÂTÁTÏ ¦¦ TÍ¦-¦¦TÀ¦¦¦¦TÂ¦¬TÇ¦¦TÁ¦¦¦¬¦- ¦¬¦-TÀTÂ¦-¦¬¦-¦- ¦-¦¦¦-¦¦TÁ¦-TËTÅ TÁTÄ¦¦TÀ.', currency: 'stars', locked: false, basePrice: 600, baseEffect: 10.0}
                ]
            },
            'energy_expand': {
                name: 'òíÐ VIP ¦í¦-¦¦TÀ¦¦¦--¦Ñ¦-TÂ¦-TÀ¦¦¦¬',
                items: [
                    {level: 0, name: '¨ßÌÌ ¦Ó¦-¦¬¦-¦¦TÂ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦à¦¦¦¬¦¦TÀ¦-TÃ¦-TÀ', desc: 'VIP ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦TÁ¦¬¦-TÃ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦-¦- +7500. ¦åTÀ¦-¦-¦¬TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ TÆ¦¦¦¬¦-¦¦ ¦¦¦-¦¬¦-¦¦TÂ¦¬¦¦¦¬ ¦- ¦¦¦-¦-¦¬¦-¦¦TÂ¦-¦-¦- ¦¦TÀ¦¬TÁTÂ¦-¦¬¦¬¦¦.', currency: 'stars', locked: false, basePrice: 150, baseEffect: 7500},
                    {level: 0, name: 'òÚÛÿ¬Ï ¦Ú¦-¦-¦-TÂ¦-¦-¦-TÏ ¦áTÃ¦¬¦¦TÀ¦¬¦-¦¬¦¬TÆ¦¬TÏ', desc: '¦í¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÀ¦-TÁTÈ¦¬TÀTÏTÎTÉ¦¬¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌ ¦-¦- +12500. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ ¦¦¦-¦-¦-TÂ¦-¦-TÃTÎ TÁTÃ¦¬¦¦TÀ¦¬¦-¦¬¦¬TÆ¦¬TÎ ¦+¦¬TÏ ¦-¦¦TÁ¦¦¦-¦-¦¦TÇ¦-¦-¦¦¦- TÅTÀ¦-¦-¦¦¦-¦¬TÏ.', currency: 'stars', locked: false, basePrice: 250, baseEffect: 12500},
                    {level: 0, name: '¨ßÌà ¦×¦-¦¦¦¬¦+¦-¦-¦¦ ¦á¦-¦¬¦-¦¦¦¬¦+¦¬¦¦', desc: '¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦TÁ¦¬¦-TÃ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦-¦- +20000. ¦á¦-¦+¦¦TÀ¦¦¦¬TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ TÆ¦¦¦¬¦-¦¦¦- ¦¬¦-¦¦¦¬¦+¦-¦-¦¦¦- TÁ¦-¦¬¦-¦¦¦¬¦+¦¬TÏ.', currency: 'stars', locked: false, basePrice: 400, baseEffect: 20000},
                    {level: 0, name: '¨ßÌÑ ¦Ð¦-TÁ¦-¦¬TÎTÂ¦-¦-TÏ ¦ßTÃTÁTÂ¦-TÂ¦-', desc: '¦Ü¦¬TÄ¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÀ¦-TÁTÈ¦¬TÀTÏTÎTÉ¦¬¦¦ TÍ¦-¦¦TÀ¦¦¦-¦¦¦-¦¦¦-TÁTÂTÌ ¦-¦- +37500. ¦ØTÁ¦¬¦-¦¬TÌ¦¬TÃ¦¦TÂ TÍ¦-¦¦TÀ¦¦¦¬TÎ ¦¦¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦-¦¦ ¦¬TÃTÁTÂ¦-TÂTË ¦+¦¬TÏ TÅTÀ¦-¦-¦¦¦-¦¬TÏ.', currency: 'stars', locked: false, basePrice: 600, baseEffect: 37500},
                    {level: 0, name: '¨ßÑÑ ¦Ø¦-¦¬¦¦TÀTÁ¦¦¦-TÏ ¦á¦-¦¦TÀ¦-¦-¦¬TÉ¦-¦¬TÆ¦-', desc: '¦Ñ¦-¦¦¦¦TÁTÂ¦-¦¦¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦¬TÂ¦¦¦¬TÌ, TÃ¦-¦¦¦¬¦¬TÇ¦¬¦-¦-TÎTÉ¦¬¦¦ ¦-¦-¦¦TÁ¦¬¦-TÃ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦-¦- +75000. ¦á¦-¦¦TÀ¦-¦-¦¬TÉ¦-¦¬TÆ¦- ¦¦TÀ¦¬¦¬TÂ¦--¦¬¦-¦¬¦¦TÀ¦-TÂ¦-TÀ¦-¦- TÁ ¦-¦¦¦-¦¦TÀ¦-¦-¦¬TÇ¦¦¦-¦-¦-¦¦ ¦¦¦-¦¦¦-TÁTÂTÌTÎ.', currency: 'stars', locked: false, basePrice: 800, baseEffect: 75000}
                ]
            },
            'autobot': {
                name: 'òíÐ VIP ¦ÚTÀ¦¬¦¬TÂ¦--¦Ñ¦-TÂTË',
                items: [
                    {level: 0, name: 'òíÐ VIP ¦Ñ¦-¦¬¦-¦-TË¦¦ ¦Ñ¦-TÂ', desc: 'VIP ¦-¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 5 ¦+¦-¦¦¦¦', speed: 6, duration: 7200, currency: 'stars', locked: false, basePrice: 100},
                    {level: 0, name: 'òíÐ VIP ¦ã¦¬TÃTÇTÈ¦¦¦-¦-TË¦¦ ¦Ñ¦-TÂ', desc: 'VIP ¦-¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 7 ¦+¦-¦¦¦¦', speed: 6.5, duration: 10080, currency: 'stars', locked: false, basePrice: 200},
                    {level: 0, name: 'òíÐ VIP ¦ßTÀ¦-¦+¦-¦¬¦-TÃTÂTË¦¦ ¦Ñ¦-TÂ', desc: 'VIP ¦-¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 10 ¦+¦-¦¦¦¦', speed: 7, duration: 14400, currency: 'stars', locked: false, basePrice: 350},
                    {level: 0, name: 'òíÐ VIP ¦í¦¬¦¬TÂ¦-TË¦¦ ¦Ñ¦-TÂ', desc: 'VIP ¦-¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 14 ¦+¦-¦¦¦¦', speed: 7.5, duration: 20160, currency: 'stars', locked: false, basePrice: 500},
                    {level: 0, name: 'òíÐ VIP ¦ßTÀ¦¦¦-¦¬TÃ¦- ¦Ñ¦-TÂ', desc: 'VIP ¦-¦-TÂ¦-TÂ¦-¦¬ ¦-¦- 20 ¦+¦-¦¦¦¦', speed: 8, duration: 28800, currency: 'stars', locked: false, basePrice: 750}
                ]
            }
        };
        function loadShopCategory(category) {
            // Update button states
            document.querySelectorAll('.shop-cat-btn').forEach(btn => {
                const btnCategory = btn.getAttribute('data-category');
                if(btnCategory === category) {
                    btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                    btn.style.border = 'none';
                } else {
                    btn.style.background = 'rgba(255,255,255,0.1)';
                    btn.style.border = '1px solid rgba(255,255,255,0.3)';
                }
            });
            
            const items = window.shopData[category].items;
            const list = document.getElementById('shopItemsList');
            
            // Get user's current level for this category from userData
            let userLevel = 0;
            if (window.userData) {
                if (category === 'tap_boost' || category === 'tap_boost_vip') {
                    userLevel = window.userData.tap_boost_level || 0;
                } else if (category === 'energy_buy' || category === 'energy_buy_vip') {
                    userLevel = window.userData.energy_buy_level || 0;
                } else if (category === 'energy_expand' || category === 'energy_expand_vip') {
                    userLevel = window.userData.energy_expand_level || 0;
            }
            }
            
            // Calculate price and effect for each item based on its current level
            list.innerHTML = items.map((item, index) => {
                const isLocked = false; // Remove locking - all items are available
                
                // Get current level from shopData (updated after purchase)
                const currentLevel = window.shopData && window.shopData[category] && window.shopData[category].items && window.shopData[category].items[index] 
                    ? window.shopData[category].items[index].level 
                    : item.level;
                
                // Calculate current effect and next level price based on current level
                let currentEffect = 0;
                let nextLevelPrice = 0;
                let nextLevelEffect = 0;
                
                if (category === 'tap_boost' || category === 'tap_boost_vip') {
                    const baseEffect = item.baseEffect || 1;
                    const basePrice = item.basePrice || 1000;
                    // Show total tap boosts - active_multiplier is already the number of clicks
                    const userMultiplier = window.userData?.active_multiplier || 1;
                    console.log('Tap boost - userMultiplier:', userMultiplier, 'window.userData:', window.userData);
                    const totalBoost = userMultiplier;
                    nextLevelPrice = Math.floor(basePrice * Math.pow(1.5, currentLevel + 1));
                    
                    // Special handling for first item (base_effect == 1): always gives +1
                    if (baseEffect === 1) {
                        nextLevelEffect = 1;
                        // For first item, show total since it's the base
                        currentEffect = totalBoost;
                    } else {
                        // For other items: use same logic as backend
                        // Backend formula: 
                        //   current_effect = base_effect * (1.2 ** (level - 1)) if level > 1 else 0
                        //   new_effect = base_effect * (1.2 ** level)
                        //   bonus = new_effect - current_effect
                        // When buying, we're at level=currentLevel, buying level=currentLevel+1
                        // So calculate the bonus that will be added when purchasing next level
                        // Backend formula: level is the next level we're buying
                        // So at currentLevel, we're buying level=currentLevel+1
                        // Backend calculates: current_effect = base_effect * (1.2 ** (level - 1))
                        // So for level=currentLevel+1: current_effect = base_effect * (1.2 ** currentLevel)
                        const currentItemEffect = currentLevel >= 1 ? Math.floor(baseEffect * Math.pow(1.2, currentLevel)) : 0;
                        // new_effect = base_effect * (1.2 ** level) = base_effect * (1.2 ** (currentLevel + 1))
                        const newEffect = Math.floor(baseEffect * Math.pow(1.2, currentLevel + 1));
                        nextLevelEffect = newEffect - currentItemEffect;
                        // Show what total would be AFTER buying this item
                        // Total would be current total + nextLevelEffect
                        currentEffect = totalBoost;
                    }
                } else if (category === 'energy_buy' || category === 'energy_buy_vip') {
                    const baseEffect = item.baseEffect || 0.5;
                    const basePrice = item.basePrice || 1500;
                    // Show total energy regen (energy_regen_rate includes base 1)
                    const userRegenRate = window.userData?.energy_regen_rate || 1;
                    console.log('Energy buy - userRegenRate:', userRegenRate, 'window.userData:', window.userData);
                    const totalRegen = Math.max(0, Math.round((userRegenRate - 1) * 10) / 10);
                    nextLevelPrice = Math.floor(basePrice * Math.pow(1.4, currentLevel + 1));
                    // Backend formula: level is the next level we're buying
                    // So at currentLevel, we're buying level=currentLevel+1
                    // Backend calculates: current_effect = base_effect * (1.15 ** (level - 1))
                    // So for level=currentLevel+1: current_effect = base_effect * (1.15 ** currentLevel)
                    const currentItemEffect = currentLevel >= 1 ? Math.round(baseEffect * Math.pow(1.15, currentLevel) * 10) / 10 : 0;
                    // new_effect = base_effect * (1.15 ** level) = base_effect * (1.15 ** (currentLevel + 1))
                    const nextItemEffect = Math.round(baseEffect * Math.pow(1.15, currentLevel + 1) * 10) / 10;
                    // Show the increment (difference)
                    nextLevelEffect = Math.round((nextItemEffect - currentItemEffect) * 10) / 10;
                    currentEffect = totalRegen;
                } else if (category === 'energy_expand' || category === 'energy_expand_vip') {
                    const baseEffect = item.baseEffect || 50;
                    const basePrice = item.basePrice || 2000;
                    // Show total energy expansion (max_energy includes base 1000)
                    const userMaxEnergy = window.userData?.max_energy || 1000;
                    console.log('Energy expand - userMaxEnergy:', userMaxEnergy, 'window.userData:', window.userData);
                    const totalExpansion = Math.max(0, userMaxEnergy - 1000);
                    nextLevelPrice = Math.floor(basePrice * Math.pow(1.6, currentLevel + 1));
                    // Backend formula: level is the next level we're buying
                    // So at currentLevel, we're buying level=currentLevel+1
                    // Backend calculates: current_effect = base_effect * (1.25 ** (level - 1))
                    // So for level=currentLevel+1: current_effect = base_effect * (1.25 ** currentLevel)
                    const currentItemEffect = currentLevel >= 1 ? Math.floor(baseEffect * Math.pow(1.25, currentLevel)) : 0;
                    // new_effect = base_effect * (1.25 ** level) = base_effect * (1.25 ** (currentLevel + 1))
                    const nextItemEffect = Math.floor(baseEffect * Math.pow(1.25, currentLevel + 1));
                    // Show the increment (difference)
                    nextLevelEffect = nextItemEffect - currentItemEffect;
                    currentEffect = totalExpansion;
                }
                
                const rarityColors = {
                    0: 'rgba(148,163,184,0.3)', // gray
                    5: 'rgba(59,130,246,0.3)', // blue
                    10: 'rgba(139,92,246,0.3)', // purple
                    15: 'rgba(236,72,153,0.3)', // pink
                    20: 'rgba(251,191,36,0.3)', // gold
                    25: 'rgba(34,197,94,0.3)', // green
                    30: 'rgba(239,68,68,0.3)', // red
                    35: 'rgba(168,85,247,0.3)', // violet
                    40: 'rgba(245,158,11,0.3)', // amber
                    45: 'rgba(6,182,212,0.3)', // cyan
                    50: 'rgba(255,215,0,0.3)' // gold
                };
                const rarityColor = item.level <= 5 ? rarityColors[0] : 
                                   item.level <= 10 ? rarityColors[5] : 
                                   item.level <= 15 ? rarityColors[10] : 
                                   item.level <= 20 ? rarityColors[15] : 
                                   item.level <= 25 ? rarityColors[20] :
                                   item.level <= 30 ? rarityColors[25] :
                                   item.level <= 35 ? rarityColors[30] :
                                   item.level <= 40 ? rarityColors[35] :
                                   item.level <= 45 ? rarityColors[40] :
                                   item.level <= 50 ? rarityColors[45] : rarityColors[50];
                
                // Use calculated price and bonus for next level
                
                return `
                    <div style="background:${isLocked ? 'rgba(0,0,0,0.5)' : item.premium ? 'linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,237,78,0.15))' : rarityColor};padding:14px;border-radius:14px;border:2px solid ${isLocked ? 'rgba(239,68,68,0.5)' : item.premium ? 'rgba(255,215,0,0.6)' : 'rgba(102,126,234,0.4)'};position:relative;${isLocked ? 'opacity:0.6;' : ''}">
                        ${isLocked ? `
                            <div style="position:absolute;top:8px;right:8px;background:rgba(239,68,68,0.8);color:#fff;padding:4px 8px;border-radius:6px;font-size:10px;font-weight:700;">¨ßÔÒ</div>
                        ` : item.premium ? `
                            <div style="position:absolute;top:8px;right:8px;background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;padding:4px 8px;border-radius:6px;font-size:10px;font-weight:700;box-shadow:0 2px 8px rgba(255,215,0,0.4);">òíÐ VIP</div>
                        ` : ''}
                        <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                            <span style="font-size:20px;">${item.name.split(' ')[0]}</span>
                            <div style="flex:1;">
                                <div style="display:flex;align-items:center;gap:8px;margin-bottom:2px;">
                                    <div style="font-weight:800;font-size:14px;color:#fff;">${item.name.split(' ').slice(1).join(' ')} #${index + 1}</div>
                                    <div style="background:linear-gradient(135deg,rgba(102,126,234,0.8),rgba(139,92,246,0.8));color:#fff;padding:2px 6px;border-radius:6px;font-size:10px;font-weight:700;box-shadow:0 2px 4px rgba(102,126,234,0.3);">¦ãTÀ.${currentLevel}</div>
                                </div>
                                <div style="font-size:11px;color:#94a3b8;">${item.desc}</div>
                            </div>
                        </div>
                        ${category === 'tap_boost' ? `
                            <div style="background:rgba(102,126,234,0.2);padding:8px;border-radius:8px;margin-bottom:8px;">
                                <div style="display:flex;justify-content:space-between;align-items:center;">
                                    <span style="color:#a78bfa;font-size:12px;font-weight:700;">¨ßÒê ¦Ú¦¬¦¬¦¦¦-¦- ¦¬¦- TÂ¦-¦¬:</span>
                                    <span style="color:#fff;font-size:13px;font-weight:800;">${currentEffect}</span>
                                </div>
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:4px;">
                                    <span style="color:#a78bfa;font-size:12px;font-weight:700;">¨ßÒê ¦ßTÀ¦¬TÀ¦-TÁTÂ:</span>
                                    <span style="color:#4ade80;font-size:13px;font-weight:800;">+${nextLevelEffect} ¦¦¦¬¦¬¦¦¦-¦-</span>
                                </div>
                            </div>
                        ` : category === 'energy_buy' ? `
                            <div style="background:rgba(251,191,36,0.2);padding:8px;border-radius:8px;margin-bottom:8px;">
                                <div style="display:flex;justify-content:space-between;align-items:center;">
                                    <span style="color:#fbbf24;font-size:12px;font-weight:700;">òÚá ¦Ô¦-¦-¦-¦-¦¬TÂTÌ TÍ¦-¦¦TÀ¦¦¦¬¦¬/TÁ¦¦¦¦:</span>
                                    <span style="color:#fff;font-size:13px;font-weight:800;">${currentEffect}</span>
                                </div>
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:4px;">
                                    <span style="color:#fbbf24;font-size:12px;font-weight:700;">òÚá ¦ßTÀ¦¬TÀ¦-TÁTÂ:</span>
                                    <span style="color:#4ade80;font-size:13px;font-weight:800;">+${nextLevelEffect} TÍ¦-¦¦TÀ¦¦¦¬¦¬/TÁ¦¦¦¦</span>
                                </div>
                            </div>
                        ` : category === 'energy_expand' ? `
                            <div style="background:rgba(236,72,153,0.2);padding:8px;border-radius:8px;margin-bottom:8px;">
                                <div style="display:flex;justify-content:space-between;align-items:center;">
                                    <span style="color:#ec4899;font-size:12px;font-weight:700;">¨ßÓÈ ¦à¦-TÁTÈ¦¬TÀ¦¬TÂTÌ ¦-¦-¦¦TÁ¦¬¦-TÃ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬ ¦-¦-:</span>
                                    <span style="color:#fff;font-size:13px;font-weight:800;">${currentEffect > 0 ? currentEffect.toLocaleString() : '0'}</span>
                                </div>
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:4px;">
                                    <span style="color:#ec4899;font-size:12px;font-weight:700;">¨ßÓÈ ¦ßTÀ¦¬TÀ¦-TÁTÂ:</span>
                                    <span style="color:#4ade80;font-size:13px;font-weight:800;">+${nextLevelEffect.toLocaleString()}</span>
                                </div>
                            </div>
                        ` : `
                            <div style="background:rgba(16,185,129,0.2);padding:8px;border-radius:8px;margin-bottom:8px;">
                                <div style="display:flex;justify-content:space-between;align-items:center;">
                                    <span style="color:#10b981;font-size:12px;font-weight:700;">òÏ-ÿ¬Ï ¦Ô¦¬¦¬TÂ¦¦¦¬TÌ¦-¦-TÁTÂTÌ:</span>
                                    <span style="color:#fff;font-size:12px;font-weight:800;">${item.duration < 60 ? item.duration + ' ¦-¦¬¦-TÃTÂ' : Math.floor(item.duration / 60) + ' TÇ¦-TÁ¦-¦-'}</span>
                                </div>
                                ${item.speed > 1 ? `
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:4px;">
                                    <span style="color:#10b981;font-size:12px;font-weight:700;">òÚá ¦á¦¦¦-TÀ¦-TÁTÂTÌ:</span>
                                    <span style="color:#4ade80;font-size:12px;font-weight:800;">${item.speed} TÂ¦-¦¬¦-¦-/TÁ¦¦¦¦</span>
                                </div>
                                ` : ''}
                            </div>
                        `}
                        ${category === 'autobot' || category === 'autobot_vip' ? `
                            <button id="autobot-btn-${item.level}" onclick="${isLocked ? 'tg.showAlert(\'¨ßÔÒ ¦á¦-¦-TÇ¦-¦¬¦- ¦¦TÃ¦¬¦¬TÂ¦¦ ¦¬TÀ¦¦¦+TË¦+TÃTÉ¦¬¦¦ TÃTÀ¦-¦-¦¦¦-TÌ\')' : item.currency === 'stars' ? `buyWithStars('${category}', ${item.level}, ${item.basePrice || item.price})` : `buyShopItem('${category}', ${item.level}, ${item.price})`}" 
                                    style="width:100%;padding:8px 12px;background:${isLocked ? 'rgba(239,68,68,0.6)' : item.currency === 'stars' ? 'linear-gradient(135deg,#ffd700,#ffed4e,#ffd700)' : 'linear-gradient(135deg,#667eea,#764ba2)'};color:${item.currency === 'stars' ? '#000' : '#fff'};border:${item.currency === 'stars' ? '1px solid #ffd700' : 'none'};border-radius:10px;cursor:${isLocked ? 'not-allowed' : 'pointer'};font-weight:700;font-size:12px;transition:all 0.3s;position:relative;overflow:hidden;box-shadow:${item.currency === 'stars' ? '0 3px 10px rgba(255,215,0,0.3)' : '0 2px 6px rgba(102,126,234,0.3)'};display:flex;align-items:center;justify-content:center;gap:4px;"
                                    onmousedown="if(!${isLocked}){this.style.transform='scale(0.98)';this.style.boxShadow='${item.currency === 'stars' ? '0 4px 12px rgba(255,215,0,0.4)' : '0 3px 8px rgba(102,126,234,0.4)'}'}"
                                    onmouseup="if(!${isLocked}){this.style.transform='scale(1)';this.style.boxShadow='${item.currency === 'stars' ? '0 3px 10px rgba(255,215,0,0.3)' : '0 2px 6px rgba(102,126,234,0.3)'}'}"
                                    onmouseleave="if(!${isLocked}){this.style.transform='scale(1)';this.style.boxShadow='${item.currency === 'stars' ? '0 3px 10px rgba(255,215,0,0.3)' : '0 2px 6px rgba(102,126,234,0.3)'}'}">
                                ${isLocked ? '¨ßÔÒ ¦×¦-¦-¦¬¦-¦¦¦¬TÀ¦-¦-¦-¦-¦-' : item.currency === 'stars' ? `<span>¦ÚTÃ¦¬¦¬TÂTÌ ¦¬¦- ${item.basePrice || item.price}</span><span style="font-size:14px;">òíÐ</span><span>Stars</span>` : `<span>¦ÚTÃ¦¬¦¬TÂTÌ ¦¬¦- ${item.price.toLocaleString()}</span><span style="font-size:14px;">¨ßêÙ</span>`}
                            </button>
                        ` : `
                            <button onclick="${isLocked ? 'tg.showAlert(\'¨ßÔÒ ¦á¦-¦-TÇ¦-¦¬¦- ¦¦TÃ¦¬¦¬TÂ¦¦ ¦¬TÀ¦¦¦+TË¦+TÃTÉ¦¬¦¦ TÃTÀ¦-¦-¦¦¦-TÌ\')' : item.currency === 'stars' ? `buyWithStars('${category}', ${currentLevel}, ${item.basePrice || item.price})` : `buyShopItem('${category}', ${currentLevel}, ${nextLevelPrice}, ${index})`}" 
                                    style="width:100%;padding:8px 12px;background:${isLocked ? 'rgba(239,68,68,0.6)' : item.currency === 'stars' ? 'linear-gradient(135deg,#ffd700,#ffed4e,#ffd700)' : 'linear-gradient(135deg,#667eea,#764ba2)'};color:${item.currency === 'stars' ? '#000' : '#fff'};border:${item.currency === 'stars' ? '1px solid #ffd700' : 'none'};border-radius:10px;cursor:${isLocked ? 'not-allowed' : 'pointer'};font-weight:700;font-size:12px;transition:all 0.3s;position:relative;overflow:hidden;box-shadow:${item.currency === 'stars' ? '0 3px 10px rgba(255,215,0,0.3)' : '0 2px 6px rgba(102,126,234,0.3)'};display:flex;align-items:center;justify-content:center;gap:4px;"
                                    onmousedown="if(!${isLocked}){this.style.transform='scale(0.98)';this.style.boxShadow='${item.currency === 'stars' ? '0 4px 12px rgba(255,215,0,0.4)' : '0 3px 8px rgba(102,126,234,0.4)'}'}"
                                    onmouseup="if(!${isLocked}){this.style.transform='scale(1)';this.style.boxShadow='${item.currency === 'stars' ? '0 3px 10px rgba(255,215,0,0.3)' : '0 2px 6px rgba(102,126,234,0.3)'}'}"
                                    onmouseleave="if(!${isLocked}){this.style.transform='scale(1)';this.style.boxShadow='${item.currency === 'stars' ? '0 3px 10px rgba(255,215,0,0.3)' : '0 2px 6px rgba(102,126,234,0.3)'}'}">
                                ${isLocked ? '¨ßÔÒ ¦×¦-¦-¦¬¦-¦¦¦¬TÀ¦-¦-¦-¦-¦-' : item.currency === 'stars' ? `<span>¦ÚTÃ¦¬¦¬TÂTÌ ¦¬¦- ${item.basePrice || item.price}</span><span style="font-size:14px;">òíÐ</span><span>Stars</span>` : `<span>¦ÚTÃ¦¬¦¬TÂTÌ ¦¬¦- ${nextLevelPrice.toLocaleString()}</span><span style="font-size:14px;">¨ßêÙ</span>`}
                            </button>
                        `}
                    </div>
                `;
            }).join('');
            
            // Update VIP button for current category
            const vipButton = document.getElementById('vipButton');
            if (vipButton) {
                vipButton.setAttribute('onclick', `openVIPModal('${category}')`);
            }
            
            // Update autobot buttons if autobot category is loaded
            if (category === 'autobot' || category === 'autobot_vip') {
                // Fetch current user data to update autobot buttons
                fetch('/api/user_data', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: window.user?.id})
                })
                .then(res => res.json())
                .then(data => {
                    updateAutobotShopButtons(data);
                })
                .catch(err => console.error('Error loading user data for autobots:', err));
            }
        }
        
        function loadShopLevels() {
            const userId = window.userData?.id || window.user?.id;
            if (!userId) return;
            
            fetch('/api/get_shop_levels', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: userId})
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    // Update shopData with levels from database
                    if (window.shopData) {
                        // Update tap_boost levels
                        Object.keys(data.tap_boost_levels).forEach(index => {
                            if (window.shopData.tap_boost && window.shopData.tap_boost.items[index]) {
                                window.shopData.tap_boost.items[index].level = data.tap_boost_levels[index];
                            }
                        });
                        
                        // Update energy_buy levels
                        Object.keys(data.energy_buy_levels).forEach(index => {
                            if (window.shopData.energy_buy && window.shopData.energy_buy.items[index]) {
                                window.shopData.energy_buy.items[index].level = data.energy_buy_levels[index];
                            }
                        });
                        
                        // Update energy_expand levels
                        Object.keys(data.energy_expand_levels).forEach(index => {
                            if (window.shopData.energy_expand && window.shopData.energy_expand.items[index]) {
                                window.shopData.energy_expand.items[index].level = data.energy_expand_levels[index];
                            }
                        });
                        
                        // Refresh current shop category if it's open
                        const activeBtn = document.querySelector('.shop-cat-btn[style*="linear-gradient"]');
                        if (activeBtn && activeBtn.dataset.category) {
                            loadShopCategory(activeBtn.dataset.category);
                        }
                    }
                }
            })
            .catch(err => console.error('Error loading shop levels:', err));
        }
        
        function showNotification(type, message) {
            const anim = document.createElement('div');
            anim.style.cssText = 'position:fixed;top:15%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
            const bgColor = type === 'error' ? 'rgba(239,68,68,0.95),rgba(220,38,38,0.95)' : 'rgba(34,197,94,0.95),rgba(16,185,129,0.95)';
            const icon = type === 'error' ? '¨ßÒ-' : 'òÜè';
            anim.innerHTML = `<div style="background:linear-gradient(135deg,${bgColor});padding:8px 16px;border-radius:20px;font-size:14px;box-shadow:0 4px 15px rgba(16,185,129,0.5);color:#fff;font-weight:700;display:flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,0.2);"><span style="font-size:16px;">${icon}</span> ${message}</div>`;
            document.body.appendChild(anim);
            setTimeout(() => {
                anim.style.opacity = '0';
                anim.style.transform = 'translate(-50%,-60%)';
                setTimeout(() => anim.remove(), 300);
            }, 1500);
        }
        
        function buyShopItem(category, level, price, itemIndex) {
            // Use direct price from the item (calculated by formulas)
            const actualPrice = price;
            const userId = window.userData?.id || window.user?.id;
            
            if (!userId) {
                showNotification('error', '¦ÞTÈ¦¬¦-¦¦¦-: ¦¬¦-¦¬TÌ¦¬¦-¦-¦-TÂ¦¦¦¬TÌ ¦-¦¦ ¦-¦-¦¦¦+¦¦¦-');
                return;
            }
            
            // Play sound for shop purchase based on category
            const soundEnabled = localStorage.getItem('soundEnabled') === 'true';
            if (soundEnabled) {
                if (category === 'card') {
                    playSound('card');
                } else if (category === 'tap_boost' || category === 'energy_buy' || category === 'energy_expand' || category === 'autobot') {
                    playSound('purchase');
                }
            }
            
            // Haptic feedback
            const hapticsEnabled = localStorage.getItem('hapticsEnabled') === 'true';
            if (hapticsEnabled && tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('light');
            }
            
            // Special handling for cards - use /api/buy endpoint
            if (category === 'card') {
                // Get card data from shopData to find the correct item_type
                if (!window.shopData || !window.shopData.items) {
                    console.error('Shop data not loaded! Loading cards data...');
                    // Force reload cards data
                    fetch('/api/shop', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({user_id: userId, category: 'cards'})
                    })
                    .then(res => res.json())
                    .then(shopData => {
                        window.shopData = window.shopData || {};
                        window.shopData.items = shopData.items || [];
                        console.log('Reloaded shop data:', window.shopData);
                        // Retry the purchase with a small delay to avoid recursion issues
                        setTimeout(() => {
                            buyShopItem(category, level, price, itemIndex);
                        }, 100);
                    })
                    .catch(err => {
                        console.error('Error loading shop data:', err);
                        showNotification('error', '¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÀTÃ¦¬¦¦¦¬ ¦+¦-¦-¦-TËTÅ ¦-¦-¦¦¦-¦¬¦¬¦-¦-');
                    });
                    return;
                }
                
                const shopData = window.shopData || {};
                const cards = shopData.items || [];
                
                console.log('Shop data for cards:', shopData);
                console.log('Cards array:', cards);
                console.log('Item index or id:', itemIndex);
                console.log('Actual price:', actualPrice);
                console.log('Cards length:', cards.length);
                console.log('Item index valid:', itemIndex >= 0 && itemIndex < cards.length);
                
                // If itemIndex is a string, it's actually the card id -> use directly
                let itemType = (typeof itemIndex === 'string') ? itemIndex : null;
                let card = null;
                if (!itemType) {
                    card = cards[itemIndex];
                    if (!card) {
                        console.error('Card not found at index:', itemIndex, 'cards length:', cards.length);
                        showNotification('error', '¦Ú¦-TÀTÂ¦-TÇ¦¦¦- ¦-¦¦ ¦-¦-¦¦¦+¦¦¦-¦-');
                        return;
                    }
                    itemType = card.id;
                } else {
                    card = cards.find(c => c.id === itemType) || null;
                }
                
                console.log('Buying card:', {card, itemType, actualPrice, cards: cards.length});
                console.log('Card ID for purchase:', itemType);
                console.log('Item type being sent:', itemType);
                
                fetch('/api/buy', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                        user_id: userId,
                        item_type: itemType,
                    price: actualPrice
                })
            })
            .then(res => res.json())
            .then(data => {
                    console.log('Card purchase response:', data);
                    console.log('Response success:', data.success);
                    console.log('Response error:', data.error);
                if(data.success) {
                        // Success sound and haptics
                        if (soundEnabled) playSound('success');
                        if (hapticsEnabled && tg?.HapticFeedback) {
                            tg.HapticFeedback.notificationOccurred('success');
                        }
                        
                        showNotification('success', '¦Ú¦-TÀTÂ¦-TÇ¦¦¦- ¦¦TÃ¦¬¦¬¦¦¦-¦-!');
                    
                        // Reload cards data to update levels and prices
                        fetch('/api/shop', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({user_id: userId, category: 'cards'})
                        })
                        .then(res => res.json())
                        .then(shopData => {
                            console.log('Reloaded cards data after purchase:', shopData);
                            console.log('Cards items:', shopData.items);
                            window.shopData = window.shopData || {};
                            window.shopData.items = shopData.items || [];
                            
                            // Refresh cards display - force reload all cards
                            console.log('Refreshing all cards after purchase');
                            
                            // Find the currently active category and refresh it
                            const activeBtn = document.querySelector('#cardsShopSection .shop-cat-btn[style*="linear-gradient"]');
                            const activeCategory = activeBtn && activeBtn.dataset.category ? activeBtn.dataset.category : 'per_hour';
                            console.log('Active category:', activeCategory);
                            
                            // Log per_hour cards specifically
                            const perHourCards = shopData.items.filter(item => item.type === 'card' && item.income_type === 'per_hour');
                            console.log('Per hour cards after purchase:', perHourCards.map(c => ({
                                id: c.id,
                                level: c.level,
                                price: c.price,
                                income_per_min: c.income_per_min
                            })));
                            
                            // Force refresh the active category
                            loadCardsCategory(activeCategory);
                            
                            // Also refresh the main data to update user stats
                            loadData();
                        });
                    } else {
                        // Error sound
                        if (soundEnabled) playSound('error');
                        
                        showNotification('error', data.error || '¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÃ¦¬¦¦¦¬');
                    }
                })
                .catch(err => {
                    console.error('Error buying card:', err);
                    if (soundEnabled) playSound('error');
                    showNotification('error', '¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÃ¦¬¦¦¦¬');
                });
                return;
            }
            
            // For multilevel items we pass next level; for autobot use exact selected level
            const nextLevel = (category === 'autobot' || category === 'autobot_vip') ? level : (level + 1);
            
            // Get base effect and price from shopData
            const shopData = window.shopData || {};
            const item = shopData[category] && shopData[category].items && shopData[category].items[itemIndex] 
                ? shopData[category].items[itemIndex] 
                : { baseEffect: 1, basePrice: 1000 };
            
            console.log('Buying item:', {userId, category, level, price: actualPrice, itemIndex, item});
            
            fetch('/api/buy_shop_item', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: userId, 
                    category: category, 
                    level: nextLevel, 
                    price: actualPrice,
                    item_index: itemIndex,
                    base_effect: item.baseEffect || 1,
                    base_price: item.basePrice || 1000
                })
            })
            .then(res => res.json())
            .then(data => {
                if(data.success) {
                    // Success sound and haptics
                    if (soundEnabled) playSound('levelup');
                    if (hapticsEnabled && tg?.HapticFeedback) {
                        tg.HapticFeedback.notificationOccurred('success');
                    }
                    
                    // Update item level locally
                    if (category === 'tap_boost' || category === 'energy_buy' || category === 'energy_expand') {
                        // Find the item in shopData and increase its level
                        const shopData = window.shopData || {};
                        if (shopData[category] && shopData[category].items && shopData[category].items[itemIndex]) {
                            shopData[category].items[itemIndex].level = nextLevel;
                        }
                    }
                    
                    // Compact success notification for Telegram
                    const anim = document.createElement('div');
                    anim.style.cssText='position:fixed;top:15%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
                    anim.innerHTML='<div style="background:linear-gradient(135deg,rgba(34,197,94,0.95),rgba(16,185,129,0.95));padding:8px 16px;border-radius:20px;font-size:14px;box-shadow:0 4px 15px rgba(16,185,129,0.5);color:#fff;font-weight:700;display:flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,0.2);"><span style="font-size:16px;">òÜè</span> ¦ãTÀ¦-¦-¦¦¦-TÌ ¦¬¦-¦-TËTÈ¦¦¦-!</div>';
                    document.body.appendChild(anim);
                    setTimeout(()=>{anim.style.opacity='0';anim.style.transform='translate(-50%,-60%)';setTimeout(()=>{anim.remove();},300);},800);
                    
                    // Reload data and refresh shop display
                    loadData();
                    
                    // Refresh current shop category to show updated levels
                    setTimeout(() => {
                        const activeBtn = document.querySelector('.shop-cat-btn[style*="linear-gradient"]');
                        if (activeBtn && activeBtn.dataset.category) {
                            loadShopCategory(activeBtn.dataset.category);
                            }
                    }, 200);
                    
                    
                    // Update passive income immediately
                    updatePassiveIncome();
                } else {
                    // Error sound
                    if (soundEnabled) playSound('error');
                    
                    // Compact error notification for Telegram
                    const error = document.createElement('div');
                    error.style.cssText='position:fixed;top:15%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
                    const errorText = (data.error.includes('¦Ý¦¦¦+¦-TÁTÂ¦-TÂ¦-TÇ¦-¦-') || data.error.includes('Not enough')) ? '¦Ý¦¦¦+¦-TÁTÂ¦-TÂ¦-TÇ¦-¦- ¦¦¦-¦¬¦-¦-¦-' : data.error;
                    error.innerHTML='<div style="background:linear-gradient(135deg,rgba(239,68,68,0.95),rgba(220,38,38,0.95));padding:8px 16px;border-radius:20px;font-size:14px;box-shadow:0 4px 15px rgba(239,68,68,0.5);color:#fff;font-weight:700;display:flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,0.2);"><span style="font-size:16px;">¨ßÒ-</span> ' + errorText + '</div>';
                    document.body.appendChild(error);
                    setTimeout(()=>{error.style.opacity='0';error.style.transform='translate(-50%,-60%)';setTimeout(()=>{error.remove();},300);},1500);
                }
            });
        }

        function renderShop() {
            const boostsHtml = shopItems.boosts.map(item => `
                <div class="item" onclick="buyItem('boost', '${item.type}', ${item.price})">
                    <div class="item-info">
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="item-desc">${item.desc}</div>
                            <div class="item-price">${item.price.toLocaleString()} ¨ßêÙ</div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('boostsList').innerHTML = boostsHtml;

            const automationHtml = shopItems.automation.map(item => `
                <div class="item" onclick="buyItem('automation', '${item.type}', ${item.price})">
                    <div class="item-info">
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="item-desc">${item.desc}</div>
                            <div class="item-price">${item.price.toLocaleString()} ¨ßêÙ</div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('automationList').innerHTML = automationHtml;

            const energyHtml = shopItems.energy.map(item => `
                <div class="item" onclick="buyEnergy(${item.amount}, ${item.price})">
                    <div class="item-info">
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-details">
                            <div class="item-name">¦í¦-¦¦TÀ¦¦¦¬TÏ +${item.amount}</div>
                            <div class="item-price">${item.price.toLocaleString()} ¨ßêÙ</div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('energyList').innerHTML = energyHtml;

            const cardsHtml = shopItems.cards.map(item => `
                <div class="item" onclick="buyItem('card', '${item.type}', ${item.price})">
                    <div class="item-info">
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="item-desc">${item.desc}</div>
                            <div class="item-price">${item.price.toLocaleString()} ¨ßêÙ</div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('cardsList').innerHTML = cardsHtml;
        }

        function buyItem(type, id, price) {
            fetch('/api/buy', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: user?.id, item_type: id, price: price})
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('òÜÅ ¦ãTÁ¦¬¦¦TÈ¦-¦-!');
                    loadData();
                    renderShop();
                } else {
                    tg.showAlert('òÚàÿ¬Ï ' + data.error);
                }
            })
            .catch(err => {
                tg.showAlert('òÝÌ ¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÃ¦¬¦¦¦¬');
            });
        }

        function buyEnergy(amount, price) {
            fetch('/api/buy_energy', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: user?.id, amount: amount, price: price})
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('òÜÅ ¦í¦-¦¦TÀ¦¦¦¬TÏ ¦¦TÃ¦¬¦¬¦¦¦-¦-!');
                    loadData();
                    renderShop();
                } else {
                    tg.showAlert('òÚàÿ¬Ï ' + data.error);
                }
            })
            .catch(err => {
                tg.showAlert('òÝÌ ¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÃ¦¬¦¦¦¬');
            });
        }

        function openMining(e) {
            e.preventDefault();
            // Check if modal already exists
            const existingModal = document.getElementById('miningModal2');
            if(existingModal) {
                existingModal.style.display = 'block';
                existingModal.classList.add('active');
                loadMiningCategory('coins');
                return;
            }
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'miningModal2';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;">
                    <div style="background: linear-gradient(135deg, #667eea, #764ba2); padding: 30px 60px 30px 30px; border-radius: 22px 22px 0 0; text-align: center; position: relative; box-shadow: 0 8px 30px rgba(102,126,234,0.4);">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
                            <div style="font-size: 45px; text-shadow: 0 3px 10px rgba(0,0,0,0.3); filter: drop-shadow(0 0 8px rgba(102,126,234,0.8)); animation: pulse 2s infinite;">¨ßÏí</div>
                            <div>
                                <h2 style="font-size: 28px; color: #fff; margin: 0; font-weight: 900; text-shadow: 0 2px 6px rgba(0,0,0,0.2);">¦Ü¦Ð¦Ù¦Ý¦Ø¦Ý¦Ó ¦ä¦Õ¦à¦Ü¦Ð</h2>
                                <div style="font-size: 15px; color: rgba(255,255,255,0.9); margin-top: 6px; font-weight: 600;">òÚá ¦Ô¦-¦-TË¦-¦-¦¦TÂ¦¦ QuanHash ¦-¦-TÂ¦-¦-¦-TÂ¦¬TÇ¦¦TÁ¦¦¦¬</div>
                            </div>
                        </div>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                    </div>
                    
                    <div style="padding: 25px;">
                        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:20px;">
                            <button class="mining-cat-btn" onclick="loadMiningCategory('coins')" style="padding:14px;background:linear-gradient(135deg,rgba(102,126,234,0.15),rgba(118,75,162,0.15));color:#fff;border:2px solid #667eea;border-radius:12px;cursor:pointer;font-weight:800;font-size:13px;transition:all 0.3s;">
                                ¨ßêÙ ¦×¦- ¦¦¦-¦¬¦-TË
                            </button>
                            <button class="mining-cat-btn" onclick="loadMiningCategory('quanhash')" style="padding:14px;background:rgba(255,255,255,0.05);color:#fff;border:2px solid rgba(16,185,129,0.2);border-radius:12px;cursor:pointer;font-weight:800;font-size:13px;transition:all 0.3s;">
                                ¨ßÒÎ ¦×¦- QuanHash
                            </button>
                        </div>
                        
                        <div style="margin-bottom:15px;">
                            <button onclick="openVIPMiningModal()" style="width:100%;padding:14px;background:linear-gradient(135deg,#ffd700,#ffed4e,#ffd700);color:#000;border:2px solid #ffd700;border-radius:14px;cursor:pointer;font-weight:900;font-size:15px;box-shadow:0 4px 20px rgba(255,215,0,0.4);transition:all 0.3s;display:flex;align-items:center;justify-content:center;gap:10px;" onmousedown="this.style.transform='scale(0.97)'; this.style.boxShadow='0 6px 25px rgba(255,215,0,0.5)'" onmouseup="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 20px rgba(255,215,0,0.4)'" onmouseleave="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 20px rgba(255,215,0,0.4)'">
                                <span style="font-size:20px;text-shadow:0 2px 4px rgba(0,0,0,0.3);filter:drop-shadow(0 0 3px rgba(255,215,0,0.8));">òíÐ</span>
                                <span>VIP ¦Ü¦-TÈ¦¬¦-TË ¦¬¦- Telegram Stars</span>
                            </button>
                        </div>
                        
                        <div id="miningShop" style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:20px;"></div>
                        
                        <div id="userMachines" style="margin-top:25px;padding-top:25px;border-top:2px solid rgba(102,126,234,0.3);">
                            <h3 style="font-size:16px;margin-bottom:15px;color:#fff;text-align:center;font-weight:800;">¨ß×Ãÿ¬Ï ¦Ò¦Ð¦è¦Ø ¦Ü¦Ð¦è¦Ø¦Ý¦ë</h3>
                            <div id="machinesList"></div>
                        </div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            loadMiningCategory('coins');
        }
        const vipMiningCards = [
            {id: 'vip_quantum_prime', name: 'Quantum Prime', emoji: 'òÚá', basePrice: 50, baseHashPerHour: 120000, rarity: 'vip_prime', productId: 71, description: '¦í¦¬¦¬TÂ¦-TË¦¦ ¦¦¦-¦-¦-TÂ¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¦TÀ'},
            {id: 'vip_solar_core', name: 'Solar Core', emoji: 'òØÀÿ¬Ï', basePrice: 100, baseHashPerHour: 300000, rarity: 'vip_solar', productId: 72, description: '¦á¦-¦¬¦-¦¦TÇ¦-¦-¦¦ TÏ¦+TÀ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬'},
            {id: 'vip_black_hole', name: 'Black Hole', emoji: '¨ßÕ¦ÿ¬Ï', basePrice: 150, baseHashPerHour: 750000, rarity: 'vip_blackhole', productId: 73, description: '¦çTÑTÀ¦-¦-TÏ ¦+TËTÀ¦- TÍ¦-¦¦TÀ¦¦¦¬¦¬'},
            {id: 'vip_nebula', name: 'Nebula ¦ä¦¦TÀ¦-¦-', emoji: '¨ßÌëÿ¬Ï', basePrice: 250, baseHashPerHour: 2000000, rarity: 'vip_nebula', productId: 74, description: '¦ä¦¦TÀ¦-¦- ¦- TÂTÃ¦-¦-¦-¦-¦-TÁTÂ¦¬'},
            {id: 'vip_multiverse', name: 'Multiverse ¦áTÂ¦-¦-TÆ¦¬TÏ', emoji: '¨ßÌÐ', basePrice: 400, baseHashPerHour: 5000000, rarity: 'vip_multiverse', productId: 75, description: '¦ÜTÃ¦¬TÌTÂ¦¬¦-TÁ¦¦¦¬¦¦¦-¦-¦-TÏ'},
            {id: 'vip_infinity', name: 'Infinity ¦Ð¦¬TÌTÏ¦-TÁ', emoji: 'òÙ-ÿ¬Ï', basePrice: 750, baseHashPerHour: 12000000, rarity: 'vip_infinity', productId: 76, description: '¦Ñ¦¦TÁ¦¦¦-¦-¦¦TÇ¦-TË¦¦ ¦-¦¬TÌTÏ¦-TÁ'}
        ];
        
        const miningMachinesData = {
            'coins': [
                {id: 'miner_cpu', name: 'CPU ¦Ü¦-¦¦¦-¦¦TÀ', emoji: '¨ßÒ¬', basePrice: 5000, baseHashPerHour: 10, currency: 'coins', description: '¦Ñ¦-¦¬¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¦TÀ ¦-¦- CPU'},
                {id: 'miner_gpu', name: 'GPU ¦Ü¦-¦¦¦-¦¦TÀ', emoji: '¨ßÎî', basePrice: 20000, baseHashPerHour: 50, currency: 'coins', description: '¦Ò¦¬¦+¦¦¦-¦¦¦-TÀTÂ¦- ¦+¦¬TÏ ¦-¦-¦¦¦-¦¬¦-¦¦¦-'},
                {id: 'miner_asic', name: 'ASIC ¦à¦¬¦¦', emoji: 'òÚá', basePrice: 80000, baseHashPerHour: 200, currency: 'coins', description: '¦ÐTÁ¦¬¦¦-TÃTÁTÂTÀ¦-¦¦TÁTÂ¦-¦-'},
                {id: 'miner_quantum', name: 'Quantum ¦Ü¦-¦¦¦-¦¦TÀ', emoji: '¨ßÒÎ', basePrice: 300000, baseHashPerHour: 800, currency: 'coins', description: '¦Ú¦-¦-¦-TÂ¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¦TÀ'},
                {id: 'miner_server', name: 'Server ¦ä¦¦TÀ¦-¦-', emoji: '¨ßÖåÿ¬Ï', basePrice: 1000000, baseHashPerHour: 3000, currency: 'coins', description: '¦á¦¦TÀ¦-¦¦TÀ¦-¦-TÏ TÄ¦¦TÀ¦-¦-'},
                {id: 'miner_cloud', name: 'Cloud ¦à¦¬¦¦', emoji: 'òØÁÿ¬Ï', basePrice: 3500000, baseHashPerHour: 12000, currency: 'coins', description: '¦Þ¦-¦¬¦-TÇ¦-¦-TÏ TÄ¦¦TÀ¦-¦-'},
                {id: 'miner_data', name: 'Data ¦æ¦¦¦-TÂTÀ', emoji: '¨ßÏâ', basePrice: 12000000, baseHashPerHour: 50000, currency: 'coins', description: '¦Ô¦-TÂ¦--TÆ¦¦¦-TÂTÀ'},
                {id: 'miner_quantum_farm', name: 'Quantum ¦ä¦¦TÀ¦-¦-', emoji: '¨ßÌÌ', basePrice: 40000000, baseHashPerHour: 200000, currency: 'coins', description: '¦Ú¦-¦-¦-TÂ¦-¦-¦-TÏ TÄ¦¦TÀ¦-¦-'},
                {id: 'miner_neural', name: 'Neural ¦Ü¦-¦¦¦-¦¦TÀ', emoji: '¨ßçà', basePrice: 150000000, baseHashPerHour: 800000, currency: 'coins', description: '¦Ý¦¦¦¦TÀ¦-TÁ¦¦TÂ¦¦¦-¦-¦¦ ¦-¦-¦¦¦-¦¦TÀ'},
                {id: 'miner_cosmic', name: 'Cosmic ¦áTÂ¦-¦-TÆ¦¬TÏ', emoji: '¨ßÚÀ', basePrice: 500000000, baseHashPerHour: 3200000, currency: 'coins', description: '¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦-TÏ TÁTÂ¦-¦-TÆ¦¬TÏ'}
            ],
            'quanhash': [
                {id: 'hash_quantum_core', name: 'Quantum ¦ï¦+TÀ¦-', emoji: 'òÚÛÿ¬Ï', basePrice: 10000, baseHashPerHour: 80, currency: 'quanhash', description: '¦Ú¦-¦-¦-TÂ¦-¦-¦-¦¦ TÏ¦+TÀ¦-'},
                {id: 'hash_plasma_rig', name: 'Plasma ¦à¦¬¦¦', emoji: '¨ßÔå', basePrice: 50000, baseHashPerHour: 400, currency: 'quanhash', description: '¦ß¦¬¦-¦¬¦-¦¦¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¦TÀ'},
                {id: 'hash_stellar', name: 'Stellar ¦Ñ¦¬¦-¦¦', emoji: 'òíÐ', basePrice: 250000, baseHashPerHour: 1800, currency: 'quanhash', description: '¦×¦-TÑ¦¬¦+¦-TË¦¦ ¦-¦¬¦-¦¦'},
                {id: 'hash_cosmic_flux', name: 'Cosmic ¦ß¦-TÂ¦-¦¦', emoji: '¨ßÌÊ', basePrice: 1000000, baseHashPerHour: 7000, currency: 'quanhash', description: '¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦¬¦-TÂ¦-¦¦'},
                {id: 'hash_nova', name: 'Nova ¦ãTÁ¦¦¦-TÀ¦¬TÂ¦¦¦¬TÌ', emoji: '¨ßÌß', basePrice: 4000000, baseHashPerHour: 28000, currency: 'quanhash', description: '¦Ý¦-¦-¦¦¦¦TÈ¦¬¦¦ TÃTÁ¦¦¦-TÀ¦¬TÂ¦¦¦¬TÌ'},
                {id: 'hash_galaxy', name: 'Galaxy ¦Ü¦-TÂTÀ¦¬TÆ¦-', emoji: '¨ßÌÌ', basePrice: 15000000, baseHashPerHour: 110000, currency: 'quanhash', description: '¦Ó¦-¦¬¦-¦¦TÂ¦¬TÇ¦¦TÁ¦¦¦-TÏ ¦-¦-TÂTÀ¦¬TÆ¦-'},
                {id: 'hash_void', name: 'Void ¦ß¦-TÀTÂ¦-¦¬TË', emoji: '¨ßÕ¦ÿ¬Ï', basePrice: 60000000, baseHashPerHour: 450000, currency: 'quanhash', description: '¦ÒTÀ¦-TÂ¦- ¦- ¦¬TÃTÁTÂ¦-TÂTÃ'},
                {id: 'hash_eternal', name: 'Eternal ¦Ô¦-¦¬¦¦¦¬TÂ¦¦¦¬TÌ', emoji: 'òÈÞ', basePrice: 250000000, baseHashPerHour: 1800000, currency: 'quanhash', description: '¦Ò¦¦TÇ¦-TË¦¦ ¦+¦-¦¬¦¦¦¬TÂ¦¦¦¬TÌ'},
                {id: 'hash_divine', name: 'Divine ¦Ó¦¦¦-¦¦TÀ¦-TÂ¦-TÀ', emoji: '¨ßÑÑ', basePrice: 1000000000, baseHashPerHour: 7200000, currency: 'quanhash', description: '¦Ñ¦-¦¦¦¦TÁTÂ¦-¦¦¦-¦-TË¦¦ ¦¦¦¦¦-¦¦TÀ¦-TÂ¦-TÀ'},
                {id: 'hash_absolute', name: 'Absolute ¦Ü¦-TÉTÌ', emoji: 'òÚá', basePrice: 4000000000, baseHashPerHour: 28800000, currency: 'quanhash', description: '¦Ð¦-TÁ¦-¦¬TÎTÂ¦-¦-TÏ ¦-¦-TÉTÌ'}
            ]
        };
        
        function loadMiningCategory(category) {
            // Update button states
            document.querySelectorAll('.mining-cat-btn').forEach(btn => {
                const isCoins = category === 'coins';
                const isActive = btn.textContent.includes(isCoins ? '¦¦¦-¦¬¦-TË' : 'QuanHash');
                if(isActive) {
                    btn.style.background = isCoins ? 'linear-gradient(135deg,rgba(102,126,234,0.25),rgba(118,75,162,0.25))' : 'linear-gradient(135deg,rgba(16,185,129,0.25),rgba(34,197,94,0.25))';
                    btn.style.border = isCoins ? '2px solid #667eea' : '2px solid #10b981';
                } else {
                    btn.style.background = 'rgba(255,255,255,0.05)';
                    btn.style.border = '2px solid rgba(102,126,234,0.2)';
                }
            });
            
            const machines = miningMachinesData[category] || [];
            const shop = document.getElementById('miningShop');
            if(shop) {
                const isCoins = category === 'coins';
                const bgGradient = isCoins ? 'linear-gradient(135deg,rgba(102,126,234,0.2),rgba(118,75,162,0.2))' : 'linear-gradient(135deg,rgba(16,185,129,0.2),rgba(34,197,94,0.2))';
                const borderColor = isCoins ? '#667eea' : '#10b981';
                const buttonGradient = isCoins ? 'linear-gradient(135deg,#667eea,#764ba2)' : 'linear-gradient(135deg,#10b981,#059669)';
                
                // Load user machines and levels from API
                fetch('/api/mining', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: window.user?.id, category: category})
                })
                .then(res => res.json())
                .then(data => {
                    // Update shop with levels
                    const machine_levels = data.machine_levels || {};
                    shop.innerHTML = machines.map((m, index) => {
                        const level = machine_levels[m.id] || 0;
                        const maxLevel = 50;
                        const isMaxLevel = level >= maxLevel;
                        const price = Math.floor(m.basePrice * Math.pow(1.15, level));
                        const hashPerHour = Math.floor(m.baseHashPerHour * Math.pow(1.15, level));
                        
                        return `
                            <div style="background:${bgGradient};padding:16px;border-radius:16px;border:3px solid ${borderColor};position:relative;box-shadow:0 8px 25px rgba(0,0,0,0.3);transition:all 0.3s;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 35px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.3)'">
                                <div style="position:absolute;top:8px;right:8px;background:${borderColor};color:#fff;padding:3px 8px;border-radius:6px;font-size:9px;font-weight:900;box-shadow:0 2px 8px rgba(0,0,0,0.3);">òÚá</div>
                                <div style="font-size:32px;text-align:center;margin-bottom:8px;filter:drop-shadow(0 4px 8px rgba(0,0,0,0.3));">${m.emoji}</div>
                                <div style="font-weight:900;font-size:13px;color:#fff;text-align:center;margin-bottom:4px;text-shadow:0 2px 4px rgba(0,0,0,0.5);">${m.name}</div>
                                <div style="font-size:9px;color:#94a3b8;text-align:center;margin-bottom:8px;font-weight:600;opacity:0.8;">${m.description || ''}</div>
                                <div style="font-size:10px;color:${isMaxLevel ? '#fbbf24' : '#94a3b8'};text-align:center;margin-bottom:8px;font-weight:600;">¦ãTÀ¦-¦-¦¦¦-TÌ ${level}${isMaxLevel ? ' òíÐ MAX' : ` / ${maxLevel}`}</div>
                                <div style="font-size:12px;color:#4ade80;font-weight:900;text-align:center;margin-bottom:12px;text-shadow:0 0 10px rgba(74,222,128,0.4);">¦Ô¦-TÅ¦-¦+ +${hashPerHour.toLocaleString()} QuanHash/TÇ</div>
                                <button onclick="${isMaxLevel ? 'alert(\'òÜè ¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦ TÃTÀ¦-¦-¦¦¦-TÌ ¦+¦-TÁTÂ¦¬¦¦¦-TÃTÂ!\')' : `buyMachine('${m.id}', ${price}, '${m.currency}')`}" 
                                        style="width:100%;padding:11px;background:${isMaxLevel ? 'linear-gradient(135deg,#fbbf24,#fcd34d,#fbbf24)' : buttonGradient};color:${isMaxLevel ? '#000' : '#fff'};border:none;border-radius:10px;cursor:${isMaxLevel ? 'not-allowed' : 'pointer'};font-weight:900;font-size:11px;box-shadow:0 4px 15px rgba(0,0,0,0.3);transition:all 0.3s;display:flex;align-items:center;justify-content:center;gap:6px;opacity:${isMaxLevel ? 0.7 : 1};"
                                        onmousedown="${!isMaxLevel ? 'this.style.transform=\'scale(0.96)\'' : ''}" 
                                        onmouseup="${!isMaxLevel ? 'this.style.transform=\'scale(1)\'' : ''}" 
                                        onmouseleave="${!isMaxLevel ? 'this.style.transform=\'scale(1)\'' : ''}">
                                    <span>${isMaxLevel ? 'òÜè ¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦ TÃTÀ¦-¦-¦¦¦-TÌ' : `¦ÚTÃ¦¬¦¬TÂTÌ ¦¬¦- ${m.currency === 'coins' ? '¨ßêÙ' : '¨ßÒÎ'} ${price.toLocaleString()} ${m.currency === 'coins' ? '¦¦¦-¦¬¦-¦-¦-' : 'QuanHash'}`}</span>
                                </button>
                            </div>
                        `;
                    }).join('');
                    
                    const machinesList = document.getElementById('machinesList');
                    console.log('machinesList element:', machinesList, 'user_machines:', data.user_machines, 'length:', data.user_machines?.length);
                    if(machinesList && data.user_machines) {
                        console.log('user_machines array:', data.user_machines);
                        if(data.user_machines.length > 0) {
                            machinesList.innerHTML = data.user_machines.map(m => {
                                const count = m.count || 1;
                                const incomePerHour = m.income_per_hour || 0;
                                const totalIncome = m.total_income || (incomePerHour * count);
                                
                                return `
                                <div style="background:rgba(102,126,234,0.15);padding:12px;border-radius:12px;border:2px solid rgba(102,126,234,0.3);margin-bottom:10px;animation:slideIn 0.3s ease-out;box-shadow:0 4px 12px rgba(102,126,234,0.2);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;">
                                        <div style="flex:1;">
                                            <div style="font-weight:900;font-size:14px;margin-bottom:4px;color:#fff;">${m.name} ${count > 1 ? `<span style="background:rgba(102,126,234,0.6);padding:2px 6px;border-radius:4px;font-size:10px;">x${count}</span>` : ''}</div>
                                            <div style="font-size:11px;color:#94a3b8;">¦ãTÀ¦-¦-¦¦¦-TÌ ${m.level} | ${(m.hash_rate || 0).toFixed(6)} Hash/s</div>
                                            <div style="font-size:12px;color:#4ade80;margin-top:4px;font-weight:700;">¦Ô¦-TÅ¦-¦+ +${Math.floor(totalIncome).toLocaleString()} QuanHash/TÇ¦-TÁ</div>
                                        </div>
                                        <div style="text-align:right;">
                                            <div style="font-size:28px;filter:drop-shadow(0 4px 8px rgba(102,126,234,0.5));">òÚá</div>
                                        </div>
                                    </div>
                                </div>
                            `;
                            }).join('');
                        } else {
                            machinesList.innerHTML = '<p style="text-align:center;opacity:0.7;padding:15px;background:rgba(255,255,255,0.05);border-radius:12px;border:2px solid rgba(255,255,255,0.1);">¨ßÛÒ ¦ã ¦-¦-TÁ ¦-¦¦TÂ ¦-¦-TÈ¦¬¦-. ¦ÚTÃ¦¬¦¬TÂ¦¦ ¦¬TÅ ¦-TËTÈ¦¦!</p>';
                        }
                    }
                })
                .catch(err => {
                    const machinesList = document.getElementById('machinesList');
                    if(machinesList) {
                        machinesList.innerHTML = '<p style="text-align:center;opacity:0.7;padding:15px;background:rgba(255,255,255,0.05);border-radius:12px;border:2px solid rgba(255,255,255,0.1);">¨ßÛÒ ¦ã ¦-¦-TÁ ¦-¦¦TÂ ¦-¦-TÈ¦¬¦-. ¦ÚTÃ¦¬¦¬TÂ¦¦ ¦¬TÅ ¦-TËTÈ¦¦!</p>';
                    }
                });
            }
        }
        
        window.openVIPMiningModal = function() {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.style.zIndex = '10001';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;border: 2px solid rgba(255,215,0,0.4);box-shadow: 0 20px 60px rgba(255,215,0,0.3);">
                    <div style="background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700); padding: 30px 60px 30px 30px; border-radius: 22px 22px 0 0; text-align: center; position: relative; box-shadow: 0 8px 30px rgba(255,215,0,0.4);">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
                            <div style="font-size: 45px; text-shadow: 0 3px 10px rgba(0,0,0,0.3); filter: drop-shadow(0 0 8px rgba(255,215,0,0.8)); animation: pulse 2s infinite;">òíÐ</div>
                            <div>
                                <h2 style="font-size: 28px; color: #000; margin: 0; font-weight: 900; text-shadow: 0 2px 6px rgba(0,0,0,0.2);">VIP ¦Ü¦Ð¦è¦Ø¦Ý¦ë</h2>
                                <div style="font-size: 15px; color: rgba(0,0,0,0.7); margin-top: 6px; font-weight: 600;">¨ßÏí ¦í¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-¦-TÏ ¦+¦-¦-TËTÇ¦- QuanHash</div>
                            </div>
                        </div>
                        <button class="close-btn" onclick="this.closest('.modal').remove()" style="color: #000;">òÜÕ</button>
                    </div>
                    
                    <div style="padding: 25px;">
                        <div id="vipMiningContent" style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:20px;"></div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Load VIP levels from API
            fetch('/api/mining', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: user?.id, category: 'vip'})
            })
            .then(res => res.json())
            .then(data => {
                const vip_levels = data.machine_levels || {};
                renderVIPMiningCards(vip_levels);
            })
            .catch(err => {
                console.error('Failed to load VIP levels:', err);
                renderVIPMiningCards({});
            });
        };
        
        function renderVIPMiningCards(vip_levels) {
            const vipMiningContent = document.getElementById('vipMiningContent');
            if (!vipMiningContent) return;
            
            let html = vipMiningCards.map((card, index) => {
                const level = vip_levels[card.id] || 0;
                const maxLevel = 50;
                const isMaxLevel = level >= maxLevel;
                const price = Math.floor(card.basePrice * Math.pow(1.15, level));
                const hashPerHour = Math.floor(card.baseHashPerHour * Math.pow(1.15, level));
                
                return `
                    <div style="background:linear-gradient(135deg,rgba(255,215,0,0.25),rgba(255,237,78,0.25));padding:16px;border-radius:16px;border:3px solid #ffd700;position:relative;box-shadow:0 8px 25px rgba(0,0,0,0.3);transition:all 0.3s;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 35px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.3)'">
                        <div style="position:absolute;top:8px;right:8px;background:#ffd700;color:#000;padding:3px 8px;border-radius:6px;font-size:9px;font-weight:900;box-shadow:0 2px 8px rgba(0,0,0,0.3);">VIP</div>
                        <div style="font-size:32px;text-align:center;margin-bottom:8px;filter:drop-shadow(0 4px 8px rgba(0,0,0,0.3));">${card.emoji}</div>
                        <div style="font-weight:900;font-size:14px;color:#fff;text-align:center;margin-bottom:4px;text-shadow:0 2px 4px rgba(0,0,0,0.5);">${card.name}</div>
                        <div style="font-size:9px;color:#94a3b8;text-align:center;margin-bottom:8px;font-weight:600;opacity:0.8;">${card.description || ''}</div>
                        <div style="font-size:10px;color:${isMaxLevel ? '#fbbf24' : '#94a3b8'};text-align:center;margin-bottom:8px;font-weight:600;">¦ãTÀ¦-¦-¦¦¦-TÌ ${level}${isMaxLevel ? ' òíÐ MAX' : ` / ${maxLevel}`}</div>
                        <div style="font-size:12px;color:#4ade80;font-weight:900;text-align:center;margin-bottom:12px;text-shadow:0 0 10px rgba(74,222,128,0.4);">¦Ô¦-TÅ¦-¦+ +${hashPerHour.toLocaleString()} QuanHash/TÇ</div>
                        <button onclick="${isMaxLevel ? 'alert(\'òÜè ¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦ TÃTÀ¦-¦-¦¦¦-TÌ ¦+¦-TÁTÂ¦¬¦¦¦-TÃTÂ!\')' : `buyVIPMiningMachineWithStars('${card.id}', ${price}, ${card.productId})`}" 
                                style="width:100%;padding:11px;background:${isMaxLevel ? 'linear-gradient(135deg,#fbbf24,#fcd34d,#fbbf24)' : 'linear-gradient(135deg,#ffd700,#ffed4e,#ffd700)'};color:${isMaxLevel ? '#000' : '#000'};border:none;border-radius:10px;cursor:${isMaxLevel ? 'not-allowed' : 'pointer'};font-weight:900;font-size:11px;box-shadow:0 4px 15px rgba(0,0,0,0.3);transition:all 0.3s;display:flex;align-items:center;justify-content:center;gap:6px;opacity:${isMaxLevel ? 0.7 : 1};"
                                onmousedown="${!isMaxLevel ? 'this.style.transform=\'scale(0.96)\'' : ''}" 
                                onmouseup="${!isMaxLevel ? 'this.style.transform=\'scale(1)\'' : ''}" 
                                onmouseleave="${!isMaxLevel ? 'this.style.transform=\'scale(1)\'' : ''}">
                            <span>${isMaxLevel ? 'òÜè ¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦ TÃTÀ¦-¦-¦¦¦-TÌ' : `¦ÚTÃ¦¬¦¬TÂTÌ ¦¬¦-`}</span>
                            <span style="font-size:14px;filter:drop-shadow(0 0 3px rgba(255,215,0,0.8));">${isMaxLevel ? '' : 'òíÐ'}</span>
                            <span>${isMaxLevel ? '' : price}</span>
                        </button>
                    </div>
                `;
            }).join('');
            
            vipMiningContent.innerHTML = html;
        };
        
        window.buyVIPMiningMachineWithStars = function(machineId, price, productId) {
            // Open Telegram payment
            const paymentUrl = `https://t.me/qanexus_bot?start=buy_stars_${productId}`;
            window.open(paymentUrl, '_blank');
            
            // Show beautiful VIP confirmation message
            const anim = document.createElement('div');
            anim.style.cssText = 'position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
            anim.innerHTML = '<div style="background:linear-gradient(135deg,rgba(255,215,0,0.95),rgba(255,237,78,0.95));padding:25px 50px;border-radius:25px;font-size:26px;box-shadow:0 15px 50px rgba(255,215,0,0.7);color:#000;font-weight:800;display:flex;align-items:center;gap:20px;border:3px solid rgba(255,215,0,0.8);"><span style="font-size:40px;">òíÐ</span><div><div style="font-size:28px;margin-bottom:8px;">VIP ¦ß¦-¦¦TÃ¦¬¦¦¦-</div><div style="font-size:20px;opacity:0.8;">¦ÞTÂ¦¦TÀTË¦-¦-¦¦TÂTÁTÏ ¦-¦¬¦¬¦-TÂ¦- ¦¬¦- ' + price + ' òíÐ Telegram Stars</div></div></div>';
            document.body.appendChild(anim);
            setTimeout(() => {
                anim.style.opacity = '0';
                anim.style.transform = 'translate(-50%,-70%)';
                setTimeout(() => {anim.remove();}, 300);
            }, 2000);
        };
        
        function buyMachine(id, price, currency) {
            console.log('buyMachine called:', {id, price, currency, user_id: window.user?.id});
            
            // Play sound for mining purchase
            const soundEnabled = localStorage.getItem('soundEnabled') === 'true';
            if (soundEnabled) {
                playSound('mining');
            }
            
            // Haptic feedback
            const hapticsEnabled = localStorage.getItem('hapticsEnabled') === 'true';
            if (hapticsEnabled && tg?.HapticFeedback) {
                tg.HapticFeedback.impactOccurred('medium');
            }
            
            const anim = document.createElement('div');
            anim.style.cssText='position:fixed;top:15%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
            anim.innerHTML='<div style="background:linear-gradient(135deg,rgba(102,126,234,0.95),rgba(118,75,162,0.95));padding:8px 16px;border-radius:20px;font-size:14px;box-shadow:0 4px 15px rgba(102,126,234,0.5);color:#fff;font-weight:700;display:flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,0.2);"><span style="font-size:16px;">òÚá</span> ¦ß¦-¦¦TÃ¦¬¦¦¦-...</div>';
            document.body.appendChild(anim);
            setTimeout(()=>{anim.style.opacity='1';},10);
            
            fetch('/api/buy_machine', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                    user_id: window.user?.id,
                    machine_id: id,
                    price: price,
                    currency: currency
                })
            })
            .then(res => res.json())
            .then(data => {
                console.log('buyMachine response:', data);
                if(data.success) {
                    // Success sound and haptics
                    if (soundEnabled) playSound('levelup');
                    if (hapticsEnabled && tg?.HapticFeedback) {
                        tg.HapticFeedback.notificationOccurred('success');
                    }
                    
                    // Success notification - like in shop
                    anim.innerHTML='<div style="background:linear-gradient(135deg,rgba(34,197,94,0.95),rgba(16,185,129,0.95));padding:8px 16px;border-radius:20px;font-size:14px;box-shadow:0 4px 15px rgba(16,185,129,0.5);color:#fff;font-weight:700;display:flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,0.2);"><span style="font-size:16px;">òÜè</span> ¦Ü¦-TÈ¦¬¦-¦- TÃ¦¬TÃTÇTÈ¦¦¦-¦-!</div>';
                    setTimeout(()=>{
                        anim.style.opacity='0';anim.style.transform='translate(-50%,-60%)';
                        setTimeout(()=>{anim.remove();},300);
                    },800);
                    // Reload current category - find active button by checking computed styles
                    let currentCat = 'coins';
                    document.querySelectorAll('.mining-cat-btn').forEach(btn => {
                        const bg = btn.style.background;
                        if(bg.includes('0.25') || bg.includes('linear-gradient')) {
                            if(btn.textContent.includes('¦¦¦-¦¬¦-TË') || btn.textContent.includes('Coins')) currentCat = 'coins';
                            else if(btn.textContent.includes('QuanHash')) currentCat = 'quanhash';
                        }
                    });
                    console.log('Reloading category:', currentCat);
                    loadMiningCategory(currentCat);
                    loadData();
                } else {
                    // Error sound
                    if (soundEnabled) playSound('error');
                    
                    // Error notification - like in shop
                    const errorText = data.error.includes('¦Ý¦¦¦+¦-TÁTÂ¦-TÂ¦-TÇ¦-¦-') || data.error.includes('Not enough') ? '¦Ý¦¦¦+¦-TÁTÂ¦-TÂ¦-TÇ¦-¦- ' + (currency === 'coins' ? '¦¦¦-¦¬¦-¦-¦-' : 'QuanHash') : data.error;
                    anim.innerHTML='<div style="background:linear-gradient(135deg,rgba(239,68,68,0.95),rgba(220,38,38,0.95));padding:8px 16px;border-radius:20px;font-size:14px;box-shadow:0 4px 15px rgba(239,68,68,0.5);color:#fff;font-weight:700;display:flex;align-items:center;gap:6px;border:1px solid rgba(255,255,255,0.2);"><span style="font-size:16px;">¨ßÒ-</span> ' + errorText + '</div>';
                    setTimeout(()=>{
                        anim.style.opacity='0';anim.style.transform='translate(-50%,-60%)';
                        setTimeout(()=>{anim.remove();},300);
                    },1500);
                }
            });
        }

        function openCards(e) {
            e.preventDefault();
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'cardsModal2';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 420px; max-height: 85vh; overflow-y: auto;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h2 style="font-size: 24px; color: #fff; font-weight: 800;">¨ßÒ¦ ¦ÚTÀ¦¬¦¬TÂ¦--¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                    </div>
                    
                    <div style="background:linear-gradient(135deg,rgba(102,126,234,0.15),rgba(118,75,162,0.15));padding:15px;border-radius:15px;margin-bottom:20px;border:2px solid rgba(102,126,234,0.3);">
                        <div style="font-size:13px;color:#94a3b8;line-height:1.6;">
                            <strong style="color:#fff;">¨ßÓË ¦ß¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+ 24/7:</strong> ¦ÚTÀ¦¬¦¬TÂ¦--¦¦¦-TÀTÂ¦-TÇ¦¦¦¬ ¦¦¦¦¦-¦¦TÀ¦¬TÀTÃTÎTÂ ¦¦¦-¦¬¦-TË ¦¦¦-¦¦¦+TÃTÎ ¦-¦¬¦-TÃTÂTÃ! ¦à¦-¦¬¦-TË¦¦ TÀ¦¦¦+¦¦¦-TÁTÂ¦¬ = TÀ¦-¦¬¦-TË¦¦ ¦+¦-TÅ¦-¦+. ¦×¦-TÀ¦-¦-¦-TÂTË¦-¦-¦¦TÂ¦¦ ¦+¦-¦¦¦¦ ¦-TÄTÄ¦¬¦-¦¦¦-!
                        </div>
                    </div>
                    
                    <div id="cardsShopSection" style="margin-bottom:25px;">
                        <div style="font-size:16px;font-weight:700;color:#fff;margin-bottom:15px;display:flex;align-items:center;gap:8px;grid-column:1/-1;">
                            <span style="background:linear-gradient(135deg,#667eea,#764ba2);padding:6px 12px;border-radius:8px;width:100%;text-align:center;">¨ßÛÒ ¦Ü¦-¦¦¦-¦¬¦¬¦- ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦</span>
                        </div>
                        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:15px;">
                            <button class="filter-btn shop-cat-btn" data-category="per_hour" onclick="loadCardsCategory('per_hour')" style="padding:10px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:10px;cursor:pointer;font-weight:600;font-size:12px;">òÚá ¦Ò TÇ¦-TÁ (¦ÞTÁ¦-¦-¦-¦-TË¦¦)</button>
                            <button class="filter-btn shop-cat-btn" data-category="per_minute" onclick="loadCardsCategory('per_minute')" style="padding:10px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:10px;cursor:pointer;font-weight:600;font-size:12px;">¨ßÒÎ ¦Ò ¦-¦¬¦-TÃTÂTÃ (¦ßTÀ¦¦¦-¦¬TÃ¦-)</button>
                        </div>
                        <div style="margin-bottom:15px;">
                            <button onclick="openVIPCardsModal()" style="width:100%;padding:14px;background:linear-gradient(135deg,#ffd700,#ffed4e,#ffd700);color:#000;border:2px solid #ffd700;border-radius:14px;cursor:pointer;font-weight:900;font-size:15px;box-shadow:0 4px 20px rgba(255,215,0,0.4);transition:all 0.3s;display:flex;align-items:center;justify-content:center;gap:10px;" onmousedown="this.style.transform='scale(0.97)'; this.style.boxShadow='0 6px 25px rgba(255,215,0,0.5)'" onmouseup="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 20px rgba(255,215,0,0.4)'" onmouseleave="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 20px rgba(255,215,0,0.4)'">
                                <span style="font-size:20px;text-shadow:0 2px 4px rgba(0,0,0,0.3);filter:drop-shadow(0 0 3px rgba(255,215,0,0.8));">òíÐ</span>
                                <span>VIP ¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬ ¦¬¦- Telegram Stars</span>
                            </button>
                        </div>
                        <div id="shopCardsList" style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;"></div>
                        <div id="vipCardsSection" style="display:none;grid-template-columns:repeat(2,1fr);gap:12px;margin-top:20px;"></div>
                    </div>
                    
                    <div id="passiveInfo" style="background:linear-gradient(135deg,rgba(16,185,129,0.2),rgba(34,197,94,0.2));padding:20px;border-radius:15px;border:2px solid rgba(16,185,129,0.4);text-align:center;margin-top:20px;margin-bottom:15px;">
                        <div style="font-size:14px;font-weight:700;margin-bottom:10px;color:#10b981;">¨ßÒ- ¦Þ¦-TÉ¦¬¦¦ ¦¬¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+</div>
                        <div style="font-size:36px;font-weight:900;color:#10b981;text-shadow:0 0 20px rgba(16,185,129,0.5);">+0 ¨ßêÙ/TÇ¦-TÁ</div>
                    </div>
                    
                    <button onclick="this.closest('.modal').remove()" style="width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:16px;">¦×¦-¦¦TÀTËTÂTÌ</button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Load cards function
            window.loadCardsCategory = function(category) {
                // Handle VIP cards section display
                const shopCardsList = document.getElementById('shopCardsList');
                const vipCardsSection = document.getElementById('vipCardsSection');
                
                shopCardsList.style.display = 'grid';
                if (vipCardsSection) vipCardsSection.style.display = 'none';
                
                document.querySelectorAll('#cardsShopSection .shop-cat-btn').forEach(btn => {
                    if(btn.textContent.toLowerCase().includes(category === 'per_hour' ? 'TÇ¦-TÁ' : '¦-¦¬¦-TÃTÂTÃ')) {
                        btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                        btn.style.border = 'none';
                    } else {
                        btn.style.background = 'rgba(255,255,255,0.1)';
                        btn.style.border = '1px solid rgba(255,255,255,0.3)';
                    }
                });
                loadCardsList(category);
            };
            
            window.buyVIPCard = function(cardType) {
                fetch('/api/buy_vip_card', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: user?.id,
                        card_type: cardType
                    })
                })
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        tg.showAlert('òÜÅ VIP ¦¦¦-TÀTÂ¦-TÇ¦¦¦- ¦¦TÃ¦¬¦¬¦¦¦-¦-!');
                        loadData();
                    } else {
                        tg.showAlert('òÝÌ ' + data.error);
                    }
                })
                .catch(err => tg.showAlert('òÝÌ ¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÃ¦¬¦¦¦¬'));
            };
            
            window.buyVIPCardWithStars = function(cardRarity, price, productId) {
                // Open Telegram payment (same as in VIP shop)
                const paymentUrl = `https://t.me/qanexus_bot?start=buy_stars_${productId}`;
                window.open(paymentUrl, '_blank');
                
                // Show beautiful VIP confirmation message
                const anim = document.createElement('div');
                anim.style.cssText = 'position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
                anim.innerHTML = '<div style="background:linear-gradient(135deg,rgba(255,215,0,0.95),rgba(255,237,78,0.95));padding:25px 50px;border-radius:25px;font-size:26px;box-shadow:0 15px 50px rgba(255,215,0,0.7);color:#000;font-weight:800;display:flex;align-items:center;gap:20px;border:3px solid rgba(255,215,0,0.8);"><span style="font-size:40px;">òíÐ</span><div><div style="font-size:28px;margin-bottom:8px;">VIP ¦ß¦-¦¦TÃ¦¬¦¦¦-</div><div style="font-size:20px;opacity:0.8;">¦ÞTÂ¦¦TÀTË¦-¦-¦¦TÂTÁTÏ ¦-¦¬¦¬¦-TÂ¦- ¦¬¦- ' + price + ' òíÐ Telegram Stars</div></div></div>';
                document.body.appendChild(anim);
                setTimeout(() => {
                    anim.style.opacity = '0';
                    anim.style.transform = 'translate(-50%,-70%)';
                    setTimeout(() => {anim.remove();}, 300);
                }, 2000);
            };
            
            function loadCardsList(category) {
                fetch('/api/shop', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: user?.id, category: 'cards'})
                })
                .then(res => res.json())
                .then(shopData => {
                    console.log('Cards shop data:', shopData);
                    // Store cards data globally for buyShopItem function
                    if (!window.shopData) {
                        window.shopData = {};
                    }
                    window.shopData.items = shopData.items || [];
                    
                    const shopList = document.getElementById('shopCardsList');
                    const cards = shopData.items.filter(item => item.type === 'card' && (category === 'all' || item.income_type === category));
                    console.log('Filtered cards:', cards, 'category:', category);
                    console.log('Updating shopList for category:', category);
                    console.log('Cards data sample:', cards.slice(0, 2).map(c => ({
                        id: c.id,
                        name: c.name,
                        level: c.level,
                        price: c.price,
                        income: c.income,
                        income_per_min: c.income_per_min,
                        income_type: c.income_type
                    })));
                    console.log('All cards for category', category, ':', cards.map(c => ({
                        id: c.id,
                        level: c.level,
                        price: c.price,
                        income_per_min: c.income_per_min
                    })));
                    if(cards && cards.length > 0) {
                        shopList.innerHTML = cards.map((card, i) => {
                        // Skip locked cards
                        // Remove locking - all cards are available
                        const rarity = card.rarity || 'common';
                        const rarityInfo = {
                            'common': {emoji:'òÚê', name:'¦Þ¦-TËTÇ¦-¦-TÏ', color:'rgba(255,255,255,0.15)', border:'rgba(255,255,255,0.4)'},
                            'rare': {emoji:'¨ßÔ¦', name:'¦à¦¦¦+¦¦¦-TÏ', color:'rgba(102,126,234,0.25)', border:'rgba(102,126,234,0.8)'},
                            'epic': {emoji:'¨ßßã', name:'¦í¦¬¦¬TÇ¦¦TÁ¦¦¦-TÏ', color:'rgba(118,75,162,0.25)', border:'rgba(118,75,162,0.8)'},
                            'legendary': {emoji:'¨ßßá', name:'¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-¦-TÏ', color:'rgba(234,179,8,0.25)', border:'rgba(234,179,8,0.8)'}
                        };
                        const info = rarityInfo[rarity];
                        const income = card.income_type === 'per_minute' ? (card.income_per_min || 0) : (card.income || 0);
                        const incomeType = card.income_type === 'per_minute' ? '/¦-¦¬¦-' : '/TÇ¦-TÁ';
                        const level = card.level || 1;
                        const nameParts = card.name || '¦Ú¦-TÀTÂ¦-TÇ¦¦¦-';
                        const cardEmoji = nameParts.match(/[\u{1F600}-\u{1F9FF}]/u)?.[0] || '¨ßÒ¦';
                        const cardName = nameParts.replace(/[\u{1F600}-\u{1F9FF}]/u, '').trim();
                        return `
                            <div style="background:${info.color};padding:12px;border-radius:12px;border:2px solid ${info.border};">
                                <div style="font-size:24px;text-align:center;margin-bottom:6px;">${cardEmoji}</div>
                                <div style="font-size:10px;font-weight:700;color:#fff;text-align:center;margin-bottom:6px;">${cardName}</div>
                                <div style="font-size:11px;color:#94a3b8;text-align:center;margin-bottom:6px;">${card.description}</div>
                                <div style="font-size:12px;color:#10b981;text-align:center;margin-bottom:6px;font-weight:700;">+${income.toFixed(1)} ¨ßêÙ${incomeType}</div>
                                <div style="font-size:9px;color:#fbbf24;text-align:center;margin-bottom:8px;font-weight:600;">Lv.${level} ${info.name}</div>
                                <button onclick="buyShopItem('card', ${card.level || 1}, ${card.price || 0}, '${card.id}')" style="width:100%;padding:8px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:11px;">
                                    ¨ßêÙ ${(card.price || 0).toLocaleString()}
                                </button>
                            </div>
                        `;
                    }).join('');
                    } else {
                        shopList.innerHTML = '<div style="grid-column:span 2;text-align:center;padding:20px;color:#94a3b8;background:rgba(255,255,255,0.05);border-radius:12px;">¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬ ¦-TÀ¦¦¦-¦¦¦-¦-¦- ¦-¦¦¦+¦-TÁTÂTÃ¦¬¦-TË</div>';
                    }
                });
            }
            
            // Load per_hour cards by default
            loadCardsList('per_hour');
            
            // Update passive income immediately
            updatePassiveIncome();
        }
        
        // VIP Cards Modal - defined globally
        window.openVIPCardsModal = function() {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.style.zIndex = '10000';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 500px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;border: 2px solid rgba(255,215,0,0.4);box-shadow: 0 20px 60px rgba(255,215,0,0.3);">
                    <div style="background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700); padding: 30px 60px 30px 30px; border-radius: 22px 22px 0 0; text-align: center; position: relative; box-shadow: 0 8px 30px rgba(255,215,0,0.4);">
                        <div style="display: flex; align-items: center; justify-content: center; gap: 15px;">
                            <div style="font-size: 45px; text-shadow: 0 3px 10px rgba(0,0,0,0.3); filter: drop-shadow(0 0 8px rgba(255,215,0,0.8)); animation: pulse 2s infinite;">òíÐ</div>
                            <div>
                                <h2 style="font-size: 28px; color: #000; margin: 0; font-weight: 900; text-shadow: 0 2px 6px rgba(0,0,0,0.2);">VIP ¦Ú¦Ð¦à¦â¦Þ¦ç¦Ú¦Ø</h2>
                                <div style="font-size: 15px; color: rgba(0,0,0,0.7); margin-top: 6px; font-weight: 600;">¨ßÒÎ ¦í¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-TË¦¦ ¦¬¦-TÁTÁ¦¬¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+</div>
                            </div>
                        </div>
                        <button class="close-btn" onclick="this.closest('.modal').remove()" style="color: #000;">òÜÕ</button>
                    </div>
                    
                    <div style="padding: 25px;">
                        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;margin-bottom:25px;">
                            <button id="vipCardsBtnHour" onclick="loadVIPCardsCategory('per_hour')" style="padding:14px;background:linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,237,78,0.15));color:#fff;border:2px solid #ffd700;border-radius:12px;cursor:pointer;font-weight:800;font-size:14px;transition:all 0.3s;">
                                òÚá ¦Ò TÇ¦-TÁ
                            </button>
                            <button id="vipCardsBtnMin" onclick="loadVIPCardsCategory('per_minute')" style="padding:14px;background:rgba(255,255,255,0.05);color:#fff;border:2px solid rgba(167,139,250,0.3);border-radius:12px;cursor:pointer;font-weight:800;font-size:14px;transition:all 0.3s;">
                                ¨ßÒÎ ¦Ò ¦-¦¬¦-TÃTÂTÃ
                            </button>
                        </div>
                        
                        <div id="vipCardsContent" style="display:grid;grid-template-columns:repeat(2,1fr);gap:15px;"></div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            loadVIPCardsCategory('per_hour');
            
            // Update passive income after modal is opened
            setTimeout(() => {
                if (typeof updatePassiveIncome === 'function') {
                    updatePassiveIncome();
                }
            }, 100);
        };
        
        window.loadVIPCardsCategory = function(category) {
            document.getElementById('vipCardsBtnHour').style.background = category === 'per_hour' ? 'linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,237,78,0.15))' : 'rgba(255,255,255,0.05)';
            document.getElementById('vipCardsBtnHour').style.border = category === 'per_hour' ? '2px solid #ffd700' : '2px solid rgba(255,215,0,0.2)';
            document.getElementById('vipCardsBtnMin').style.background = category === 'per_minute' ? 'linear-gradient(135deg,rgba(139,92,246,0.15),rgba(167,139,250,0.15))' : 'rgba(255,255,255,0.05)';
            document.getElementById('vipCardsBtnMin').style.border = category === 'per_minute' ? '2px solid #8b5cf6' : '2px solid rgba(167,139,250,0.2)';
            window.showVIPCardsList(category);
        };
        
        window.showVIPCardsList = function(category = 'per_hour') {
            const vipCardsContent = document.getElementById('vipCardsContent');
            const vipCardsSection = document.getElementById('vipCardsSection');
            const targetElement = vipCardsContent || vipCardsSection;
            if (!targetElement) return;
            
            // VIP Card definitions
            const vipCardsPerHour = [
                {name: 'VIP Silver', emoji: 'òíÐ', basePrice: 100, baseIncome: 5000, rarity: 'vip_silver', productId: 51},
                {name: 'VIP Gold', emoji: '¨ßÒÎ', basePrice: 250, baseIncome: 15000, rarity: 'vip_gold', productId: 52},
                {name: 'VIP Platinum', emoji: '¨ßÑÑ', basePrice: 500, baseIncome: 35000, rarity: 'vip_platinum', productId: 53},
                {name: 'VIP Diamond', emoji: '¨ßÒÍ', basePrice: 1000, baseIncome: 100000, rarity: 'vip_diamond', productId: 54},
                {name: 'VIP Elite', emoji: '¨ßÌß', basePrice: 2500, baseIncome: 300000, rarity: 'vip_elite', productId: 55},
                {name: 'VIP Ultimate', emoji: 'òÚá', basePrice: 5000, baseIncome: 750000, rarity: 'vip_ultimate', productId: 56}
            ];
            
            const vipCardsPerMinute = [
                {name: 'VIP Nova', emoji: 'òÜè', basePrice: 500, baseIncome: 300, rarity: 'vip_nova', productId: 61},
                {name: 'VIP Quantum', emoji: 'òÚá', basePrice: 1250, baseIncome: 900, rarity: 'vip_quantum', productId: 62},
                {name: 'VIP Cosmic', emoji: '¨ßÔå', basePrice: 2500, baseIncome: 2000, rarity: 'vip_cosmic', productId: 63},
                {name: 'VIP Stellar', emoji: '¨ßÎÆ', basePrice: 5000, baseIncome: 5000, rarity: 'vip_stellar', productId: 64},
                {name: 'VIP Galaxy', emoji: '¨ßÌÌ', basePrice: 10000, baseIncome: 15000, rarity: 'vip_galaxy', productId: 65},
                {name: 'VIP Infinity', emoji: '¨ßÌà', basePrice: 20000, baseIncome: 40000, rarity: 'vip_infinity', productId: 66}
            ];
            
            const cards = category === 'per_hour' ? vipCardsPerHour : vipCardsPerMinute;
            let html = '';
            
            cards.forEach((card, index) => {
                const level = 1;
                const price = category === 'per_hour' 
                    ? Math.floor(card.basePrice * Math.pow(1.2, level - 1))
                    : Math.floor(card.basePrice * Math.pow(1.3, level - 1));
                const income = category === 'per_hour'
                    ? Math.floor(card.baseIncome * Math.pow(1.15, level - 1))
                    : Math.floor(card.baseIncome * Math.pow(1.2, level - 1));
                const incomeText = category === 'per_hour' ? `+${income.toLocaleString()} ¨ßêÙ/TÇ¦-TÁ` : `+${income.toLocaleString()} ¨ßêÙ/¦-¦¬¦-`;
                const isHour = category === 'per_hour';
                const borderColor = isHour ? '#ffd700' : '#8b5cf6';
                const bgGradient = isHour ? 'linear-gradient(135deg,rgba(255,215,0,0.25),rgba(255,237,78,0.25))' : 'linear-gradient(135deg,rgba(139,92,246,0.25),rgba(167,139,250,0.25))';
                const badgeBg = isHour ? '#ffd700' : '#8b5cf6';
                const badgeColor = isHour ? '#000' : '#fff';
                const buttonGradient = isHour ? 'linear-gradient(135deg,#ffd700,#ffed4e,#ffd700)' : 'linear-gradient(135deg,#8b5cf6,#a78bfa,#8b5cf6)';
                const buttonColor = isHour ? '#000' : '#fff';
                const incomeColor = isHour ? '#4ade80' : '#a78bfa';
                
                html += `
                    <div style="background:${bgGradient};padding:16px;border-radius:16px;border:3px solid ${borderColor};position:relative;box-shadow:0 8px 25px rgba(0,0,0,0.3);transition:all 0.3s;" onmouseover="this.style.transform='translateY(-3px)'; this.style.boxShadow='0 12px 35px rgba(0,0,0,0.4)'" onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 8px 25px rgba(0,0,0,0.3)'">
                        <div style="position:absolute;top:8px;right:8px;background:${badgeBg};color:${badgeColor};padding:3px 8px;border-radius:6px;font-size:9px;font-weight:900;box-shadow:0 2px 8px rgba(0,0,0,0.3);">VIP</div>
                        <div style="font-size:28px;text-align:center;margin-bottom:8px;filter:drop-shadow(0 4px 8px rgba(0,0,0,0.3));">${card.emoji}</div>
                        <div style="font-weight:900;font-size:14px;color:#fff;text-align:center;margin-bottom:4px;text-shadow:0 2px 4px rgba(0,0,0,0.5);">${card.name}</div>
                        <div style="font-size:10px;color:#94a3b8;text-align:center;margin-bottom:8px;font-weight:600;">¦ãTÀ¦-¦-¦¦¦-TÌ ${level}</div>
                        <div style="font-size:13px;color:${incomeColor};font-weight:900;text-align:center;margin-bottom:12px;text-shadow:0 0 10px ${incomeColor}40;">${incomeText}</div>
                        <button onclick="buyVIPCardWithStars('${card.rarity}', ${price}, ${card.productId})" 
                                style="width:100%;padding:11px;background:${buttonGradient};color:${buttonColor};border:none;border-radius:10px;cursor:pointer;font-weight:900;font-size:12px;box-shadow:0 4px 15px rgba(0,0,0,0.3);transition:all 0.3s;display:flex;align-items:center;justify-content:center;gap:6px;"
                                onmousedown="this.style.transform='scale(0.96)'" 
                                onmouseup="this.style.transform='scale(1)'" 
                                onmouseleave="this.style.transform='scale(1)'">
                            <span>¦ÚTÃ¦¬¦¬TÂTÌ ¦¬¦-</span>
                            <span style="font-size:14px;filter:drop-shadow(0 0 3px rgba(255,215,0,0.8));">òíÐ</span>
                            <span>${price}</span>
                        </button>
                    </div>
                `;
            });
            
            targetElement.innerHTML = html;
        };
        
        function updatePassiveIncome() {
            fetch('/api/cards', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                // Update passive info display with rounded whole numbers
                const totalPassive = Math.round(data.total_passive_per_hour || 0);
                const passiveInfo = document.getElementById('passiveInfo');
                if(passiveInfo && passiveInfo.querySelector('div:last-child')) {
                    passiveInfo.querySelector('div:last-child').textContent = `+${totalPassive.toLocaleString()} ¨ßêÙ/TÇ¦-TÁ`;
                }
            })
            .catch(err => console.error('Error updating passive income:', err));
        }
        
        // Update passive income every second when cards modal is open
        let passiveIncomeInterval = null;
        document.addEventListener('click', function(e) {
            if(e.target.textContent && e.target.textContent.includes('¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬')) {
                if(!passiveIncomeInterval) {
                    updatePassiveIncome();
                    passiveIncomeInterval = setInterval(updatePassiveIncome, 1000);
                }
            }
        });
        function openStats(e) {
            e.preventDefault();
            document.getElementById('statsModal').classList.add('active');
            fetch('/api/stats', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const statsHtml = `
                    <div class="stats-row">
                        <span class="stats-label">¨ßÑÆ ¦ÒTÁ¦¦¦¦¦- TÂ¦-¦¬¦-¦-</span>
                        <span class="stats-value">${data.total_taps || 0}</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">¨ßÒ- ¦×¦-TÀ¦-¦-¦-TÂ¦-¦-¦-</span>
                        <span class="stats-value">${Math.floor(data.total_earned || 0)} ¨ßêÙ</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">¨ßÒÎ ¦Ô¦-¦-TËTÂ¦-</span>
                        <span class="stats-value">${Math.floor(data.total_mined || 0)} òÚá</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">¨ßÒ- ¦Ñ¦-¦¬¦-¦-TÁ</span>
                        <span class="stats-value">${Math.floor(data.coins || 0)} ¨ßêÙ</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">¨ßÒÎ QuanHash</span>
                        <span class="stats-value">${Math.floor(data.quanhash || 0)} òÚá</span>
                    </div>
                `;
                document.getElementById('statsContent').innerHTML = statsHtml;
            });
        }

        // Generate all 165 achievements dynamically
        function generateAllAchievements(data) {
            const achievements = [];
            
            // Taps (20 achievements)
            const tapsList = [[1,'¨ßÑÆ'],[10,'¨ßÎï'],[50,'òÚá'],[100,'¨ßÔå'],[500,'¨ßÒë'],[1000,'¨ßÌÊ'],[5000,'¨ßÚÀ'],[10000,'¨ßÒå'],[25000,'òÚá'],[50000,'¨ßÔå'],[100000,'¨ßÑÑ'],[250000,'¨ßÒÀ'],[500000,'¨ßØÈ'],[1000000,'òÈÞ'],[2500000,'¨ßÌÌ'],[5000000,'¨ßÌÀ'],[10000000,'¨ßÒë'],[25000000,'òíÐ'],[50000000,'òÜè'],[100000000,'¨ßÌß']];
            const tapsTitlesRu = ['¦ß¦¦TÀ¦-TË¦¦ TÂ¦-¦¬','¦Ý¦-¦-¦¬TÇ¦-¦¦','¦Ð¦¦TÂ¦¬¦-¦¬TÁTÂ','¦Ü¦-TÁTÂ¦¦TÀ','¦í¦¦TÁ¦¬¦¦TÀTÂ','¦ßTÀ¦-TÄ¦¬','¦Ò¦¦TÂ¦¦TÀ¦-¦-','¦Û¦¦¦¦¦¦¦-¦+¦-','¦ÓTÃTÀTÃ','¦â¦¬TÂ¦-¦-','¦Ñ¦-¦¦','¦Ô¦¦¦-¦-¦-','¦Ð¦-TÁ¦-¦¬TÎTÂ','¦Ñ¦¦TÁ¦¦¦-¦-¦¦TÇ¦-¦-TÁTÂTÌ','¦ÒTÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦ÜTÃ¦¬TÌTÂ¦¬¦-TÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦Ú¦-TÁ¦-¦-TÁ','¦×¦-¦¦¦¬¦+¦-','¦áTÃ¦¬¦¦TÀ','¦Ü¦Ð¦Ú¦á¦Ø¦Ü¦ã¦Ü'];
            tapsList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`taps_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + tapsTitlesRu[idx],
                    desc: `¦á¦+¦¦¦¬¦-¦¦TÂ¦¦ ${thresh} TÂ¦-¦¬¦-¦-`,
                    unlocked: data.total_taps >= thresh,
                    category: 'taps', color: '#60a5fa'
                });
            });
            
            // Coins (20 achievements)
            const coinsList = [[1000000,'¨ßÒ-'],[2500000,'¨ßÒ¬'],[5000000,'¨ßÒ¦'],[10000000,'¨ßÒÎ'],[25000000,'¨ßÏÆ'],[50000000,'¨ßÑÑ'],[100000000,'òíÐ'],[250000000,'¨ßÌß'],[500000000,'òÜè'],[1000000000,'¨ßÒë'],[2500000000,'¨ßÔå'],[5000000000,'òÚá'],[10000000000,'¨ßÌÌ'],[25000000000,'¨ßÌÀ'],[50000000000,'òíÐ'],[100000000000,'òÜè'],[250000000000,'¨ßÒë'],[500000000000,'¨ßÌß'],[1000000000000,'¨ßÔå'],[10000000000000,'¨ßÑÑ']];
            const coinsTitlesRu = ['¦Ü¦¬¦¬¦¬¦¬¦-¦-¦¦TÀ','¦Ñ¦-TÀ¦-¦-','¦â¦¬TÀ¦-¦-','¦Ü¦-¦¦¦-¦-TÂ','¦Ú¦-TÀ¦-¦¬TÌ','¦Þ¦¬¦¬¦¦¦-TÀTÅ','¦Ø¦-¦¬¦¦TÀ¦¬TÏ','¦ä¦¦¦+¦¦TÀ¦-TÆ¦¬TÏ','¦Ú¦-¦-¦¦¦¬¦-¦-¦¦TÀ¦-TÂ','¦Ó¦-¦¬¦-¦¦TÂ¦¬¦¦¦-','¦Ú¦-TÁ¦-¦-TÁ','¦Ñ¦¦TÁ¦¦¦-¦-¦¦TÇ¦-¦-TÁTÂTÌ','¦ÒTÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦ÜTÃ¦¬TÌTÂ¦¬¦-TÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦áTÃ¦¬¦¦TÀ','¦Ó¦¬¦¬¦¦TÀ','¦ã¦¬TÌTÂTÀ¦-','¦Ü¦¦TÂ¦-','¦âTÀ¦-¦-TÁ','¦Ò¦á¦Õ¦Û¦Õ¦Ý¦Ý¦Ð¦ï'];
            coinsList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`coins_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + coinsTitlesRu[idx],
                    desc: `¦×¦-TÀ¦-¦-¦-TÂ¦-¦¦TÂ¦¦ ${thresh/1000000}M ¦¦¦-¦¬¦-¦-¦-`,
                    unlocked: data.total_earned >= thresh,
                    category: 'coins', color: '#fbbf24'
                });
            });
            
            // Cards (15 achievements)
            const cardsList = [[1,'¨ßÃÏ'],[5,'¨ßÎ+'],[10,'¨ßÃÏ'],[25,'¨ßÎ+'],[50,'¨ßÃÏ'],[100,'¨ßÎ+'],[150,'¨ßÃÏ'],[250,'¨ßÎ+'],[350,'¨ßÃÏ'],[500,'¨ßÎ+'],[750,'¨ßÃÏ'],[1000,'¨ßÎ+'],[1500,'¨ßÃÏ'],[2500,'¨ßÎ+'],[5000,'¨ßÃÏ']];
            const cardsTitlesRu = ['¦ß¦¦TÀ¦-¦-TÏ ¦¦¦-TÀTÂ¦-','¦Ú¦-¦¬¦¬¦¦¦¦TÆ¦¬¦-¦-¦¦TÀ','¦Ú¦-¦¬¦¬¦¦¦¦TÆ¦¬¦-¦-¦¦TÀ+','¦Ü¦-TÁTÂ¦¦TÀ','¦Ü¦-TÁTÂ¦¦TÀ ¦¦¦-TÀTÂ','¦Û¦¦¦¦¦¦¦-¦+¦-','¦Ü¦¬TÄ¦¬TÇ¦¦TÁ¦¦¦¬¦¦','¦Ñ¦-¦¦ ¦¦¦-TÀTÂ','¦Ñ¦-¦¦¦¦TÁTÂ¦-¦¦¦-¦-TË¦¦','¦Ú¦-TÁ¦-¦-TÁ','¦ÒTÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦ÜTÃ¦¬TÌTÂ¦¬¦-TÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦Ñ¦¦TÁ¦¦¦-¦-¦¦TÇ¦-¦-TÁTÂTÌ','¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦','¦Ú¦Þ¦á¦Ü¦Ø¦ç¦Õ¦á¦Ú¦Ø¦Ù'];
            cardsList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`cards_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + cardsTitlesRu[idx],
                    desc: `¦ÚTÃ¦¬¦¬TÂ¦¦ ${thresh} ¦¦¦-TÀTÂ`,
                    unlocked: (data.cards && data.cards.length >= thresh),
                    category: 'cards', color: '#8b5cf6'
                });
            });
            
            // Mining (15 achievements)
            const miningList = [[1,'òÛÏÿ¬Ï'],[5,'¨ßÏí'],[10,'¨ßÏ×ÿ¬Ï'],[25,'òÚÙÿ¬Ï'],[50,'¨ßÏí'],[100,'¨ßÏ×ÿ¬Ï'],[150,'òÚÙÿ¬Ï'],[250,'¨ßÏí'],[350,'¨ßÏ×ÿ¬Ï'],[500,'òÚÙÿ¬Ï'],[750,'¨ßÏí'],[1000,'¨ßÏ×ÿ¬Ï'],[1500,'òÚÙÿ¬Ï'],[2500,'¨ßÏí'],[5000,'¨ßÏ×ÿ¬Ï']];
            const miningTitlesRu = ['¦ß¦¦TÀ¦-¦-TÏ ¦-¦-TÈ¦¬¦-¦-','¦æ¦¦TÅ','¦ä¦-¦-TÀ¦¬¦¦¦-','¦×¦-¦-¦-¦+','¦Ü¦¦¦¦¦-TÄ¦-¦-TÀ¦¬¦¦¦-','¦Ú¦-TÀ¦¬¦-TÀ¦-TÆ¦¬TÏ','¦Ú¦-¦-¦¦¦¬¦-¦-¦¦TÀ¦-TÂ','¦Ð¦¬TÌTÏ¦-TÁ','¦Ø¦-¦¬¦¦TÀ¦¬TÏ','¦Ú¦-TÁ¦-¦-TÁ','¦ÒTÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦ÜTÃ¦¬TÌTÂ¦¬¦-TÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦Ñ¦¦TÁ¦¦¦-¦-¦¦TÇ¦-¦-TÁTÂTÌ','¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦','¦Ú¦Þ¦á¦Ü¦Ø¦ç¦Õ¦á¦Ú¦Ø¦Ù'];
            miningList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`mining_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + miningTitlesRu[idx],
                    desc: `¦ÚTÃ¦¬¦¬TÂ¦¦ ${thresh} ¦-¦-TÈ¦¬¦-`,
                    unlocked: (data.machines && data.machines.length >= thresh),
                    category: 'mining', color: '#10b981'
                });
            });
            
            // Levels (15 achievements)
            const levelsList = [[5,'¨ßÌß'],[10,'òíÐ'],[15,'òÜè'],[20,'¨ßÒë'],[25,'¨ßÌß'],[30,'òíÐ'],[35,'òÜè'],[40,'¨ßÒë'],[50,'¨ßÌß'],[60,'òíÐ'],[70,'òÜè'],[80,'¨ßÒë'],[90,'¨ßÌß'],[95,'òíÐ'],[100,'¨ßÒë']];
            const levelsTitlesRu = ['¦ãTÀ¦-¦-¦¦¦-TÌ 5','¦ãTÀ¦-¦-¦¦¦-TÌ 10','¦ãTÀ¦-¦-¦¦¦-TÌ 15','¦ãTÀ¦-¦-¦¦¦-TÌ 20','¦ãTÀ¦-¦-¦¦¦-TÌ 25','¦ãTÀ¦-¦-¦¦¦-TÌ 30','¦ãTÀ¦-¦-¦¦¦-TÌ 35','¦ãTÀ¦-¦-¦¦¦-TÌ 40','¦ãTÀ¦-¦-¦¦¦-TÌ 50','¦ãTÀ¦-¦-¦¦¦-TÌ 60','¦ãTÀ¦-¦-¦¦¦-TÌ 70','¦ãTÀ¦-¦-¦¦¦-TÌ 80','¦ãTÀ¦-¦-¦¦¦-TÌ 90','¦ãTÀ¦-¦-¦¦¦-TÌ 95','¦Ü¦Ð¦Ú¦á¦Ø¦Ü¦ã¦Ü'];
            levelsList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`level_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + levelsTitlesRu[idx],
                    desc: `¦Ô¦-TÁTÂ¦¬¦¦¦-¦¬TÂ¦¦ ${thresh} TÃTÀ¦-¦-¦-TÏ`,
                    unlocked: data.level >= thresh,
                    category: 'level', color: '#a78bfa'
                });
            });
            
            // VIP (15 achievements)
            const vipList = [[1,'¨ßåÉ'],[2,'¨ßåÈ'],[3,'¨ßåÇ'],[4,'¨ßÒÎ'],[5,'¨ßÑÑ'],[6,'òíÐ'],[7,'òÜè'],[8,'¨ßÒë'],[9,'¨ßÌß'],[10,'¨ßÔå'],[11,'òÚá'],[12,'¨ßÌÌ'],[13,'¨ßÌÀ'],[14,'òíÐ'],[15,'¨ßÑÑ']];
            const vipTitlesRu = ['VIP ¦ÑTÀ¦-¦-¦¬¦-','VIP ¦á¦¦TÀ¦¦¦-TÀ¦-','VIP ¦×¦-¦¬¦-TÂ¦-','VIP ¦ß¦¬¦-TÂ¦¬¦-¦-','VIP ¦Ô¦Ø¦Ð¦Ü¦Þ¦Ý¦Ô','VIP ¦×¦Ò¦Õ¦×¦Ô¦Ð','VIP ¦Ú¦Þ¦á¦Ü¦Þ¦á','VIP ¦Ò¦á¦Õ¦Û¦Õ¦Ý¦Ý¦Ð¦ï','VIP ¦Ü¦ã¦Û¦ì¦â¦Ø','VIP ¦Ñ¦Þ¦Ó','VIP ¦Ð¦Ñ¦á¦Þ¦Û¦î¦â','VIP ¦Ó¦Ð¦Û¦Ð¦Ú¦â¦Ø¦Ú¦Ð','VIP ¦Ú¦Þ¦á¦Ü¦Þ¦á','VIP ¦ã¦Û¦ì¦â¦à¦Ð','VIP ¦Ò¦á¦Õ¦Û¦Õ¦Ý¦Ý¦Ð¦ï'];
            vipList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`vip_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + vipTitlesRu[idx],
                    desc: `VIP TÃTÀ¦-¦-¦¦¦-TÌ ${thresh}`,
                    unlocked: (data.vip_level || 0) >= thresh,
                    category: 'vip', color: '#ffd700'
                });
            });
            
            // Social (15 achievements)
            const socialList = [[1,'¨ßÑå'],[5,'¨ßÑë'],[10,'¨ßÌÐ'],[15,'¨ßÑì'],[25,'¨ßÑí'],[50,'¨ßäÝ'],[75,'¨ßÙÌ'],[100,'¨ßÑÍ'],[150,'¨ßäÝ'],[250,'¨ßÙÏ'],[500,'¨ßÑÑ'],[1000,'¨ßÌß'],[2500,'òÜè'],[5000,'¨ßÒë'],[10000,'¨ßÔå']];
            const socialTitlesRu = ['¦ß¦¦TÀ¦-TË¦¦ ¦+TÀTÃ¦¦','¦Ü¦-¦¦','¦Ü¦-TÁTÂ¦¦TÀ','¦Û¦¬¦+¦¦TÀ','¦Ú¦-¦¬¦¬TÂ¦-¦-','¦Û¦¦¦¦¦¦¦-¦+¦-','¦ßTÀ¦-TÄ¦¬','¦ÓTÃTÀTÃ','¦â¦¬TÂ¦-¦-','¦Ñ¦-¦¦','¦Ú¦-TÁ¦-¦-TÁ','¦ÒTÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦ÜTÃ¦¬TÌTÂ¦¬¦-TÁ¦¦¦¬¦¦¦-¦-¦-TÏ','¦Ñ¦¦TÁ¦¦¦-¦-¦¦TÇ¦-¦-TÁTÂTÌ','¦Ò¦á¦Õ¦Û¦Õ¦Ý¦Ý¦Ð¦ï'];
            socialList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`social_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + socialTitlesRu[idx],
                    desc: `¦ßTÀ¦¬¦¦¦¬¦-TÁ¦¬TÂ¦¦ ${thresh} ¦+TÀTÃ¦¬¦¦¦¦`,
                    unlocked: (data.referrals_count || 0) >= thresh,
                    category: 'social', color: '#ec4899'
                });
            });
            
            // Energy (10 achievements)
            const energyList = [[10,'òÚá'],[50,'¨ßÔË'],[100,'òÚá'],[500,'¨ßÔË'],[1000,'òÚá'],[2500,'¨ßÔË'],[5000,'òÚá'],[10000,'¨ßÔË'],[25000,'òÚá'],[50000,'¨ßÔË']];
            const energyTitlesRu = ['¦í¦-¦¦TÀ¦¦¦¬TÏ 10','¦í¦-¦¦TÀ¦¦¦¬TÏ 50','¦í¦-¦¦TÀ¦¦¦¬TÏ 100','¦í¦-¦¦TÀ¦¦¦¬TÏ 500','¦í¦-¦¦TÀ¦¦¦¬TÏ 1000','¦í¦-¦¦TÀ¦¦¦¬TÏ 2500','¦í¦-¦¦TÀ¦¦¦¬TÏ 5000','¦í¦-¦¦TÀ¦¦¦¬TÏ 10K','¦í¦-¦¦TÀ¦¦¦¬TÏ 25K','¦í¦-¦¦TÀ¦¦¦¬TÏ 50K'];
            energyList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`energy_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + energyTitlesRu[idx],
                    desc: `¦Ý¦-¦¦¦-¦¬¦¬¦¬¦-¦-¦¦TÂ¦¦ ${thresh} TÍ¦-¦¦TÀ¦¦¦¬¦¬`,
                    unlocked: false, // Placeholder - energy tracking not implemented yet
                    category: 'energy', color: '#f59e0b'
                });
            });
            
            // Shop (10 achievements)
            const shopList = [[1,'¨ßÛÍÿ¬Ï'],[10,'¨ßÒ¦'],[25,'¨ßÛÒ'],[50,'¨ßÛÍÿ¬Ï'],[100,'¨ßÒ¦'],[250,'¨ßÛÒ'],[500,'¨ßÛÍÿ¬Ï'],[1000,'¨ßÒ¦'],[2500,'¨ßÛÒ'],[5000,'¨ßÛÍÿ¬Ï']];
            const shopTitlesRu = ['¦ß¦¦TÀ¦-¦-TÏ ¦¬¦-¦¦TÃ¦¬¦¦¦-','¦ß¦-¦¦TÃ¦¬¦-TÂ¦¦¦¬TÌ','¦è¦-¦¬¦¦TÀ','¦ß¦-¦¦TÃ¦¬¦-TÂ¦¦¦¬TÌ+','¦Ü¦-TÁTÂ¦¦TÀ','¦í¦¦TÁ¦¬¦¦TÀTÂ','¦ßTÀ¦-TÄ¦¬','¦Û¦¦¦¦¦¦¦-¦+¦-','¦Ñ¦-¦¦','¦Ú¦Þ¦á¦Ü¦Þ¦á'];
            shopList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`shop_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + shopTitlesRu[idx],
                    desc: `¦á¦+¦¦¦¬¦-¦¦TÂ¦¦ ${thresh} ¦¬¦-¦¦TÃ¦¬¦-¦¦`,
                    unlocked: false, // Placeholder - shop purchase tracking not implemented yet
                    category: 'shop', color: '#6366f1'
                });
            });
            
            // QuanHash (10 achievements)
            const quanhashList = [[100,'¨ßÒÎ'],[1000,'¨ßÒà'],[10000,'¨ßÒÎ'],[100000,'¨ßÒà'],[1000000,'¨ßÒÎ'],[10000000,'¨ßÒà'],[100000000,'¨ßÒÎ'],[1000000000,'¨ßÒà'],[10000000000,'¨ßÒÎ'],[100000000000,'¨ßÒà']];
            const quanhashTitlesRu = ['100 QuanHash','1K QuanHash','10K QuanHash','100K QuanHash','1M QuanHash','10M QuanHash','100M QuanHash','1B QuanHash','10B QuanHash','100B QuanHash'];
            quanhashList.forEach(([thresh, icon], idx) => {
                const display = thresh >= 1000 ? thresh/1000 + 'K' : thresh;
                achievements.push({
                    id:`quanhash_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + quanhashTitlesRu[idx],
                    desc: `¦Ô¦-¦-TËTÂTÌ ${display} QuanHash`,
                    unlocked: (data.quanhash || 0) >= thresh,
                    category: 'quanhash', color: '#a855f7'
                });
            });
            
            // Time (10 achievements)
            const timeList = [[1,'¨ßÓÅ'],[7,'¨ßÓÆ'],[30,'¨ß×Óÿ¬Ï'],[60,'¨ßÓÅ'],[100,'¨ßÓÆ'],[180,'¨ß×Óÿ¬Ï'],[365,'¨ßÓÅ'],[730,'¨ßÓÆ'],[1095,'¨ß×Óÿ¬Ï'],[1825,'¨ßÓÅ']];
            const timeTitlesRu = ['1 ¦+¦¦¦-TÌ','1 ¦-¦¦¦+¦¦¦¬TÏ','1 ¦-¦¦TÁTÏTÆ','2 ¦-¦¦TÁTÏTÆ¦-','100 ¦+¦-¦¦¦¦','6 ¦-¦¦TÁTÏTÆ¦¦¦-','1 ¦¦¦-¦+','2 ¦¦¦-¦+¦-','3 ¦¦¦-¦+¦-','5 ¦¬¦¦TÂ'];
            timeList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`time_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + timeTitlesRu[idx],
                    desc: `¦Ø¦¦TÀ¦-¦¦TÂ¦¦ ${thresh} ¦+¦-¦¦¦¦`,
                    unlocked: false, // Placeholder - time tracking not implemented yet
                    category: 'time', color: '#06b6d4'
                });
            });
            
            // Premium (10 achievements)
            const premiumList = [[1,'¨ßÎÁ'],[5,'¨ßÎÉ'],[10,'¨ßÎÁ'],[25,'¨ßÎÉ'],[50,'¨ßÎÁ'],[100,'¨ßÎÉ'],[250,'¨ßÎÁ'],[500,'¨ßÎÉ'],[1000,'¨ßÎÁ'],[2500,'¨ßÎÉ']];
            const premiumTitlesRu = ['¦ß¦¦TÀ¦-TË¦¦ ¦-¦-¦-TÃTÁ','¦Ñ¦-¦-TÃTÁ x5','¦Ñ¦-¦-TÃTÁ x10','¦Ñ¦-¦-TÃTÁ x25','¦Ñ¦-¦-TÃTÁ x50','¦Ñ¦-¦-TÃTÁ x100','¦Ñ¦-¦-TÃTÁ x250','¦Ñ¦-¦-TÃTÁ x500','¦Ñ¦-¦-TÃTÁ x1K','¦Ñ¦-¦-TÃTÁ x2.5K'];
            premiumList.forEach(([thresh, icon], idx) => {
                achievements.push({
                    id:`premium_${thresh}`, threshold:thresh, icon:icon,
                    title: icon + ' ' + premiumTitlesRu[idx],
                    desc: `¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ ${thresh} ¦-¦-¦-TÃTÁ¦-¦-`,
                    unlocked: false, // Placeholder - premium tracking not implemented yet
                    category: 'premium', color: '#ef4444'
                });
            });
            
            return achievements;
        }
        
        function openAchievements() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.style.zIndex = '10000';
                
                const achievements = generateAllAchievements(data);
                
                const unlockedCount = achievements.filter(a => a.unlocked).length;
                const totalCount = achievements.length;
                const progress = (unlockedCount / totalCount * 100).toFixed(0);
                
                // Group achievements by category
                const categories = {
                    taps: {icon:'¨ßÑÆ', title:'¦â¦-¦¬TË', color:'#60a5fa'},
                    coins: {icon:'¨ßÒ-', title:'¦Ô¦-TÅ¦-¦+', color:'#fbbf24'},
                    cards: {icon:'¨ßÃÏ', title:'¦Ú¦-TÀTÂTË', color:'#8b5cf6'},
                    mining: {icon:'òÛÏÿ¬Ï', title:'¦Ü¦-¦¦¦-¦¬¦-¦¦', color:'#10b981'},
                    level: {icon:'¨ßÌß', title:'¦ãTÀ¦-¦-¦-¦¬', color:'#a78bfa'},
                    vip: {icon:'¨ßÑÑ', title:'VIP', color:'#ffd700'},
                    social: {icon:'¨ßÑå', title:'¦á¦-TÆ¦¬¦-¦¬TÌ¦-¦-¦¦', color:'#ec4899'},
                    energy: {icon:'òÚá', title:'¦í¦-¦¦TÀ¦¦¦¬TÏ', color:'#f59e0b'},
                    shop: {icon:'¨ßÛÍÿ¬Ï', title:'¦Ü¦-¦¦¦-¦¬¦¬¦-', color:'#6366f1'},
                    quanhash: {icon:'¨ßÒÎ', title:'QuanHash', color:'#a855f7'},
                    time: {icon:'¨ßÓÅ', title:'¦ÒTÀ¦¦¦-TÏ', color:'#06b6d4'},
                    premium: {icon:'¨ßÎÁ', title:'¦ßTÀ¦¦¦-¦¬TÃ¦-', color:'#ef4444'}
                };
                
                const grouped = {};
                achievements.forEach(ach => {
                    if(!grouped[ach.category]) grouped[ach.category] = [];
                    grouped[ach.category].push(ach);
                });
                
                modal.innerHTML = `
                    <div class="modal-content" style="max-width:500px;max-height:85vh;overflow-y:auto;background:linear-gradient(135deg,rgba(10,14,39,0.98),rgba(15,23,42,0.98));border-radius:24px;border:2px solid rgba(167,139,250,0.4);box-shadow:0 10px 40px rgba(167,139,250,0.3);">
                        <div style="background:linear-gradient(135deg,#667eea,#764ba2);padding:24px;border-radius:22px 22px 0 0;text-align:center;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:12px;">
                                <h2 style="font-size:24px;color:#fff;margin:0;font-weight:900;">¨ßÏÆ ¦Ô¦Þ¦á¦â¦Ø¦Ö¦Õ¦Ý¦Ø¦ï</h2>
                                <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                            </div>
                            <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:12px;color:#fff;">
                                <div style="font-size:14px;font-weight:700;margin-bottom:8px;">¦ßTÀ¦-¦¦TÀ¦¦TÁTÁ: ${unlockedCount}/${totalCount}</div>
                                <div style="background:rgba(255,255,255,0.2);height:10px;border-radius:10px;overflow:hidden;">
                                    <div style="width:${progress}%;height:100%;background:linear-gradient(90deg,#10b981,#4ade80);transition:width 0.5s;box-shadow:0 0 10px rgba(16,185,129,0.6);"></div>
                                </div>
                                <div style="font-size:11px;margin-top:8px;opacity:0.9;">${progress}% ¦¬¦-¦-¦¦TÀTÈ¦¦¦-¦-</div>
                            </div>
                        </div>
                        <div style="padding:20px;">
                            ${Object.keys(grouped).map(catKey => {
                                const cat = categories[catKey];
                                const catAchievements = grouped[catKey];
                                const unlockedInCat = catAchievements.filter(a => a.unlocked).length;
                                const totalInCat = catAchievements.length;
                                const catProgress = (unlockedInCat / totalInCat * 100).toFixed(0);
                                
                                return `
                                    <div style="margin-bottom:20px;background:linear-gradient(135deg,${cat.color}15,${cat.color}05);border:2px solid ${cat.color}40;border-radius:16px;overflow:hidden;">
                                        <div style="background:linear-gradient(135deg,${cat.color},${cat.color}cc);padding:12px 16px;display:flex;align-items:center;justify-content:space-between;">
                                            <div style="display:flex;align-items:center;gap:10px;">
                                                <span style="font-size:24px;">${cat.icon}</span>
                                                <span style="font-size:16px;font-weight:800;color:#fff;">${cat.title}</span>
                                            </div>
                                            <span style="font-size:13px;font-weight:700;color:#fff;background:rgba(0,0,0,0.2);padding:4px 10px;border-radius:8px;">${unlockedInCat}/${totalInCat}</span>
                                        </div>
                                        <div style="padding:12px;">
                                            ${catAchievements.map(ach => `
                                                <div style="margin-bottom:10px;background:${ach.unlocked ? `linear-gradient(135deg,${ach.color}20,${ach.color}05)` : 'rgba(0,0,0,0.3)'};padding:14px;border-radius:12px;border:2px solid ${ach.unlocked ? `${ach.color}50` : 'rgba(255,255,255,0.1)'};transition:all 0.3s;position:relative;overflow:hidden;">
                                                    ${ach.unlocked ? `<div style="position:absolute;top:0;left:0;right:0;height:2px;background:linear-gradient(90deg,${ach.color},transparent);"></div>` : ''}
                                                    <div style="display:flex;align-items:center;gap:14px;">
                                                        <div style="font-size:36px;filter:${ach.unlocked ? 'none' : 'grayscale(100%) opacity(0.4)'};transform:${ach.unlocked ? 'scale(1)' : 'scale(0.9)'};transition:all 0.3s;">${ach.icon}</div>
                                                        <div style="flex:1;">
                                                            <div style="font-size:15px;font-weight:800;color:${ach.unlocked ? '#fff' : '#94a3b8'};margin-bottom:5px;display:flex;align-items:center;gap:6px;">
                                                                ${ach.title}
                                                                ${ach.unlocked ? '<span style="font-size:12px;color:#86efac;">òÜè</span>' : ''}
                                                            </div>
                                                            <div style="font-size:12px;color:${ach.unlocked ? '#86efac' : '#64748b'};font-weight:500;">${ach.desc}</div>
                                                        </div>
                                                        ${ach.unlocked ? `
                                                            <div style="font-size:28px;animation:pulse 2s ease-in-out infinite;">òÜÅ</div>
                                                        ` : `
                                                            <div style="font-size:28px;opacity:0.2;">¨ßÔÒ</div>
                                                        `}
                                                    </div>
                                                </div>
                                            `).join('')}
                                        </div>
                                    </div>
                                `;
                            }).join('')}
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                modal.onclick = (e) => {if(e.target === modal) modal.remove();};
            });
        }
        
        function openSettingsModal() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.style.zIndex = '10000';
                
                // Get saved settings from localStorage or use defaults (disabled by default)
                const savedSound = localStorage.getItem('soundEnabled') === 'true';
                const savedHaptics = localStorage.getItem('hapticsEnabled') === 'true';
                const savedNotifications = localStorage.getItem('notificationsEnabled') === 'true';
                const savedUsername = localStorage.getItem('username') || data.username || data.first_name || '¦Ø¦¦TÀ¦-¦¦';
                
                modal.innerHTML = `
                    <div class="modal-content" style="max-width:450px;max-height:85vh;overflow-y:auto;background:linear-gradient(135deg,rgba(10,14,39,0.98),rgba(15,23,42,0.98));border-radius:24px;border:2px solid rgba(75,85,99,0.4);box-shadow:0 10px 40px rgba(75,85,99,0.3);">
                        <div style="background:linear-gradient(135deg,#4b5563,#374151);padding:24px;border-radius:22px 22px 0 0;text-align:center;">
                            <div style="display:flex;justify-content:space-between;align-items:center;">
                                <h2 style="font-size:24px;color:#fff;margin:0;font-weight:900;">òÚÙÿ¬Ï ¦Ý¦Ð¦á¦â¦à¦Þ¦Ù¦Ú¦Ø</h2>
                                <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                            </div>
                        </div>
                        <div style="padding:20px;">
                            <div style="margin-bottom:20px;">
                                <div style="font-size:15px;font-weight:700;color:#fff;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,0.1);">¨ßÑä ¦ß¦à¦Þ¦ä¦Ø¦Û¦ì</div>
                                <div style="background:rgba(0,0,0,0.2);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.1);">
                                    <div style="font-size:12px;color:#94a3b8;margin-bottom:6px;">¦Ø¦-TÏ ¦¬¦-¦¬TÌ¦¬¦-¦-¦-TÂ¦¦¦¬TÏ</div>
                                    <input type="text" id="usernameInput" value="${savedUsername}" style="width:100%;padding:10px;background:rgba(255,255,255,0.05);border:1px solid rgba(102,126,234,0.3);border-radius:8px;color:#fff;font-size:14px;outline:none;transition:all 0.3s;" 
                                           onfocus="this.style.borderColor='#667eea';this.style.background='rgba(102,126,234,0.1)';" 
                                           onblur="this.style.borderColor='rgba(102,126,234,0.3)';this.style.background='rgba(255,255,255,0.05)';">
                                </div>
                            </div>
                            
                            <div style="margin-bottom:20px;">
                                <div style="font-size:15px;font-weight:700;color:#fff;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,0.1);">¨ßÔÊ ¦×¦Ò¦ã¦Ú ¦Ø ¦Ò¦Ø¦Ñ¦à¦Ð¦æ¦Ø¦ï</div>
                                
                                <div style="background:rgba(0,0,0,0.2);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.1);margin-bottom:10px;">
                                    <div style="display:flex;justify-content:space-between;align-items:center;">
                                        <div style="display:flex;align-items:center;gap:10px;">
                                            <span style="font-size:24px;">¨ßÔÊ</span>
                                            <div>
                                                <div style="font-size:13px;font-weight:700;color:#fff;">¦×¦-TÃ¦¦¦¬</div>
                                                <div style="font-size:11px;color:#94a3b8;">¦Ò¦¦¦¬TÎTÇ¦¬TÂTÌ ¦¬¦-TÃ¦¦¦-¦-TË¦¦ TÍTÄTÄ¦¦¦¦TÂTË</div>
                                            </div>
                                        </div>
                                        <label style="position:relative;display:inline-block;width:50px;height:28px;">
                                            <input type="checkbox" id="soundToggle" ${savedSound ? 'checked' : ''} onchange="console.log('Sound toggle changed:', this.checked); localStorage.setItem('soundEnabled', this.checked); updateToggleVisual(this);" style="opacity:0;width:0;height:0;">
                                            <span class="toggle-track" style="position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:${savedSound ? '#667eea' : '#4b5563'};border-radius:34px;transition:all 0.3s;">
                                                <span style="position:absolute;content:'';height:22px;width:22px;left:3px;bottom:3px;background-color:#fff;border-radius:50%;transition:all 0.3s;transform:translateX(${savedSound ? '22px' : '0'});"></span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div style="background:rgba(0,0,0,0.2);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.1);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;">
                                        <div style="display:flex;align-items:center;gap:10px;">
                                            <span style="font-size:24px;">¨ßÓ¦</span>
                                            <div>
                                                <div style="font-size:13px;font-weight:700;color:#fff;">¦Ò¦¬¦-TÀ¦-TÆ¦¬TÏ</div>
                                                <div style="font-size:11px;color:#94a3b8;">¦â¦-¦¦TÂ¦¬¦¬TÌ¦-¦-TÏ ¦-¦-TÀ¦-TÂ¦-¦-TÏ TÁ¦-TÏ¦¬TÌ</div>
                                            </div>
                                        </div>
                                        <label style="position:relative;display:inline-block;width:50px;height:28px;">
                                            <input type="checkbox" id="hapticsToggle" ${savedHaptics ? 'checked' : ''} onchange="localStorage.setItem('hapticsEnabled', this.checked); updateToggleVisual(this);" style="opacity:0;width:0;height:0;">
                                            <span class="toggle-track" style="position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:${savedHaptics ? '#667eea' : '#4b5563'};border-radius:34px;transition:all 0.3s;">
                                                <span style="position:absolute;content:'';height:22px;width:22px;left:3px;bottom:3px;background-color:#fff;border-radius:50%;transition:all 0.3s;transform:translateX(${savedHaptics ? '22px' : '0'});"></span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            <div style="margin-bottom:20px;">
                                <div style="font-size:15px;font-weight:700;color:#fff;margin-bottom:12px;padding-bottom:8px;border-bottom:1px solid rgba(255,255,255,0.1);">¨ßÔÔ ¦ã¦Ò¦Õ¦Ô¦Þ¦Ü¦Û¦Õ¦Ý¦Ø¦ï</div>
                                
                                <div style="background:rgba(0,0,0,0.2);padding:14px;border-radius:12px;border:1px solid rgba(255,255,255,0.1);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;">
                                        <div style="display:flex;align-items:center;gap:10px;">
                                            <span style="font-size:24px;">¨ßÔÔ</span>
                                            <div>
                                                <div style="font-size:13px;font-weight:700;color:#fff;">¦ã¦-¦¦¦+¦-¦-¦¬¦¦¦-¦¬TÏ</div>
                                                <div style="font-size:11px;color:#94a3b8;">¦ß¦-¦¬TÃTÇ¦-TÂTÌ push-TÃ¦-¦¦¦+¦-¦-¦¬¦¦¦-¦¬TÏ</div>
                                            </div>
                                        </div>
                                        <label style="position:relative;display:inline-block;width:50px;height:28px;">
                                            <input type="checkbox" id="notificationsToggle" ${savedNotifications ? 'checked' : ''} onchange="localStorage.setItem('notificationsEnabled', this.checked); updateToggleVisual(this);" style="opacity:0;width:0;height:0;">
                                            <span class="toggle-track" style="position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background-color:${savedNotifications ? '#667eea' : '#4b5563'};border-radius:34px;transition:all 0.3s;">
                                                <span style="position:absolute;content:'';height:22px;width:22px;left:3px;bottom:3px;background-color:#fff;border-radius:50%;transition:all 0.3s;transform:translateX(${savedNotifications ? '22px' : '0'});"></span>
                                            </span>
                                        </label>
                                    </div>
                                </div>
                            </div>
                            
                            
                            <button onclick="saveSettings(); this.closest('.modal').remove();" style="width:100%;padding:14px;background:linear-gradient(135deg,#10b981,#059669);border-radius:12px;cursor:pointer;font-weight:800;font-size:15px;color:#fff;margin-bottom:10px;border:none;box-shadow:0 4px 12px rgba(16,185,129,0.3);transition:all 0.3s;" onmouseover="this.style.transform='scale(1.02)';this.style.boxShadow='0 6px 16px rgba(16,185,129,0.4)'" onmouseout="this.style.transform='scale(1)';this.style.boxShadow='0 4px 12px rgba(16,185,129,0.3)'">
                                ¨ßÒ- ¦á¦-TÅTÀ¦-¦-¦¬TÂTÌ ¦-¦-TÁTÂTÀ¦-¦¦¦¦¦¬
                            </button>
                            
                            <button onclick="this.closest('.modal').remove()" style="width:100%;padding:14px;background:linear-gradient(135deg,#64748b,#475569);border-radius:12px;cursor:pointer;font-weight:700;font-size:15px;color:#fff;border:none;">¦ÞTÂ¦-¦¦¦-¦-</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                modal.onclick = (e) => {if(e.target === modal) modal.remove();};
            });
        }
        
        function updateToggleVisual(checkbox) {
            const track = checkbox.parentElement.querySelector('.toggle-track');
            const thumb = track ? track.querySelector('span') : null;
            if (track && thumb) {
                if (checkbox.checked) {
                    track.style.backgroundColor = '#667eea';
                    thumb.style.transform = 'translateX(22px)';
                } else {
                    track.style.backgroundColor = '#4b5563';
                    thumb.style.transform = 'translateX(0)';
                }
            }
        }
        
        function saveSettings() {
            const username = document.getElementById('usernameInput')?.value;
            const soundEnabled = document.getElementById('soundToggle')?.checked;
            const hapticsEnabled = document.getElementById('hapticsToggle')?.checked;
            const notificationsEnabled = document.getElementById('notificationsToggle')?.checked;
            
            console.log('saveSettings - soundEnabled:', soundEnabled, 'hapticsEnabled:', hapticsEnabled);
            
            // Save to localStorage first
            if(username) localStorage.setItem('username', username);
            if(soundEnabled !== undefined) {
                localStorage.setItem('soundEnabled', soundEnabled);
                console.log('Saved soundEnabled to localStorage:', soundEnabled);
            }
            if(hapticsEnabled !== undefined) localStorage.setItem('hapticsEnabled', hapticsEnabled);
            if(notificationsEnabled !== undefined) localStorage.setItem('notificationsEnabled', notificationsEnabled);
            
            // Save username to database
            if(username && window.user?.id) {
                fetch('/api/update_username', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: window.user.id,
                        username: username
                    })
                })
                .then(res => res.json())
                .then(data => {
                    if(!data.success) {
                        console.error('Failed to update username in database:', data.error);
                    } else {
                        // Username updated successfully, update window.user for immediate profile refresh
                        if(window.user) {
                            window.user.username = username;
                            window.user.first_name = username;
                        }
                    }
                })
                .catch(err => {
                    console.error('Error updating username in database:', err);
                });
            }
            
            // Show success message
            tg.showAlert('òÜÅ ¦Ý¦-TÁTÂTÀ¦-¦¦¦¦¦¬ TÁ¦-TÅTÀ¦-¦-¦¦¦-TË!');
            
            // Initialize AudioContext if not already done (for immediate sound feedback)
            initAudio();
            
            // Play success sound if enabled (use the value we just saved)
            console.log('About to play success sound, soundEnabled === true?', soundEnabled === true);
            if (soundEnabled === true) {
                console.log('Playing success sound after settings save');
                // Wait a moment for AudioContext to resume if needed
                setTimeout(() => {
                    playSound('success');
                }, 100);
            } else {
                console.log('Sound not enabled, skipping success sound');
            }
            
            // Trigger haptic feedback if enabled (use the value we just saved)
            if (hapticsEnabled === true && tg?.HapticFeedback) {
                tg.HapticFeedback.notificationOccurred('success');
            }
        }
        
        function openReferrals(e) {
            e.preventDefault();
            document.getElementById('referralsModal').classList.add('active');
            fetch('/api/referrals', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById('refCount').textContent = data.referrals_count || 0;
                document.getElementById('refIncome').textContent = `${Math.floor(data.referral_income || 0)} ¨ßêÙ`;
                // Generate correct referral link using referral_code
                const botUsername = 'qanexus_bot'; // Correct bot username
                const refCode = data.referral_code || user?.id || 'no_code'; // Use referral_code from API
                const refLink = `https://t.me/${botUsername}?start=${refCode}`;
                document.getElementById('refLink').textContent = refLink;
            });
        }

        function copyRefLink() {
            const link = document.getElementById('refLink').textContent;
            navigator.clipboard.writeText(link);
            tg.showAlert('òÜÅ ¦áTÁTË¦¬¦¦¦- TÁ¦¦¦-¦¬¦¬TÀ¦-¦-¦-¦-¦-!');
        }

        function openWithdrawModal(e) {
            if(e && e.preventDefault) e.preventDefault();
            document.getElementById('withdrawModal').classList.add('active');
            
            // Check if user has enough QuanHash
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const quanhash = Math.floor(data.quanhash || 0);
                const hasEnough = quanhash >= 500000;
                const vipLevel = data.vip_level || 0;
                const isVIP = vipLevel >= 3;
                const isDiamond = vipLevel >= 5;
                
                // VIP bonuses
                const feePercent = isDiamond ? 0 : isVIP ? 2 : 5;
                const minWithdraw = isDiamond ? 100000 : isVIP ? 250000 : 500000;
                const withdrawMultiplier = isDiamond ? 2 : isVIP ? 1.5 : 1;
                
                document.getElementById('withdrawContent').innerHTML = `
                    <div style="padding: 15px;">
                        <div style="text-align: center; margin-bottom: 15px;">
                            <div style="font-size: 40px; margin-bottom: 8px;">¨ßÒÎ</div>
                            <div style="font-size: 16px; font-weight: bold;">¦ÒTË¦-¦-¦+ TÁTÀ¦¦¦+TÁTÂ¦-</div>
                            <div style="font-size: 13px; opacity: 0.7; margin-top: 4px;">¦ã ¦-¦-TÁ: ${quanhash.toLocaleString()} ¨ßÒÎ</div>
                            ${isVIP ? `
                            <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:8px 12px;border-radius:8px;margin-top:8px;font-size:12px;font-weight:800;color:#000;border:2px solid #ffd700;">
                                ¨ßÑÑ VIP ¦Ñ¦Þ¦Ý¦ã¦á: ${feePercent === 0 ? '0% ¦¦¦-¦-¦¬TÁTÁ¦¬TÏ!' : feePercent + '% ¦¦¦-¦-¦¬TÁTÁ¦¬TÏ òÀâ x' + withdrawMultiplier + ' ¦¬¦¬¦-¦¬TÂ'}
                            </div>
                            ` : ''}
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); border: 1px solid rgba(102, 126, 234, 0.3); border-radius: 10px; padding: 12px; margin-bottom: 15px;">
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 4px;">¦Þ¦-¦-¦¦¦-</div>
                            <div style="font-size: 16px; font-weight: bold;">500,000 ¨ßÒÎ = $1 USDT</div>
                            ${feePercent === 0 ? `
                            <div style="font-size:12px;color:#ffd700;font-weight:700;margin-top:4px;">òÜè ¦Ý¦Õ¦â ¦Ú¦Þ¦Ü¦Ø¦á¦á¦Ø¦Ø (Diamond VIP)</div>
                            ` : ''}
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="margin-bottom: 6px; font-weight: 500; font-size: 13px;">¦Ú¦-¦¬¦¬TÇ¦¦TÁTÂ¦-¦- QuanHash (¦-¦¬¦-. 500,000):</div>
                            <input type="number" id="quanhashAmount" value="${minWithdraw}" min="${minWithdraw}" step="1000" style="width: 100%; padding: 10px; background: rgba(255,255,255,0.1); border: 1px solid rgba(102, 126, 234, 0.3); border-radius: 10px; color: white; font-size: 14px;" oninput="updateUSDTAmount()">
                            <div id="usdtAmount" style="margin-top: 6px; font-size: 13px; font-weight: bold; color: #10b981;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦: $1.00 USDT</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="margin-bottom: 6px; font-weight: 500; font-size: 13px;">BEP20 ¦-¦+TÀ¦¦TÁ:</div>
                            <input type="text" id="usdtAddress" placeholder="0x0000...0000" style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(102, 126, 234, 0.3); border-radius: 10px; color: white; font-size: 14px; font-weight: 600;">
                        </div>
                        <button id="withdrawBtn" class="action-btn" onclick="withdraw()" style="width: 100%; margin-bottom: 15px; padding: 12px; ${hasEnough ? '' : 'opacity: 0.5; cursor: not-allowed;'}" ${hasEnough ? '' : 'disabled'}>${hasEnough ? '¨ßÒ¬ ¦ÒTË¦-¦¦TÁTÂ¦¬' : 'òÚàÿ¬Ï ¦Ý¦¦TÂ QuanHash'}</button>
                        <div style="border-top: 2px solid rgba(255,255,255,0.1); padding-top: 15px; margin-top: 15px;">
                            <div style="font-size: 15px; font-weight: bold; margin-bottom: 12px; text-align: center;">¨ßÓÜ ¦ØTÁTÂ¦-TÀ¦¬TÏ ¦-TË¦-¦-¦+¦-¦-</div>
                            <div id="withdrawHistory" style="max-height: 120px; overflow-y: auto;"></div>
                        </div>
                    </div>
                `;
                    
                    // Load transaction history
                    loadWithdrawHistory();
            });
        }

        function loadWithdrawHistory() {
            fetch('/api/history', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const historyDiv = document.getElementById('withdrawHistory');
                if(!historyDiv) return;
                
                console.log('Withdrawal history data:', data);
                
                const withdrawals = data.history || [];
                console.log('Withdrawals found:', withdrawals.length);
                
                if(withdrawals.length > 0) {
                    historyDiv.innerHTML = withdrawals.map(w => {
                        const date = new Date(w.date);
                        // Status in Russian from server
                        const statusText = w.status || '¦Ò ¦¬TÀ¦-TÆ¦¦TÁTÁ¦¦';
                        const statusEmoji = statusText === '¦Ò ¦¬TÀ¦-TÆ¦¦TÁTÁ¦¦' ? 'òÏ¦' : statusText === '¦ÒTË¦¬¦¬¦-TÇ¦¦¦-¦-' ? 'òÜÅ' : statusText === '¦ÞTÂ¦¦¦¬¦-¦-¦¦¦-¦-' ? 'òÝÌ' : 'òÏ¦';
                        const statusColor = statusText === '¦Ò ¦¬TÀ¦-TÆ¦¦TÁTÁ¦¦' ? '#f59e0b' : statusText === '¦ÒTË¦¬¦¬¦-TÇ¦¦¦-¦-' ? '#10b981' : statusText === '¦ÞTÂ¦¦¦¬¦-¦-¦¦¦-¦-' ? '#ef4444' : '#94a3b8';
                        return `
                            <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:8px;margin-bottom:8px;">
                                <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
                                    <span style="font-size:12px;font-weight:600;">${statusEmoji} $${Math.floor(w.amount || 0)}</span>
                                    <span style="font-size:11px;opacity:0.7;">${date.toLocaleDateString('ru')}</span>
                                </div>
                                <div style="font-size:10px;opacity:0.6;margin-bottom:5px;">${w.address ? (w.address.substring(0,10) + '...') : ''}</div>
                                <div style="font-size:10px;color:${statusColor};font-weight:600;">${statusText}</div>
                            </div>
                        `;
                    }).join('');
                } else {
                    historyDiv.innerHTML = '<div style="text-align:center;opacity:0.5;font-size:12px;padding:10px;">¦ØTÁTÂ¦-TÀ¦¬TÏ ¦¬TÃTÁTÂ¦-</div>';
                }
            })
            .catch(err => {
                console.error('Error loading history:', err);
                const historyDiv = document.getElementById('withdrawHistory');
                if(historyDiv) {
                    historyDiv.innerHTML = '<div style="text-align:center;opacity:0.5;font-size:12px;padding:10px;">¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÀTÃ¦¬¦¦¦¬</div>';
                }
            });
        }

        function updateUSDTAmount() {
            const amount = parseInt(document.getElementById('quanhashAmount').value) || 500000;
            const usdtAmount = amount / 500000;
            document.getElementById('usdtAmount').textContent = `¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦: $${usdtAmount.toFixed(2)} USDT`;
        }
        
        function withdraw() {
            const address = document.getElementById('usdtAddress').value.trim();
            const amount = parseInt(document.getElementById('quanhashAmount').value) || 500000;
            
            if (!address || !address.match(/^0x[a-fA-F0-9]{40}$/)) {
                tg.showAlert('òÚàÿ¬Ï ¦Ò¦-¦¦¦+¦¬TÂ¦¦ ¦¬TÀ¦-¦-¦¬¦¬TÌ¦-TË¦¦ BEP20 ¦-¦+TÀ¦¦TÁ');
                return;
            }
            
            if (amount < 500000) {
                tg.showAlert('òÚàÿ¬Ï ¦Ü¦¬¦-¦¬¦-TÃ¦- 500,000 QuanHash');
                return;
            }

            fetch('/api/withdraw', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: user?.id, 
                    address: address,
                    amount: amount
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('òÜÅ ¦×¦-¦¬TÀ¦-TÁ ¦-¦- ¦-TË¦-¦-¦+ ¦-TÂ¦¬TÀ¦-¦-¦¬¦¦¦-!');
                    loadData();
                    // Reload withdrawal history after successful request
                    setTimeout(() => {
                        openWithdrawModal({preventDefault: () => {}});
                    }, 500);
                } else {
                    tg.showAlert('òÚàÿ¬Ï ' + data.error);
                }
            });
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        loadData();
        checkOfflineIncome();
        startEnergyRegen();
        startAutoTap();
        updateSupportBadge();
        
        // Create loadUserDataOnly function to update stats without flickering autobot
        function loadUserDataOnly() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                // Update only stats, don't touch autobot button
                const coins = Math.floor(data.coins || 0);
                const quanhash = Math.floor(data.quanhash || 0);
                const energy = parseInt(data.energy || 0);
                const maxEnergy = parseInt(data.max_energy || 1000);
                const passiveCoins = Math.floor(data.passive_coins_per_hour || 0);
                const passiveHash = Math.floor(data.passive_hash_per_hour || 0);
                
                document.getElementById('coins').textContent = coins.toLocaleString();
                document.getElementById('quanhash').textContent = quanhash.toLocaleString();
                document.getElementById('energy-text').textContent = `${energy}/${maxEnergy}`;
                document.getElementById('passiveCoins').textContent = `+${passiveCoins.toLocaleString()}/TÇ¦-TÁ`;
                document.getElementById('passiveHash').textContent = `+${passiveHash.toLocaleString()}/TÇ¦-TÁ`;
                
                const energyPercent = Math.min(100, Math.max(0, (energy / maxEnergy) * 100));
                const fillBar = document.getElementById('energy-bar-fill');
                const percentText = document.getElementById('energy-percent');
                if (fillBar) {
                    fillBar.style.width = energyPercent + '%';
                }
                if (percentText) {
                    percentText.textContent = Math.round(energyPercent) + '%';
                }
            })
            .catch(err => console.error('Error:', err));
        }
        
        // Auto-update data every 2 seconds
        setInterval(() => {
            loadUserDataOnly();
        }, 2000);
        
        // Update support badge every 5 seconds
        setInterval(() => {
            updateSupportBadge();
        }, 5000);
        
        function updateSupportBadge() {
            fetch('/api/user_support', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const answeredTickets = (data.tickets || []).filter(t => t.status === 'answered' && t.answer && !t.is_read).length;
                const badge = document.getElementById('supportBadge');
                if(answeredTickets > 0) {
                    badge.textContent = answeredTickets;
                    badge.style.display = 'inline-block';
                } else {
                    badge.style.display = 'none';
                }
            })
            .catch(() => {});
        }
        
        // Auto-tap function - Constantly running to check status
        function startAutoTap() {
            // Check status every 2 seconds to restart if needed
            setInterval(() => {
                fetch('/api/user_data', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: window.user?.id})
                })
                .then(res => res.json())
                .then(data => {
                    const isEnabled = data.auto_tap_enabled;
                    const hasMinEnergy = data.energy > 10;
                    const autobotExpiresAt = data.auto_tap_expires_at || 0;
                    const isStillValid = autobotExpiresAt > Date.now();
                    
                    // Start or restart auto-tap interval if conditions are met
                    if(isEnabled && hasMinEnergy && isStillValid && !window.autoTapInterval) {
                        const speed = 1000 / (data.auto_tap_speed || 1); // taps per second
                        window.autoTapInterval = setInterval(() => {
                            fetch('/api/user_data', {
                                method: 'POST',
                                headers: {'Content-Type': 'application/json'},
                                body: JSON.stringify({user_id: window.user?.id})
                            })
                            .then(res => res.json())
                            .then(data => {
                                const isEnabled = data.auto_tap_enabled;
                                const hasMinEnergy = data.energy > 10;
                                const autobotExpiresAt = data.auto_tap_expires_at || 0;
                                const isStillValid = autobotExpiresAt > Date.now();
                                
                                if(isEnabled && hasMinEnergy && isStillValid) {
                                    // Perform tap
                                    fetch('/api/tap', {
                                        method: 'POST',
                                        headers: {'Content-Type': 'application/json'},
                                        body: JSON.stringify({user_id: window.user?.id, is_auto: true})
                                    })
                                    .then(res => res.json())
                                    .then(data => {
                                        if(data.success) {
                                            // Show animation for autobot
                                            const hasOpenModal = document.querySelector('.modal.active');
                                            if (!hasOpenModal) {
                                                const button = document.querySelector('.tap-button');
                                                if(button) {
                                                    const rect = button.getBoundingClientRect();
                                                    const centerX = rect.left + rect.width / 2;
                                                    const centerY = rect.top + rect.height / 2;
                                                    
                                                    const coinAnimation = document.createElement('div');
                                                    coinAnimation.className = 'coin-animation';
                                                    coinAnimation.textContent = '+' + data.reward;
                                                    coinAnimation.style.left = centerX + 'px';
                                                    coinAnimation.style.top = centerY + 'px';
                                                    coinAnimation.style.transform = 'translate(-50%, -50%)';
                                                    coinAnimation.style.zIndex = '999';
                                                    document.body.appendChild(coinAnimation);
                                                    setTimeout(() => {
                                                        if(document.body.contains(coinAnimation)) {
                                                            document.body.removeChild(coinAnimation);
                                                        }
                                                    }, 1000);
                                                }
                                                loadUserDataOnly(); // Silent update
                                            } else {
                                                loadUserDataOnly();
                                            }
                                        }
                                    })
                                    .catch(err => console.error('Auto-tap error:', err));
                                } else {
                                    // Stop auto-tap if conditions not met
                                    clearInterval(window.autoTapInterval);
                                    window.autoTapInterval = null;
                                }
                            })
                            .catch(err => console.error('Status check error:', err));
                        }, speed);
                    } else if((!isEnabled || !hasMinEnergy || !isStillValid) && window.autoTapInterval) {
                        // Stop if conditions no longer met
                        clearInterval(window.autoTapInterval);
                        window.autoTapInterval = null;
                    }
                })
                .catch(err => console.error('Auto-tap status error:', err));
            }, 2000); // Check status every 2 seconds
        }
        
        // Support functions
        function openSupport(event) {
            event.preventDefault();
            tg.HapticFeedback.impactOccurred('light');
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'supportModal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h2 style="font-size:20px;color:#fff;font-weight:700;">¨ßÒì ¦ß¦-¦+¦+¦¦TÀ¦¦¦¦¦-</h2>
                        <button class="close-btn" onclick="document.getElementById('supportModal').remove()">òÜÕ</button>
                    </div>
                    
                    <div style="margin-bottom:20px;">
                        <label style="display:block;font-size:13px;font-weight:600;margin-bottom:8px;color:#94a3b8;">¦â¦¦¦-¦- ¦-¦-TÀ¦-TÉ¦¦¦-¦¬TÏ</label>
                        <select id="supportTopic" style="width:100%;padding:14px 16px;background:rgba(0,0,0,0.4);border:2px solid rgba(102,126,234,0.3);border-radius:14px;color:#fff;font-size:14px;outline:none;transition:all 0.3s;">
                            <option value="¦Þ¦-TÉ¦¬¦¦ ¦-¦-¦¬TÀ¦-TÁTË">òÝÓ ¦Þ¦-TÉ¦¬¦¦ ¦-¦-¦¬TÀ¦-TÁTË</option>
                            <option value="¦ßTÀ¦-¦-¦¬¦¦¦-TË TÁ ¦-¦-¦¬¦-¦-TÁ¦-¦-">¨ßÒ¦ ¦ßTÀ¦-¦-¦¬¦¦¦-TË TÁ ¦-¦-¦¬¦-¦-TÁ¦-¦-</option>
                            <option value="¦ÒTË¦-¦-¦+ TÁTÀ¦¦¦+TÁTÂ¦-">¨ßÒ¬ ¦ÒTË¦-¦-¦+ TÁTÀ¦¦¦+TÁTÂ¦-</option>
                            <option value="¦Ü¦-¦¦¦-¦¬¦-¦¦">òÚá ¦Ü¦-¦¦¦-¦¬¦-¦¦</option>
                            <option value="¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬">¨ßÒ¦ ¦Ú¦-TÀTÂ¦-TÇ¦¦¦¬</option>
                            <option value="¦à¦¦TÄ¦¦TÀ¦-¦¬TÌ¦-¦-TÏ ¦¬TÀ¦-¦¦TÀ¦-¦-¦-¦-">¨ßÑå ¦à¦¦TÄ¦¦TÀ¦-¦¬TÌ¦-¦-TÏ ¦¬TÀ¦-¦¦TÀ¦-¦-¦-¦-</option>
                            <option value="¦â¦¦TÅ¦-¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦¬TÀ¦-¦-¦¬¦¦¦-TË">¨ßÔç ¦â¦¦TÅ¦-¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦¬TÀ¦-¦-¦¬¦¦¦-TË</option>
                            <option value="¦ßTÀ¦¦¦+¦¬¦-¦¦¦¦¦-¦¬TÏ">¨ßÒá ¦ßTÀ¦¦¦+¦¬¦-¦¦¦¦¦-¦¬TÏ</option>
                            <option value="¦Ö¦-¦¬¦-¦-TË">òÚàÿ¬Ï ¦Ö¦-¦¬¦-¦-TË</option>
                            <option value="¦ÔTÀTÃ¦¦¦-¦¦">¨ßÓÝ ¦ÔTÀTÃ¦¦¦-¦¦</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom:25px;">
                        <label style="display:block;font-size:13px;font-weight:600;margin-bottom:8px;color:#94a3b8;">¦á¦-¦-¦-TÉ¦¦¦-¦¬¦¦</label>
                        <textarea id="supportMessage" placeholder="¦Þ¦¬¦¬TÈ¦¬TÂ¦¦ ¦¬¦-¦+TÀ¦-¦-¦-¦- ¦-¦-TÈ ¦-¦-¦¬TÀ¦-TÁ ¦¬¦¬¦¬ ¦¬TÀ¦-¦-¦¬¦¦¦-TÃ..." rows="5" style="width:100%;padding:14px 16px;background:rgba(0,0,0,0.4);border:2px solid rgba(102,126,234,0.3);border-radius:14px;color:#fff;font-size:14px;outline:none;transition:all 0.3s;resize:vertical;font-family:inherit;"></textarea>
                    </div>
                    
                    <div style="display:flex;gap:12px;">
                        <button onclick="sendSupport()" style="flex:1;padding:16px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:14px;cursor:pointer;font-weight:700;font-size:15px;box-shadow:0 8px 24px rgba(102,126,234,0.4);transition:all 0.3s;">¨ßÓä ¦ÞTÂ¦¬TÀ¦-¦-¦¬TÂTÌ</button>
                        <button onclick="document.getElementById('supportModal').remove()" style="flex:1;padding:16px;background:rgba(255,255,255,0.1);color:#fff;border:2px solid rgba(255,255,255,0.3);border-radius:14px;cursor:pointer;font-weight:600;font-size:15px;transition:all 0.3s;">¦ÞTÂ¦-¦¦¦-¦-</button>
                    </div>
                    
                    <div style="text-align:center;margin-top:20px;padding-top:20px;border-top:1px solid rgba(255,255,255,0.1);">
                        <p style="font-size:11px;opacity:0.5;">òÏ-ÿ¬Ï ¦áTÀ¦¦¦+¦-¦¦¦¦ ¦-TÀ¦¦¦-TÏ ¦-TÂ¦-¦¦TÂ¦-: 24 TÇ¦-TÁ¦-</p>
                    </div>
                    
                    <button onclick="loadMyTickets()" style="width:100%;margin-top:15px;padding:12px;background:rgba(102,126,234,0.2);color:#667eea;border:1px solid rgba(102,126,234,0.4);border-radius:12px;cursor:pointer;font-weight:600;">¨ßÓË ¦Ü¦-¦¬ ¦-¦-TÀ¦-TÉ¦¦¦-¦¬TÏ</button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Add focus effects
            const topicSelect = document.getElementById('supportTopic');
            const messageText = document.getElementById('supportMessage');
            
            if(topicSelect) {
                topicSelect.addEventListener('focus', () => {
                    topicSelect.style.borderColor = 'rgba(102,126,234,0.8)';
                    topicSelect.style.boxShadow = '0 0 20px rgba(102,126,234,0.3)';
                });
                topicSelect.addEventListener('blur', () => {
                    topicSelect.style.borderColor = 'rgba(102,126,234,0.3)';
                    topicSelect.style.boxShadow = 'none';
                });
            }
            
            if(messageText) {
                messageText.addEventListener('focus', () => {
                    messageText.style.borderColor = 'rgba(102,126,234,0.8)';
                    messageText.style.boxShadow = '0 0 20px rgba(102,126,234,0.3)';
                });
                messageText.addEventListener('blur', () => {
                    messageText.style.borderColor = 'rgba(102,126,234,0.3)';
                    messageText.style.boxShadow = 'none';
                });
            }
        }
        
        function sendSupport() {
            const topicEl = document.querySelector('[id*="supportTopic"]');
            const messageEl = document.querySelector('[id*="supportMessage"]');
            
            if (!topicEl || !messageEl) {
                console.error('Support form elements not found');
                return;
            }
            
            const topic = topicEl.value;
            const message = messageEl.value;
            
            if (!topic) {
                alert('òÚàÿ¬Ï ¦ÒTË¦-¦¦TÀ¦¬TÂ¦¦ TÂ¦¦¦-TÃ');
                return;
            }
            
            if (!message) {
                alert('òÚàÿ¬Ï ¦Ò¦-¦¦¦+¦¬TÂ¦¦ TÁ¦-¦-¦-TÉ¦¦¦-¦¬¦¦');
                return;
            }
            
            fetch('/api/support', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: user?.id,
                    topic: topic,
                    message: message
                })
            })
            .then(res => {
                console.log('Support response status:', res.status);
                return res.json();
            })
            .then(data => {
                console.log('Support response data:', data);
                if (data.success) {
                    alert('òÜÅ ¦á¦-¦-¦-TÉ¦¦¦-¦¬¦¦ ¦-TÂ¦¬TÀ¦-¦-¦¬¦¦¦-¦-!');
                    const modal = document.querySelector('#supportModal') || document.querySelector('.modal.active');
                    if (modal) modal.remove();
                } else {
                    alert('òÝÌ ¦ÞTÈ¦¬¦-¦¦¦-: ' + (data.error || '¦-¦¦¦¬¦¬¦-¦¦TÁTÂ¦-¦-TÏ'));
                }
            })
            .catch(err => {
                console.error('Support send error:', err);
                alert('òÝÌ ¦ÞTÈ¦¬¦-¦¦¦- ¦¬TÀ¦¬ ¦-TÂ¦¬TÀ¦-¦-¦¦¦¦: ' + err.message);
            });
        }
        
        function loadMyTickets() {
            // Hide badge when opening my tickets
            const badge = document.getElementById('supportBadge');
            badge.style.display = 'none';
            
            // Mark all answered tickets as read
            fetch('/api/mark_tickets_read', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            });
            
            fetch('/api/user_support', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                if(data.tickets && data.tickets.length > 0) {
                    const ticketsList = data.tickets.map(t => `
                        <div style="background:rgba(0,0,0,0.3);padding:15px;border-radius:12px;margin-bottom:10px;border-left:4px solid ${t.status === 'answered' ? '#10b981' : '#f59e0b'};">
                            <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:10px;">
                                <div>
                                    <div style="font-weight:700;font-size:14px;color:#fff;margin-bottom:4px;">${t.topic}</div>
                                    <div style="font-size:11px;color:#94a3b8;">${new Date(t.created_at).toLocaleString()}</div>
                                </div>
                                <div style="padding:4px 10px;background:${t.status === 'answered' ? 'rgba(16,185,129,0.2)' : 'rgba(245,158,11,0.2)'};border-radius:8px;font-size:11px;font-weight:700;color:${t.status === 'answered' ? '#10b981' : '#f59e0b'};">
                                    ${t.status === 'answered' ? 'òÜÅ ¦Ó¦-TÂ¦-¦-¦-' : 'òÏ¦ ¦Ò ¦¬TÀ¦-TÆ¦¦TÁTÁ¦¦'}
                                </div>
                            </div>
                            <div style="font-size:12px;color:#fff;margin-bottom:10px;opacity:0.9;">${t.message}</div>
                            ${t.answer ? `<div style="background:rgba(16,185,129,0.15);padding:10px;border-radius:8px;margin-top:10px;border-left:3px solid #10b981;"><div style="font-size:11px;color:#10b981;font-weight:700;margin-bottom:6px;">¨ßÓÝ ¦ÞTÂ¦-¦¦TÂ:</div><div style="font-size:12px;color:#fff;">${t.answer}</div></div>` : ''}
                        </div>
                    `).join('');
                    
                    const modal = document.createElement('div');
                    modal.className = 'modal active';
                    modal.innerHTML = `
                        <div class="modal-content" style="max-width: 400px; max-height: 80vh; overflow-y: auto;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                                <h2 style="font-size: 20px; color: #fff;">¨ßÓË ¦Ü¦-¦¬ ¦-¦-TÀ¦-TÉ¦¦¦-¦¬TÏ</h2>
                                <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                            </div>
                            <div>${ticketsList}</div>
                        </div>
                    `;
                    document.body.appendChild(modal);
                } else {
                    alert('¨ßÓí ¦ã ¦-¦-TÁ ¦¬¦-¦¦¦- ¦-¦¦TÂ ¦-¦-TÀ¦-TÉ¦¦¦-¦¬¦¦');
                }
            })
            .catch(() => alert('òÝÌ ¦ÞTÈ¦¬¦-¦¦¦- ¦¬¦-¦¦TÀTÃ¦¬¦¦¦¬'));
        }
    </script>
    
    <script>
        function openDailyBonus(e) {
            e.preventDefault();
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'dailyBonusModal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px; max-height: 80vh; overflow-y: auto;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h2 style="font-size: 24px; color: #fff;">¨ßÎÁ ¦Õ¦¦¦¦¦+¦-¦¦¦-¦-TË¦¦ ¦¬¦-¦+¦-¦-¦¬TÏ</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                    </div>
                    <div id="dailyTasksList" style="display:flex;flex-direction:column;gap:15px;"></div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Load daily tasks
            fetch('/api/daily_tasks', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const list = document.getElementById('dailyTasksList');
                if(data.tasks && data.tasks.length > 0) {
                    let html = '';
                    
                    // Add VIP tasks section if VIP
                    const checkVIPTasks = () => {
                        fetch('/api/user_data', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({user_id: window.user?.id})
                        })
                        .then(res => res.json())
                        .then(userData => {
                            const vipLevel = userData.vip_level || 0;
                            if (vipLevel >= 3) {
                                list.innerHTML = `
                                    ${vipLevel >= 4 ? `
                                    <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:15px;border-radius:12px;border:3px solid #ffd700;margin-bottom:15px;">
                                        <div style="font-size:16px;font-weight:800;color:#000;margin-bottom:8px;">¨ßÎÉ VIP ¦âTÃTÀ¦-¦¬TÀ</div>
                                        <div style="font-size:12px;color:rgba(0,0,0,0.7);margin-bottom:10px;">¦á¦-TÀ¦¦¦-¦-¦-¦-¦-¦-¦¬¦¦ TÂ¦-¦¬TÌ¦¦¦- ¦+¦¬TÏ VIP! ¦â¦-¦¬-3 ¦¬¦-¦¬TÃTÇ¦-TÎTÂ TÍ¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-TË¦¦ ¦-¦-¦¦TÀ¦-¦+TË.</div>
                                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                            <span style="font-size:13px;color:#000;font-weight:700;">¨ßÏÆ ¦Ý¦-¦¦TÀ¦-¦+TË:</span>
                                            <span style="font-size:13px;color:#000;font-weight:800;">500M ¨ßêÙ</span>
                                        </div>
                                        <button onclick="joinVIPTournament()" style="width:100%;padding:10px;background:#000;color:#ffd700;border:none;border-radius:8px;font-weight:800;cursor:pointer;">¨ßÎï ¦ãTÇ¦-TÁTÂ¦-¦-¦-¦-TÂTÌ</button>
                                    </div>
                                    ` : ''}
                                    ${vipLevel >= 5 ? `
                                    <div style="background:linear-gradient(135deg,#c084fc,#a78bfa);padding:15px;border-radius:12px;border:3px solid #c084fc;margin-bottom:15px;">
                                        <div style="font-size:16px;font-weight:800;color:#fff;margin-bottom:8px;">¨ßÒÎ Diamond Challenge</div>
                                        <div style="font-size:12px;color:rgba(255,255,255,0.8);margin-bottom:10px;">¦í¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-TË¦¦ TÇ¦¦¦¬¦¬¦¦¦-¦+¦¦ ¦+¦¬TÏ Diamond VIP!</div>
                                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                            <span style="font-size:13px;color:#fff;font-weight:700;">¨ßÒÎ ¦Ñ¦-¦-TÃTÁ:</span>
                                            <span style="font-size:13px;color:#fff;font-weight:800;">x50 ¦-¦- 24TÇ</span>
                                        </div>
                                        <button onclick="activateDiamondChallenge()" style="width:100%;padding:10px;background:#fff;color:#a78bfa;border:none;border-radius:8px;font-weight:800;cursor:pointer;">òÚá ¦Ð¦¦TÂ¦¬¦-¦¬TÀ¦-¦-¦-TÂTÌ</button>
                                    </div>
                                    ` : ''}
                                    ` + list.innerHTML;
                            }
                        });
                    };
                    checkVIPTasks();
                    
                    html += data.tasks.map(task => `
                        <div style="background:rgba(0,0,0,0.3);padding:15px;border-radius:12px;border:2px solid ${task.completed ? 'rgba(74,222,128,0.5)' : 'rgba(102,126,234,0.5)'};">
                            <div style="font-size:18px;font-weight:700;margin-bottom:8px;">${task.emoji} ${task.name}</div>
                            <div style="font-size:12px;color:#94a3b8;margin-bottom:8px;">${task.description}</div>
                            <div style="display:flex;justify-content:space-between;align-items:center;">
                                <div style="font-size:14px;color:${task.completed ? '#4ade80' : '#f093fb'};">${task.completed ? 'òÜÅ ¦ÒTË¦¬¦-¦¬¦-¦¦¦-¦-' : '¦ßTÀ¦-¦¦TÀ¦¦TÁTÁ: ' + task.progress + '/' + task.target}</div>
                                <div style="font-size:16px;font-weight:700;">¨ßÒ- +${task.reward}</div>
                            </div>
                            ${task.completed ? '<button onclick="claimReward(' + task.id + ')" style="width:100%;margin-top:10px;padding:10px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:10px;cursor:pointer;font-weight:600;">¨ßÎÁ ¦×¦-¦-TÀ¦-TÂTÌ ¦-¦-¦¦TÀ¦-¦+TÃ</button>' : ''}
                        </div>
                    `).join('');
                    list.innerHTML = html;
                } else {
                    list.innerHTML = '<p style="text-align:center;opacity:0.7;padding:20px;">¦×¦-¦+¦-¦-¦¬TÏ ¦¬¦-¦¦TÀTÃ¦¦¦-TÎTÂTÁTÏ...</p>';
                }
            });
        }
        
        function joinVIPTournament() {
            tg.showAlert('¨ßÎÉ ¦ÒTË ¦¬TÀ¦¬TÁ¦-¦¦¦+¦¬¦-¦¬¦¬¦¬TÁTÌ ¦¦ VIP ¦âTÃTÀ¦-¦¬TÀTÃ! ¦áTÀ¦-¦¬¦¬TÂ¦¦TÁTÌ ¦¬¦- TÂ¦-¦¬-3 ¦-¦¦TÁTÂ¦-!');
        }
        
        function activateDiamondChallenge() {
            tg.showAlert('òÚá Diamond Challenge ¦-¦¦TÂ¦¬¦-¦¬TÀ¦-¦-¦-¦-! ¦ß¦-¦¬TÃTÇ¦-¦¦TÂ¦¦ x50 ¦-¦-¦-TÃTÁ ¦¦ ¦+¦-TÅ¦-¦+¦-¦- ¦-¦- 24 TÇ¦-TÁ¦-!');
        }
        function claimReward(taskId) {
            fetch('/api/claim_task', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: user?.id, task_id: taskId})
            })
            .then(res => res.json())
            .then(data => {
                if(data.success) {
                    openDailyBonus({preventDefault:()=>{}});
                    loadData();
                }
            });
        }
        
        let currentCategory = 'all';
        
        window.openBuyCurrency = function(e) {
            try {
                e.preventDefault();
            } catch(err) {}
            try {
                tg.HapticFeedback.impactOccurred('light');
            } catch(err) {}
            
            // Debug: Create simple modal
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'buyCurrencyModal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 420px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.95), rgba(15, 23, 42, 0.95));border-radius: 20px;">
                    <!-- Simple Header -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h2 style="font-size: 20px; color: #fff; margin: 0; font-weight: 700;">òíÐ ¦ÚTÃ¦¬¦¬TÂTÌ ¦-¦-¦¬TÎTÂTÃ</h2>
                        <button class="close-btn" onclick="this.closest('.modal').remove()">òÜÕ</button>
                    </div>
                    
                    <!-- Category Buttons -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px;">
                        <button onclick="filterCategory('starter')" class="category-btn active" style="background: rgba(102,126,234,0.3); border: 2px solid rgba(102,126,234,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">¨ßÎï ¦áTÂ¦-TÀTÂ</button>
                        <button onclick="filterCategory('premium')" class="category-btn" style="background: rgba(234,179,8,0.3); border: 2px solid rgba(234,179,8,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">¨ßÚÀ ¦ßTÀ¦¦¦-¦¬TÃ¦-</button>
                        <button onclick="filterCategory('vip')" class="category-btn" style="background: rgba(255,215,0,0.3); border: 2px solid rgba(255,215,0,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">òíÐ ¦ßTÀ¦¦¦-¦¬TÃ¦-</button>
                        <button onclick="filterCategory('limited')" class="category-btn" style="background: rgba(255,0,0,0.3); border: 2px solid rgba(255,0,0,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">¨ßÔî QuanHash</button>
                        <button onclick="filterCategory('ultra')" class="category-btn" style="background: rgba(128,0,128,0.3); border: 2px solid rgba(128,0,128,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">¨ßÎÁ ¦Ú¦-¦-¦-¦-</button>
                        <button onclick="filterCategory('mega')" class="category-btn" style="background: rgba(255,215,0,0.3); border: 2px solid rgba(255,215,0,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">¨ßÑÑ VIP TÄTÃ¦-¦¦TÆ¦¬¦¬</button>
                    </div>
                    
                    <div id="currencyProductsList" style="display:flex;flex-direction:column;gap:8px;max-height:60vh;overflow-y:auto;padding-right:5px;">
                        <div data-category="starter" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">¨ßÎï ¦á¦â¦Ð¦à¦â¦Þ¦Ò¦ë¦Õ ¦Ý¦Ð¦Ñ¦Þ¦à¦ë</div>

                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÌß</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒë ¦ß¦¦TÀ¦-TË¦¦ TÈ¦-¦¦¦¬</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 200,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ TÁTÂ¦-TÀTÂ¦- ¦¬¦¦TÀTË</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦ÞTÂ¦¬¦¬TÇ¦-¦-¦¦ ¦-¦-TÇ¦-¦¬¦- ¦¬¦¦TÀTË</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_1')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 50 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òÜè</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">òÜè ¦Ñ¦-¦¬¦-¦-TË¦¦ TÁTÂ¦-TÀTÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-TËTÁTÂTÀ¦-¦¦¦- TÀ¦-TÁTÂ¦-</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦ÑTËTÁTÂTÀTË¦¦ TÁTÂ¦-TÀTÂ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_2')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 120 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òíÐ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÌß ¦Ý¦-TÇ¦-¦¬¦- ¦¬TÃTÂ¦¬</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 800,000 ¦¦¦-¦¬¦-¦-¦- TÇTÂ¦-¦-TË ¦-¦-TÇ¦-TÂTÌ ¦¬TÀ¦-¦¦TÀ¦¦TÁTÁ¦¬TÎ</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦â¦-TÑTÀ¦+TË¦¦ TÄTÃ¦-¦+¦-¦-¦¦¦-TÂ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_3')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 180 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ ¦ßTÀ¦¬¦-¦¦TÂTÁTÂ¦-¦¦¦-¦-TË¦¦</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 1,000,000 ¦¦¦-¦¬¦-¦-¦- - ¦-¦¦¦¬¦¬¦¦¦-¦¬¦¦¦¬¦-TË¦¦ TÁTÂ¦-TÀTÂ</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ VIP ¦¬TÀ¦¬¦-¦¦TÂTÁTÂ¦-¦¬¦¦</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_4')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 240 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÎÁ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÎÁ ¦Ô¦-¦-TÀ¦- ¦¬¦-¦¦¦-¦¬¦-¦-¦-TÂTÌ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 1,500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-¦-TÉ¦-¦-¦¦¦- TÁTÂ¦-TÀTÂ¦-</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-¦-TÏ ¦-TË¦¦¦-¦+¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_5')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 320 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒ-</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒ- ¦áTÂ¦-TÀTÂ¦-¦-TË¦¦ ¦¬¦-¦¦¦¦TÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 2,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ TÁ¦¦TÀTÌTÑ¦¬¦-¦-¦¦ ¦¬¦¦TÀTË</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦á¦¦TÀTÌTÑ¦¬¦-TË¦¦ TÁTÂ¦-TÀTÂ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_6')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 400 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òÚá</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">òÚá ¦ÑTËTÁTÂTÀTË¦¦ TÁTÂ¦-TÀTÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 2,500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-¦-¦¬¦-¦¬¦¦¦-¦-TÁ¦-¦-¦¦¦- TÀ¦-TÁTÂ¦-</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-¦-TÏ TÁ¦¦¦-TÀ¦-TÁTÂTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_7')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 480 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÎï</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÎï ¦ß¦¦TÀ¦-TË¦¦ TÈ¦-¦¦</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 3,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ TÃ¦-¦¦TÀ¦¦¦-¦-¦-¦¦¦- ¦-¦-TÇ¦-¦¬¦-</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦â¦-TÇ¦-¦-¦¦ ¦¬¦-¦¬¦-¦+¦-¦-¦¬¦¦</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_8')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 560 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÌÈ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÌÈ ¦à¦-¦+TÃ¦¦¦-TË¦¦ ¦-¦-¦-¦-TÀ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 3,500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ TÏTÀ¦¦¦-¦¦¦- TÁTÂ¦-TÀTÂ¦-</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦à¦-¦¬¦-¦-TÆ¦-¦¦TÂ¦-TË¦¦ ¦-¦-¦¬¦-¦-¦¦¦-¦-TÁTÂ¦¬</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_9')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 640 òíÐ</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒë ¦Ò¦-¦¬TÈ¦¦¦-¦-TË¦¦ TÁTÂ¦-TÀTÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 4,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-¦-¦¦¦¬TÇ¦¦TÁ¦¦¦-¦¦¦- ¦-¦-TÇ¦-¦¬¦-</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">òÜÅ ¦Ò¦-¦¬TÈ¦¦¦-¦-¦-TÏ TÁ¦¬¦¬¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_10')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 720 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">¨ßÚÀ ¦ß¦à¦Õ¦Ü¦Ø¦ã¦Ü ¦Ý¦Ð¦Ñ¦Þ¦à¦ë</div>

                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òÚá</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">òÚá ¦á¦-¦¦TÂ¦-¦-¦-¦¦ ¦¬¦-¦¦¦¦TÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 1,500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ TÏTÀ¦¦¦-¦¦¦- ¦¬TÀ¦-¦¦TÀ¦¦TÁTÁ¦-</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦á¦-¦¦TÂ¦-¦-¦-TÏ TÁ¦¦¦-TÀ¦-TÁTÂTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_11')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 300 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÎï</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÎï ¦ßTÀ¦-TÄ¦¦TÁTÁ¦¬¦-¦-¦-¦¬</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 3,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦¬TÀ¦-TÄ¦¦TÁTÁ¦¬¦-¦-¦-¦¬TÌ¦-¦-¦¦ ¦¬¦¦TÀTË</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦â¦-TÇ¦-¦-TÁTÂTÌ ¦-¦-TÁTÂ¦¦TÀ¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_12')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 600 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÚÀ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÚÀ ¦Ü¦-TÉ¦-TË¦¦ ¦-¦-¦-¦-TÀ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 4,500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-¦-TÉ¦-¦-¦¦¦- TÀTË¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦à¦-¦¦¦¦TÂ¦-TË¦¦ TÁTÂ¦-TÀTÂ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_13')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 900 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ ¦Ð¦¬¦-¦-¦¬¦-TË¦¦ ¦¬¦-¦¦¦¦TÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 6,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-¦¬¦-¦-¦¬¦-¦-¦¦¦- ¦¬TÀ¦-¦¦TÀ¦¦TÁTÁ¦-</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦Ð¦¬¦-¦-¦¬¦-¦-TÏ ¦¬TÀ¦-TÇ¦-¦-TÁTÂTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_14')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 1200 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÔå</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÔå ¦Þ¦¦¦-¦¦¦-¦-TË¦¦ ¦-¦-¦-¦-TÀ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 7,500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-¦¦¦-¦¦¦-¦-¦-¦¦ ¦-¦-TÉ¦¬</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦ßTË¦¬¦-TÎTÉ¦-TÏ TÍ¦-¦¦TÀ¦¦¦¬TÏ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_15')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 1500 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òÚá</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">òÚá ¦í¦¬¦¦¦¦TÂTÀ¦-¦-¦-TË¦¦</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 9,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ TÍ¦¬¦¦¦¦TÂTÀ¦-¦-¦-¦-¦¦¦- ¦-TÃTÁTÂ¦-</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦í¦¬¦¦¦¦TÂTÀ¦¬TÇ¦¦TÁ¦¦¦-TÏ ¦-¦-TÉTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_16')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 1800 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÌß</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÌß ¦×¦-TÑ¦¬¦+¦-TË¦¦ ¦¬¦-¦¦¦¦TÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 10,500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦¬¦-TÑ¦¬¦+¦-¦-¦¦¦- TÃTÀ¦-¦-¦-TÏ</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦×¦-TÑ¦¬¦+¦-¦-TÏ TÁ¦¬¦-¦-¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_17')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 2100 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒë ¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦¬¦¦</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 12,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦¦¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦-¦¦¦- ¦¬TÀ¦-¦¦TÀ¦¦TÁTÁ¦-</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦-TÏ TÁ¦¦¦-TÀ¦-TÁTÂTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_18')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 2400 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÎÁ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÎÁ ¦ß¦-¦+¦-TÀ¦-TÇ¦-TË¦¦ VIP</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 13,500,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ VIP TÁTÂ¦-TÂTÃTÁ¦-</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ VIP ¦¬¦-¦+¦-TÀ¦-¦¦</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_19')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 2700 òíÐ</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÔî</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÔî ¦Ü¦-¦¦¦¬TÇ¦¦TÁ¦¦¦¬¦¦</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 15,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-¦-¦¦¦¬TÇ¦¦TÁ¦¦¦-¦¦¦- TÀ¦-TÁTÂ¦-</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">òÜÅ ¦Ü¦-¦¦¦¬TÇ¦¦TÁ¦¦¦-TÏ TÁ¦¬¦¬¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_20')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 3000 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">òíÐ ¦ß¦à¦Õ¦Ü¦Ø¦ã¦Ü ¦ä¦ã¦Ý¦Ú¦æ¦Ø¦Ø</div>

                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ VIP TÁTÂ¦-TÀTÂ¦-¦-TË¦¦</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 5,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦-¦-TÇ¦-¦¬¦- VIP ¦¬TÃTÂ¦¬</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦áTÂ¦-TÀTÂ¦-¦-TË¦¦ ¦-¦-¦-TÃTÁ ¦-¦¦¦¬TÎTÇTÑ¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_21')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 1000 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÚÀ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÚÀ VIP TÃTÁ¦¦¦-TÀ¦¦¦-¦¬¦¦</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 8,000,000 ¦¦¦-¦¬¦-¦-¦- + ¦¬TÀ¦¬¦-TÀ¦¬TÂ¦¦TÂ¦-¦-TÏ ¦-¦-TÀ¦-¦-¦-TÂ¦¦¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦ãTÁ¦¦¦-TÀ¦¦¦-¦-¦-¦¦ ¦-¦-TÇ¦¬TÁ¦¬¦¦¦-¦¬¦¦</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_22')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 1600 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÑÑ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÑÑ VIP TÁTÂ¦-TÂTÃTÁ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 12,000,000 ¦¦¦-¦¬¦-¦-¦- + TÍ¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-TË¦¦ ¦-¦-¦-TÃTÁ</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦ÞTÄ¦¬TÆ¦¬¦-¦¬TÌ¦-TË¦¦ VIP TÁTÂ¦-TÂTÃTÁ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_23')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 2400 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òÚá</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">òÚá VIP TÂTÃTÀ¦-¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 16,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ TÂTÃTÀ¦-¦- TÃTÁ¦¦¦-TÀ¦¦¦-¦¬TÏ</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦âTÃTÀ¦-¦- TÀ¦¦¦¦¦¬¦- ¦-¦¦TÂ¦¬¦-¦¦¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_24')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 3200 òíÐ</button>
                        </div>
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ VIP ¦¦¦-TÀ¦-¦¬¦¦¦-TÁTÂ¦-¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 20,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦¦¦-TÀ¦-¦¬¦¦¦-TÁ¦¦¦-¦¦¦- TÁTÂ¦-TÂTÃTÁ¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ú¦-TÀ¦-¦¬¦¦¦-TÁ¦¦¦-TÏ ¦¬TÀ¦¬¦-¦¬¦¬¦¦¦¦¦¬TÏ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_25')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 4000 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÔÓ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÔÓ VIP ¦-¦¦¦¬¦¬¦¬¦-¦¬TÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 25,000,000 ¦¦¦-¦¬¦-¦-¦- + ¦-¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦ ¦-¦-¦-TÃTÁ</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ñ¦¦¦¬¦¬¦¬¦-¦¬TÂ¦-TË¦¦ ¦-¦-¦¬¦-¦-¦¦¦-¦-TÁTÂ¦¬</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_26')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 5000 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÏÆ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÏÆ VIP TÇ¦¦¦-¦¬¦¬¦-¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 30,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ TÇ¦¦¦-¦¬¦¬¦-¦-TÁ¦¦¦-¦¦¦- TÁTÂ¦-TÂTÃTÁ¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦ç¦¦¦-¦¬¦¬¦-¦-TÁ¦¦¦¬¦¦ TÃTÀ¦-¦-¦¦¦-TÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_27')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 6000 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÌß</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÌß VIP ¦¬¦¦¦¦¦¦¦-¦+¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 35,000,000 ¦¦¦-¦¬¦-¦-¦- ¦+¦¬TÏ ¦¬¦¦¦¦¦¦¦-¦+¦-TÀ¦-¦-¦¦¦- TÁTÂ¦-TÂTÃTÁ¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-¦-TÏ ¦-¦-TÉTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_28')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 7000 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ VIP ¦-¦¬¦-¦-¦¬</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 40,000,000 ¦¦¦-¦¬¦-¦-¦- + ¦-TÁ¦¦ VIP ¦-¦-¦-TÃTÁTË</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ð¦¬¦-¦-¦¬¦-¦-TÏ ¦¬TÀ¦¬¦-¦¬¦¬¦¦¦¦¦¬TÏ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_29')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 8000 òíÐ</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÑÑ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÑÑ VIP ¦¬¦-¦¬¦¦TÀ¦-TÂ¦-TÀ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 45,000,000 ¦¦¦-¦¬¦-¦-¦- + ¦-¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-TË¦¦ ¦¬TÀ¦¦¦-¦¬TÃ¦- ¦-¦-¦-TÃTÁTË</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ø¦-¦¬¦¦TÀ¦-TÂ¦-TÀTÁ¦¦¦¬¦¦ ¦+¦-TÁTÂTÃ¦¬</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_30')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 9000 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">¨ßÔî QUANHASH ¦Ý¦Ð¦Ñ¦Þ¦à¦ë</div>

                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÔî</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÔî Starter Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 1,000 QuanHash ¦+¦¬TÏ ¦-¦-TÇ¦-¦¬¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦áTÂ¦-TÀTÂ¦-¦-TË¦¦ ¦-¦-¦¦¦-¦¬¦-¦¦</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_31')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 2500 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ Basic Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 5,000 QuanHash ¦+¦¬TÏ ¦-¦-¦¬¦-¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦Ñ¦-¦¬¦-¦-TË¦¦ TÅTÍTÈ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_32')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 3200 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òÚá</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">òÚá Power Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 10,000 QuanHash ¦+¦¬TÏ ¦-¦-TÉ¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦Ü¦-TÉ¦-TË¦¦ TÅTÍTÈ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_33')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 3900 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÔå</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÔå Fire Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 15,000 QuanHash ¦+¦¬TÏ ¦-¦¦¦-¦¦¦-¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦Þ¦¦¦-¦¦¦-¦-¦-TÏ ¦-¦-TÉ¦-¦-TÁTÂTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_34')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 4600 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒå</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒå Blast Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 25,000 QuanHash ¦+¦¬TÏ ¦-¦¬TÀTË¦-¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦Ò¦¬TÀTË¦-¦-¦-¦¦ ¦¬¦-TÂ¦¦¦-TÆ¦¬¦-¦¬</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_35')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 5300 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÌß</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÌß Stellar Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 50,000 QuanHash ¦+¦¬TÏ ¦¬¦-TÑ¦¬¦+¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦×¦-TÑ¦¬¦+¦-¦-TÏ TÁ¦¦¦-TÀ¦-TÁTÂTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_36')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 6000 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ Diamond Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 100,000 QuanHash ¦+¦¬TÏ ¦-¦¬¦-¦-¦¬¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦Ð¦¬¦-¦-¦¬¦-¦-TÏ ¦¬TÀ¦-TÇ¦-¦-TÁTÂTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_37')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 6700 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÚÀ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÚÀ Rocket Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 250,000 QuanHash ¦+¦¬TÏ TÀ¦-¦¦¦¦TÂ¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦à¦-¦¦¦¦TÂ¦-¦-TÏ ¦-¦-TÉTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_38')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 7400 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÑÑ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÑÑ Crown Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 500,000 QuanHash ¦+¦¬TÏ ¦¦¦-TÀ¦-¦¬¦¦¦-TÁ¦¦¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦Ú¦-TÀ¦-¦¬¦¦¦-TÁ¦¦¦¬¦¦ TÅTÍTÈ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_39')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 8100 òíÐ</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒë Ultimate Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 1,000,000 QuanHash ¦+¦¬TÏ ¦-¦-TÁ¦-¦¬TÎTÂ¦-¦-¦¦¦- ¦-¦-¦¦¦-¦¬¦-¦¦¦-</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">òÜÅ ¦ã¦¬TÌTÂ¦¬¦-¦¦¦¦TÂ ¦-¦-TÉTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_40')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 9000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">¨ßÎÁ ¦Ú¦Þ¦Ü¦Ñ¦Þ ¦á¦Õ¦â¦ë</div>

                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÎÁ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÎÁ ¦áTÂ¦-TÀTÂ¦-¦-TË¦¦ ¦-¦¦¦¦¦-TÁ¦¦TÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 10 ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦ + 1,000,000 ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦áTÂ¦-TÀTÂ¦-¦-TË¦¦ ¦¦¦-¦-¦-¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_41')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 5000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÔå</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÔå ¦Ó¦-TÀTÏTÇ¦¬¦¦ ¦¦¦-¦-¦-¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 20 ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦ + 10,000,000 ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦Ó¦-TÀTÏTÇ¦-TÏ TÁ¦-TÏ¦¬¦¦¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_42')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 7000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ ¦í¦¬¦¬TÂ¦-TË¦¦ ¦-¦-¦-¦-TÀ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 50 ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦ + 50,000,000 ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦í¦¬¦¬TÂ¦-¦-TÏ ¦¦¦-¦-¦-¦¬¦-¦-TÆ¦¬TÏ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_43')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 9000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÚÀ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÚÀ ¦Ü¦¦¦¦¦- TÁ¦-TÏ¦¬¦¦¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 100 ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦ + 100,000,000 ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦Ü¦¦¦¦¦- TÁ¦¬¦¬¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_44')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 11000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÌß</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÌß ¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-TË¦¦ ¦-¦¦¦¦¦-TÁ¦¦TÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ß¦-¦¬TÃTÇ¦¬TÂ¦¦ 200 ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦ + 200,000,000 ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦Û¦¦¦¦¦¦¦-¦+¦-TÀ¦-¦-TÏ ¦-¦-TÉTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_45')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 13000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ ¦ÑTÀ¦¬¦¬¦¬¦¬¦-¦-TÂ¦-¦-¦-TÏ TÁ¦-TÏ¦¬¦¦¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">VIP ¦¦¦-TÀTÂTË + ¦-¦¦¦¬¦¬¦¬¦-¦¬TÂ¦-TË¦¦ ¦-¦-¦-TÃTÁTË + 75M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦ÑTÀ¦¬¦¬¦¬¦¬¦-¦-TÂ¦-¦-TË¦¦ ¦¬¦-¦¦¦¦TÂ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_46')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 15000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÑÑ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÑÑ ¦Ú¦-TÀ¦-¦¬¦¦¦-TÁ¦¦¦¬¦¦ ¦¦¦-¦-¦-¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">300 ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦ + VIP ¦+¦-TÁTÂTÃ¦¬ + 85M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦Ú¦-TÀ¦-¦¬¦¦¦-TÁ¦¦¦-TÏ ¦-¦-TÉTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_47')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 17000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÔå</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÔå ¦Þ¦¦¦-¦¦¦-¦-TË¦¦ ¦-¦¦¦¦¦-TÁ¦¦TÂ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">500 ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦ + 500,000,000 ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦Þ¦¦¦-¦¦¦-¦-¦-TÏ ¦-¦-TÉTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_48')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 19000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒë ¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦¬¦¦ ¦¦¦-¦-¦-¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">1000 ¦¦¦-TÀTÂ¦-TÇ¦¦¦¦ + ¦-TÁTÑ VIP + 105M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦Ú¦-TÁ¦-¦¬TÇ¦¦TÁ¦¦¦-TÏ TÁ¦¬¦¬¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_49')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 21000 òíÐ</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÎï</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÎï ¦Ð¦Ñ¦á¦Þ¦Û¦î¦â ¦Ò¦á¦Á</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦Ò¦á¦Á TÇTÂ¦- ¦¦TÁTÂTÌ ¦- ¦¬¦¦TÀ¦¦! ¦Ð¦-TÁ¦-¦¬TÎTÂ¦-TË¦¦ ¦¬¦-¦¦¦¦TÂ</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">òÜÅ ¦Ð¦-TÁ¦-¦¬TÎTÂ¦-¦-TÏ ¦-¦-TÉTÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_50')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 24000 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">¨ßÑÑ VIP ¦ä¦ã¦Ý¦Ú¦æ¦Ø¦Ø</div>

                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÑÑ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÑÑ VIP ¦ÒTÁTÑ ¦-¦¦¦¬TÎTÇ¦¦¦-¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ÒTÁ¦¦ TÄTÃ¦-¦¦TÆ¦¬¦¬ + TÍ¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦- + 50M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦á¦¦¦¬¦+¦¦¦- 50%</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_51')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 5000 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òíÐ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">òíÐ ¦í¦¦TÁ¦¦¦¬TÎ¦¬¦¬¦-¦-TË¦¦ ¦-¦¦¦¦¦+¦¦</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ã¦-¦¬¦¦¦-¦¬TÌ¦-¦-TÏ ¦-¦¦TÂ¦¦¦- ¦¬TÀ¦-TÄ¦¬¦¬TÏ + 100M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦ÒTË¦+¦¦¦¬TÏ¦¦TÁTÏ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_52')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 2500 òíÐ</button>
                        </div>
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÏÆ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÏÆ ¦Ó¦-TÀ¦-¦-TÂ¦¬TÀ¦-¦-¦-¦- TÂ¦-¦¬</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦Ü¦¦TÁTÂ¦- ¦- TÂ¦-¦¬-100 ¦¬¦¦TÀ¦-¦¦¦-¦- + 150M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ý¦-¦-TÁ¦¦¦¦¦+¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_53')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 4000 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">òÚá</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">òÚá ¦Ü¦¦¦-¦-¦-¦¦¦-¦-TË¦¦ ¦+¦-TÅ¦-¦+</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ãTÁ¦¦¦-TÀ¦¦¦-¦¬¦¦ x100 + 200M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ü¦-¦¦TÁ¦¬¦-TÃ¦- ¦-TË¦¦¦-¦+¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_54')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 6000 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÔÓ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÔÓ ¦á¦-TÏTÂTÌ ¦¬¦¬¦-¦¬TÂTË</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦Ý¦¬¦¦¦-¦¦¦¬TÅ ¦-¦¦TÀ¦-¦-¦¬TÇ¦¦¦-¦¬¦¦ + 250M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ñ¦¦TÁ¦¦¦-¦-¦¦TÇ¦-TË¦¦ ¦-¦-¦¬¦-¦-¦¦¦-¦-TÁTÂ¦¬</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_55')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 8000 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÚÀ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÚÀ ¦Ð¦-TÂ¦-¦¬TÀ¦-¦¦¦-TÇ¦¦¦-</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ÒTÁTÑ ¦-¦-TÂ¦-¦-¦-TÂ¦¬TÇ¦¦TÁ¦¦¦¬ + 300M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ñ¦¦¦¬ TÃTÇ¦-TÁTÂ¦¬TÏ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_56')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 10000 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÒÎ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÒÎ ¦ßTÀ¦¬¦-TÀ¦¬TÂ¦¦TÂ ¦¬¦-¦-¦-TÉTÌ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">VIP ¦¬¦-¦+¦+¦¦TÀ¦¦¦¦¦- 24/7 + 350M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦ß¦¦TÀ¦-TË¦- ¦-TÂ¦-¦¦TÇ¦-¦¦¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_57')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 3500 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÑÑ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÑÑ ¦×¦-¦¬¦-TÂ¦-¦¦ ¦¬TÀ¦-TÄ¦¬¦¬TÌ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ã¦-¦¬¦¦¦-¦¬TÌ¦-TË¦¦ ¦+¦¬¦¬¦-¦¦¦- ¦¬TÀ¦-TÄ¦¬¦¬TÏ + 400M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ø¦-¦¬¦¦TÀ¦-TÂ¦-TÀTÁ¦¦¦¬¦¦ TÁTÂ¦¬¦¬TÌ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_58')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 4500 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÌß</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÌß ¦áTÃ¦¬¦¦TÀ TÁTÂ¦-TÂTÃTÁ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ßTÀ¦¦¦-¦¬TÃ¦- ¦¬TÀ¦-¦-¦- ¦-¦¦¦¬¦+¦¦ + 450M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦ÒTÁTÑ TÀ¦-¦¬¦-¦¬¦-¦¦¦¬TÀ¦-¦-¦-¦-¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_59')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 7000 òíÐ</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">¨ßÎï</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">¨ßÎï ¦Ð¦Ñ¦á¦Þ¦Û¦î¦â ¦Ò¦á¦Á VIP</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">¦ÒTÁ¦¦ ¦¬TÀ¦¦¦-¦¬TÃ¦- TÁTÀ¦-¦¬TÃ + 500M ¦¦¦-¦¬¦-¦-¦-</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">òÜÅ ¦Ü¦-¦¦TÁ¦¬¦-¦-¦¬TÌ¦-¦-TÏ TÁ¦¦¦¬¦+¦¦¦-</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_60')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">¨ßÒ- 15000 òíÐ</button>
                        </div>
                        
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Set initial active category after modal is attached
            setTimeout(() => window.filterCategory('starter'), 100);
        }
        
        window.filterCategory = function(category) {
            try {
                // Update button states
                document.querySelectorAll('#buyCurrencyModal .category-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                if(event?.target) {
                    event.target.classList.add('active');
                }
                
                // Filter and show products
                const products = document.querySelectorAll('#currencyProductsList [data-category]');
                products.forEach(product => {
                    if(product.dataset.category === category) {
                        product.style.display = 'block';
                    } else {
                        product.style.display = 'none';
                    }
                });
            } catch(err) {
                console.error('filterCategory error:', err);
            }
        }

    </script>

    <!-- Initialize on page load -->
    <script>
        // Initialize default settings if not already set (enabled by default)
        // Don't set explicit values - let the check for null handle defaults
        // This way the logic "null || 'true' || true" will work correctly
        
        // Initialize audio on first user interaction
        // Use capture phase to ensure AudioContext is ready before handlers run
        function initAudioOnClick(e) {
            initAudio();
            // Remove this listener after first click
            document.removeEventListener('click', initAudioOnClick, true);
        }
        document.addEventListener('click', initAudioOnClick, true);
        
        // Start periodic updates
        loadData();
        setInterval(loadData, 3000); // Reload every 3 seconds
        startEnergyRegen();
        
        // Initialize shop and other components
        window.addEventListener('load', () => {
            if (window.shopData) {
                const firstCategory = Object.keys(window.shopData).find(key => 
                    window.shopData[key] && window.shopData[key].items && window.shopData[key].items.length > 0
                );
                if (firstCategory) {
                    loadShopCategory(firstCategory);
                }
            }
        });
    </script>


</body>
</html>
