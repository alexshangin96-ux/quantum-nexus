<!DOCTYPE html>
<!-- Quantum Nexus v4.0 - Updated Shop with 60 Products - –ò–ù–°–¢–†–£–ö–¶–ò–Ø: –í—ã–ø–æ–ª–Ω–∏—Ç–µ git pull –∏ systemctl restart –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ -->
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quantum Nexus v2.0</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, Cantarell, sans-serif;
            background: #0a0e27;
            color: #fff;
            min-height: 100vh;
            padding: 20px;
            position: relative;
            overflow-x: hidden;
            -webkit-tap-highlight-color: transparent !important;
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            user-select: none;
        }
        
        * {
            -webkit-tap-highlight-color: transparent !important;
            -webkit-focus-ring-color: transparent !important;
            -webkit-touch-callout: none !important;
        }
        
        button:focus,
        button:active {
            outline: none !important;
            box-shadow: none !important;
            border: none !important;
        }
        
        .tap-button:focus,
        .tap-button:active,
        .tap-button:focus-visible {
            outline: none !important;
            box-shadow: none !important;
            border: none !important;
        }
        
        /* Prevent all visual selection highlights */
        .tap-button,
        .tap-button * {
            -webkit-tap-highlight-color: transparent !important;
            -webkit-touch-callout: none !important;
            user-select: none !important;
            -webkit-user-select: none !important;
            -ms-user-select: none !important;
            -moz-user-select: none !important;
            -webkit-focus-ring-color: transparent !important;
        }
        
        /* Remove all possible focus states */
        button.tap-button:hover,
        button.tap-button:active,
        button.tap-button:focus,
        button.tap-button:focus-visible,
        button.tap-button:focus-within,
        button.tap-button:visited {
            outline: none !important;
            border: none !important;
            box-shadow: none !important;
            -webkit-tap-highlight-color: transparent !important;
            -webkit-touch-callout: none !important;
        }
        
        /* Extra protection for Telegram WebView */
        html, body {
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
            -webkit-tap-highlight-color: transparent !important;
        }

        body::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: 
                linear-gradient(45deg, transparent 30%, rgba(102, 126, 234, 0.05) 50%, transparent 70%),
                radial-gradient(circle at 20% 50%, rgba(102, 126, 234, 0.1) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(118, 75, 162, 0.1) 0%, transparent 50%);
            pointer-events: none;
            animation: drift 20s linear infinite;
        }

        @keyframes drift {
            0%, 100% { transform: translateX(0); }
            50% { transform: translateX(-20px); }
        }

        .container {
            max-width: 400px;
            margin: 0 auto;
            position: relative;
            z-index: 1;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            position: relative;
        }

        .header::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 50%;
            transform: translateX(-50%);
            width: 60%;
            height: 2px;
            background: linear-gradient(90deg, transparent, #667eea, transparent);
        }

        .header h1 {
            font-size: 28px;
            font-weight: 900;
            margin-bottom: 10px;
            text-shadow: 0 0 30px rgba(102, 126, 234, 0.5);
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            animation: glow 3s ease-in-out infinite;
            letter-spacing: 2px;
            text-transform: uppercase;
        }

        @keyframes glow {
            0%, 100% { filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.5)); }
            50% { filter: drop-shadow(0 0 20px rgba(118, 75, 162, 0.8)); }
        }
        
        /* VIP Styles */
        .vip-container {
            position: relative;
        }
        
        .vip-particles {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 1000;
        }
        
        @keyframes vip-float {
            0% { transform: translateY(0) rotate(0deg); opacity: 0; }
            10% { opacity: 1; }
            90% { opacity: 1; }
            100% { transform: translateY(-100vh) rotate(360deg); opacity: 0; }
        }
        
        .vip-golden-bg {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, 
                rgba(255, 215, 0, 0.12) 0%,
                rgba(255, 255, 255, 0.05) 25%,
                rgba(255, 215, 0, 0.10) 50%,
                rgba(255, 255, 255, 0.07) 75%,
                rgba(255, 215, 0, 0.12) 100%
            );
            background-size: 400% 400%;
            animation: vip-gradient 15s ease infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        .vip-premium-shine {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: 
                radial-gradient(circle at 20% 20%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 80% 80%, rgba(255, 215, 0, 0.08) 0%, transparent 50%),
                radial-gradient(circle at 40% 60%, rgba(255, 255, 255, 0.03) 0%, transparent 50%);
            animation: vip-premium-shine 8s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes vip-premium-shine {
            0%, 100% { opacity: 0.6; }
            50% { opacity: 1; }
        }
        
        .vip-top-leaders {
            position: fixed;
            top: 10px;
            left: 10px;
            width: 140px;
            background: rgba(0, 0, 0, 0.65);
            backdrop-filter: blur(12px);
            border: 2px solid rgba(255, 215, 0, 0.35);
            border-radius: 12px;
            padding: 12px;
            z-index: 1000;
            box-shadow: 0 4px 20px rgba(255, 215, 0, 0.25);
        }
        
        .vip-profile-icon {
            position: relative;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #a78bfa, #c084fc, #d946ef);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 3px solid rgba(255, 255, 255, 0.4);
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 0 20px rgba(167, 139, 250, 0.6), 0 4px 15px rgba(167, 139, 250, 0.5);
            transition: all 0.3s ease;
            overflow: hidden;
            animation: vip-icon-glow 2s ease-in-out infinite;
        }
        
        @keyframes vip-icon-glow {
            0%, 100% { box-shadow: 0 0 20px rgba(167, 139, 250, 0.6), 0 4px 15px rgba(167, 139, 250, 0.5); }
            50% { box-shadow: 0 0 30px rgba(167, 139, 250, 0.9), 0 6px 20px rgba(167, 139, 250, 0.8); }
        }
        
        .vip-profile-icon img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }
        
        .vip-profile-icon:hover {
            transform: scale(1.12);
            box-shadow: 0 0 35px rgba(217, 70, 239, 0.8), 0 8px 25px rgba(217, 70, 239, 0.7);
        }
        
        .vip-top-button {
            position: relative;
            width: 45px;
            height: 45px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 24px;
            border: 3px solid rgba(255, 255, 255, 0.3);
            cursor: pointer;
            z-index: 10;
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5);
            transition: all 0.3s ease;
        }
        
        .vip-top-button:hover {
            transform: scale(1.1);
            box-shadow: 0 6px 20px rgba(102, 126, 234, 0.7);
        }
        
        @keyframes vip-gradient {
            0% { background-position: 0% 50%; }
            50% { background-position: 100% 50%; }
            100% { background-position: 0% 50%; }
        }
        
        .vip-aura {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            width: 300px;
            height: 300px;
            border-radius: 50%;
            background: radial-gradient(circle, rgba(255,215,0,0.3), transparent);
            animation: vip-aura-pulse 3s ease-in-out infinite;
            pointer-events: none;
            z-index: 0;
        }
        
        @keyframes vip-aura-pulse {
            0%, 100% { transform: translate(-50%, -50%) scale(1); opacity: 0.5; }
            50% { transform: translate(-50%, -50%) scale(1.5); opacity: 0.2; }
        }
        
        .vip-rainbow-border {
            border: 3px solid;
            border-image: linear-gradient(45deg, #ff0000, #ff7f00, #ffff00, #00ff00, #0000ff, #4b0082, #9400d3) 1;
            animation: vip-rainbow 3s linear infinite;
        }
        
        @keyframes vip-rainbow {
            0% { filter: hue-rotate(0deg); }
            100% { filter: hue-rotate(360deg); }
        }
        
        .vip-shine-effect {
            position: relative;
            overflow: hidden;
        }
        
        .vip-shine-effect::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.8), transparent);
            animation: vip-shine 3s ease-in-out infinite;
        }
        
        @keyframes vip-shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        .vip-glow-box {
            box-shadow: 0 0 30px rgba(255,215,0,0.8), 
                        0 0 60px rgba(255,215,0,0.5),
                        0 0 90px rgba(255,215,0,0.3);
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }
        
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            10%, 30%, 50%, 70%, 90% { transform: translateX(-3px); }
            20%, 40%, 60%, 80% { transform: translateX(3px); }
        }
        
        @keyframes shine-btn {
            0% { left: -100%; }
            100% { left: 100%; }
        }
        
        @keyframes rotate {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        @keyframes premium-pulse {
            0%, 100% { transform: scale(1); box-shadow: 0 0 30px rgba(255, 215, 0, 0.6), 0 0 60px rgba(255, 140, 0, 0.4); }
            50% { transform: scale(1.03); box-shadow: 0 0 40px rgba(255, 215, 0, 0.8), 0 0 80px rgba(255, 140, 0, 0.6); }
        }

        .stats {
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(26, 29, 46, 0.9) 100%);
            backdrop-filter: blur(20px);
            border-radius: 16px;
            padding: 12px;
            margin-bottom: 16px;
            border: 1px solid rgba(102, 126, 234, 0.3);
            box-shadow: 0 4px 16px rgba(0, 0, 0, 0.5);
            position: relative;
            overflow: hidden;
        }

        .stats::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.1), transparent);
            animation: shine 3s infinite;
        }

        @keyframes shine {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .stat-row {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 12px 0;
            border-bottom: 1px solid rgba(102, 126, 234, 0.2);
            position: relative;
            z-index: 1;
        }

        .stat-row:last-child {
            border-bottom: none;
        }

        .stat-label {
            font-size: 14px;
            opacity: 0.9;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .stat-value {
            font-size: 18px;
            font-weight: bold;
            color: #f093fb;
            text-shadow: 0 0 10px rgba(240, 147, 251, 0.3);
        }

        .stat-compact-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 8px;
            margin-bottom: 8px;
        }

        .stat-item-compact {
            background: rgba(0,0,0,0.3);
            border-radius: 10px;
            padding: 8px;
            text-align: center;
            border: 1px solid rgba(102, 126, 234, 0.3);
        }

        .stat-main-value {
            font-size: 18px;
            font-weight: 900;
            color: #fff;
            margin-bottom: 2px;
        }

        .stat-passive-value {
            font-size: 10px;
            color: #4ade80;
            margin-bottom: 6px;
            font-weight: 600;
        }

        .stat-label-small {
            font-size: 12px;
            color: #94a3b8;
        }

        .energy-bar-container {
            padding-top: 15px;
        }

        .energy-bar {
            width: 100%;
            height: 10px;
            background: rgba(255,255,255,0.1);
            border-radius: 5px;
            overflow: hidden;
            margin-top: 5px;
            position: relative;
        }

        .energy-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea, #764ba2, #f093fb);
            transition: width 0.5s ease;
            position: relative;
            overflow: hidden;
        }

        .energy-fill::after {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.3), transparent);
            animation: energyFlow 2s infinite;
        }

        @keyframes energyFlow {
            0% { left: -100%; }
            100% { left: 100%; }
        }

        .energy-regen {
            font-size: 12px;
            color: #4ade80;
            margin-top: 5px;
            text-align: center;
        }

        .buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-bottom: 20px;
        }

        .btn {
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.2) 0%, rgba(118, 75, 162, 0.2) 100%);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(102, 126, 234, 0.4);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s ease;
            font-size: 16px;
            font-weight: 600;
            color: white;
            text-decoration: none;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 8px;
            box-shadow: 0 4px 20px rgba(0,0,0,0.3);
            position: relative;
            overflow: hidden;
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255,255,255,0.1), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-3px);
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3) 0%, rgba(118, 75, 162, 0.3) 100%);
            border-color: rgba(102, 126, 234, 0.6);
            box-shadow: 0 8px 32px rgba(102, 126, 234, 0.4);
        }

        .btn-emoji {
            font-size: 32px;
            filter: drop-shadow(0 0 10px rgba(102, 126, 234, 0.3));
        }

        .tap-button {
            width: 280px;
            height: 280px;
            margin: 30px auto;
            border-radius: 50%;
            position: relative;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.8) 0%, rgba(118, 75, 162, 0.8) 100%);
            border: 4px solid transparent;
            cursor: pointer;
            box-shadow: 0 15px 50px rgba(102, 126, 234, 0.3);
            transition: all 0.08s cubic-bezier(0.25, 1.8, 0.75, 0.5);
            user-select: none;
            -webkit-tap-highlight-color: transparent !important;
            -webkit-touch-callout: none;
            animation: pulse 2s ease-in-out infinite;
            -webkit-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            outline: none !important;
            -webkit-focus-ring-color: transparent !important;
        }

        .tap-button svg {
            width: 100%;
            height: 100%;
            filter: drop-shadow(0 0 20px rgba(255, 192, 203, 0.6));
        }

        @keyframes pulse {
            0%, 100% {
                transform: scale(1);
                box-shadow: 0 15px 50px rgba(102, 126, 234, 0.5), 0 0 0 0 rgba(102, 126, 234, 0.4);
                border-color: rgba(102, 126, 234, 0.6);
            }
            50% {
                transform: scale(1.05);
                box-shadow: 0 20px 60px rgba(102, 126, 234, 0.7), 0 0 40px 20px rgba(102, 126, 234, 0.3);
                border-color: rgba(240, 147, 251, 0.8);
            }
        }
        
        @keyframes tapPress {
            0% { 
                transform: scale(1);
                filter: brightness(1);
            }
            15% {
                transform: scale(0.92);
                filter: brightness(1.1);
            }
            30% {
                transform: scale(1.03);
                filter: brightness(1.08);
            }
            50% {
                transform: scale(0.99);
                filter: brightness(1.05);
            }
            70% {
                transform: scale(1.02);
                filter: brightness(1.04);
            }
            100% {
                transform: scale(1);
                filter: brightness(1);
            }
        }
        
        @keyframes neonBurst {
            0% {
                box-shadow: 0 0 0 0 rgba(240, 147, 251, 0);
            }
            50% {
                box-shadow: 0 0 0 20px rgba(240, 147, 251, 0), 0 0 0 40px rgba(102, 126, 234, 0);
            }
            100% {
                box-shadow: 0 0 0 0 rgba(240, 147, 251, 0), 0 0 0 0 rgba(102, 126, 234, 0);
            }
        }
        
        .tap-button.tap-pressed {
            animation: tapPress 0.3s cubic-bezier(0.25, 1, 0.5, 1);
        }

        .tap-button::before {
            content: '';
            position: absolute;
            inset: -10px;
            border-radius: 50%;
            background: linear-gradient(45deg, rgba(102, 126, 234, 0.6), rgba(118, 75, 162, 0.6));
            filter: blur(20px);
            opacity: 0;
            animation: neonPulse 2s ease-in-out infinite;
        }
        
        .tap-button::after {
            content: '';
            position: absolute;
            inset: 0;
            border-radius: 50%;
            background: linear-gradient(135deg, rgba(102, 126, 234, 0.3), rgba(118, 75, 162, 0.3));
            filter: blur(15px);
            opacity: 0;
            animation: neonPulse 2s ease-in-out infinite 0.3s;
        }
        
        @keyframes neonPulse {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 0.7; transform: scale(1.05); }
        }

        /* Offline Income Notice */
        .offline-notice {
            background: linear-gradient(135deg, rgba(76, 222, 128, 0.2) 0%, rgba(34, 197, 94, 0.2) 100%);
            border: 1px solid rgba(76, 222, 128, 0.5);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
            text-align: center;
            animation: slideDown 0.5s ease-out;
        }

        @keyframes slideDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes slideIn {
            from {
                opacity: 0;
                transform: translateX(-30px);
            }
            to {
                opacity: 1;
                transform: translateX(0);
            }
        }

        /* Withdraw Section */
        .withdraw-section {
            background: linear-gradient(135deg, rgba(15, 23, 42, 0.9) 0%, rgba(26, 29, 46, 0.9) 100%);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 20px;
        }

        .withdraw-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: #f093fb;
        }

        .withdraw-info {
            font-size: 14px;
            opacity: 0.8;
            margin-bottom: 10px;
        }

        .input-group {
            margin-bottom: 10px;
        }

        .input-group input {
            width: 100%;
            padding: 12px;
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            color: white;
            font-size: 14px;
        }

        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }

        .action-btn {
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            border-radius: 10px;
            color: white;
            font-weight: bold;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .action-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(102, 126, 234, 0.4);
        }

        /* Modal Styles */
        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.5);
            z-index: 1000;
            overflow-y: auto;
            padding: 20px;
            backdrop-filter: blur(8px);
        }

        .modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .modal-content {
            background: linear-gradient(135deg, #0a0e27 0%, #1a1d2e 100%);
            border: 1px solid rgba(102, 126, 234, 0.5);
            border-radius: 20px;
            padding: 20px;
            max-width: 400px;
            width: 100%;
            max-height: 90vh;
            overflow-y: auto;
            box-shadow: 0 20px 60px rgba(0,0,0,0.8);
            position: relative;
        }

        /* .modal-content::before - Removed to fix double border issue */

        .modal-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .modal-title {
            font-size: 24px;
            font-weight: bold;
            background: linear-gradient(45deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .close-btn {
            background: rgba(255,255,255,0.1);
            border: none;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            cursor: pointer;
            color: white;
            font-size: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
        }

        .close-btn:hover {
            background: rgba(255,255,255,0.2);
            transform: rotate(90deg);
        }

        .shop-category {
            margin-bottom: 20px;
        }

        .category-title {
            font-size: 18px;
            font-weight: bold;
            margin-bottom: 10px;
            color: #f093fb;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            cursor: pointer;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        .item::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(102, 126, 234, 0.2), transparent);
            transition: left 0.5s;
        }

        .item:hover::before {
            left: 100%;
        }

        .item:hover {
            background: rgba(102, 126, 234, 0.2);
            border-color: rgba(102, 126, 234, 0.6);
            transform: translateX(5px);
        }

        .item-info {
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .item-emoji {
            font-size: 24px;
        }

        .item-details {
            flex: 1;
        }

        .item-name {
            font-weight: bold;
            margin-bottom: 5px;
        }

        .item-desc {
            font-size: 12px;
            opacity: 0.7;
            margin-bottom: 5px;
        }

        .item-price {
            font-size: 14px;
            color: #f093fb;
            font-weight: bold;
        }

        .mining-machine {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .machine-tag {
            position: absolute;
            top: 10px;
            right: 10px;
            padding: 4px 10px;
            border-radius: 8px;
            font-size: 11px;
            font-weight: bold;
        }

        .machine-tag.free {
            background: rgba(76, 222, 128, 0.2);
            color: #4ade80;
            border: 1px solid #4ade80;
        }

        .machine-tag.premium {
            background: rgba(240, 147, 251, 0.2);
            color: #f093fb;
            border: 1px solid #f093fb;
        }

        .machine-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .machine-name {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .machine-level {
            font-size: 14px;
            opacity: 0.8;
        }

        .machine-stats {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 10px;
            font-size: 14px;
        }

        .stat-item {
            background: rgba(102, 126, 234, 0.1);
            padding: 8px;
            border-radius: 8px;
            text-align: center;
        }

        .stat-label {
            font-size: 11px;
            opacity: 0.7;
            margin-bottom: 4px;
        }

        .stat-value {
            font-weight: bold;
            color: #f093fb;
        }

        .card-item {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
            position: relative;
            overflow: hidden;
        }

        .card-glow {
            position: absolute;
            inset: -2px;
            border-radius: 15px;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .card-item:hover .card-glow {
            opacity: 1;
        }

        .card-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }

        .card-name {
            font-weight: bold;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .card-level {
            font-size: 14px;
            opacity: 0.8;
        }

        .card-stats {
            display: flex;
            gap: 15px;
            font-size: 14px;
        }

        .stats-window {
            background: rgba(255,255,255,0.05);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 15px;
            padding: 15px;
            margin-bottom: 10px;
        }

        .stats-row {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid rgba(102, 126, 234, 0.1);
        }

        .stats-row:last-child {
            border-bottom: none;
        }

        .stats-label {
            opacity: 0.8;
        }

        .stats-value {
            font-weight: bold;
            color: #f093fb;
        }

        .referral-link {
            background: rgba(102, 126, 234, 0.1);
            border: 1px solid rgba(102, 126, 234, 0.3);
            border-radius: 10px;
            padding: 12px;
            margin: 10px 0;
            font-family: monospace;
            word-break: break-all;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .referral-benefits {
            background: rgba(76, 222, 128, 0.1);
            border: 1px solid rgba(76, 222, 128, 0.3);
            border-radius: 10px;
            padding: 12px;
            margin: 10px 0;
        }

        .benefit-item {
            display: flex;
            align-items: center;
            gap: 10px;
            margin: 8px 0;
            font-size: 14px;
        }

        @keyframes coinFloat {
            0% {
                opacity: 1;
                transform: translateY(0) scale(1);
            }
            100% {
                opacity: 0;
                transform: translateY(-50px) scale(0.5);
            }
        }

        .coin-animation {
            position: fixed;
            font-size: 32px;
            font-weight: 900;
            pointer-events: none;
            animation: coinFloat 2s ease-out forwards;
            z-index: 9999;
            color: #ffd700;
            text-shadow: 
                0 0 10px rgba(255, 215, 0, 1),
                0 0 20px rgba(255, 215, 0, 0.8),
                0 0 30px rgba(255, 215, 0, 0.6),
                0 0 40px rgba(255, 215, 0, 0.4),
                0 0 50px rgba(255, 215, 0, 0.2);
            filter: drop-shadow(0 0 10px rgba(255, 215, 0, 1));
            will-change: transform, opacity, filter;
        }

        @keyframes coinFloat {
            0% {
                opacity: 1;
                transform: translate(-50%, -50%) scale(0.5) rotate(0deg);
                filter: blur(0px) brightness(1);
            }
            10% {
                opacity: 1;
                transform: translate(-50%, -80%) scale(0.7) rotate(90deg);
                filter: blur(0px) brightness(1.2);
            }
            20% {
                opacity: 1;
                transform: translate(-50%, -120%) scale(0.9) rotate(180deg);
                filter: blur(0px) brightness(1.3);
            }
            30% {
                opacity: 1;
                transform: translate(-50%, -170%) scale(1.1) rotate(270deg);
                filter: blur(1px) brightness(1.2);
            }
            40% {
                opacity: 1;
                transform: translate(-50%, -230%) scale(1.3) rotate(360deg);
                filter: blur(1px) brightness(1.1);
            }
            50% {
                opacity: 1;
                transform: translate(-50%, -300%) scale(1.5) rotate(450deg);
                filter: blur(2px) brightness(1);
            }
            60% {
                opacity: 0.9;
                transform: translate(-50%, -380%) scale(1.7) rotate(540deg);
                filter: blur(2px) brightness(0.9);
            }
            70% {
                opacity: 0.7;
                transform: translate(-50%, -470%) scale(1.9) rotate(630deg);
                filter: blur(3px) brightness(0.7);
            }
            80% {
                opacity: 0.5;
                transform: translate(-50%, -570%) scale(2.1) rotate(720deg);
                filter: blur(4px) brightness(0.5);
            }
            90% {
                opacity: 0.3;
                transform: translate(-50%, -680%) scale(2.3) rotate(810deg);
                filter: blur(5px) brightness(0.3);
            }
            100% {
                opacity: 0;
                transform: translate(-50%, -800%) scale(2.5) rotate(900deg);
                filter: blur(6px) brightness(0);
            }
        }

        .loading {
            text-align: center;
            padding: 40px;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header" style="position: relative;">
            <div style="display: flex; align-items: center; justify-content: center; gap: 20px; margin-bottom: 20px;">
                <div class="vip-top-button" style="width: 45px; height: 45px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 24px; box-shadow: 0 4px 15px rgba(102, 126, 234, 0.5); transition: all 0.3s; flex-shrink: 0;" onclick="openVIPTopLeaders();" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">üèÜ</div>
                
                <h1 id="mainTitle" style="margin: 0; text-align: center; font-size: 26px; white-space: nowrap;">Quantum Nexus</h1>
                
                <div class="vip-profile-icon" style="width: 45px; height: 45px; background: linear-gradient(135deg, #a78bfa, #c084fc); border-radius: 50%; display: flex; align-items: center; justify-content: center; cursor: pointer; font-size: 24px; box-shadow: 0 4px 15px rgba(167, 139, 250, 0.5); transition: all 0.3s; flex-shrink: 0;" onclick="openVIPProfileModal();" onmouseover="this.style.transform='scale(1.1)'" onmouseout="this.style.transform='scale(1)'">üë§</div>
            </div>
            
            <div id="vipPrivileges" style="display:none;margin-top:5px;font-size:11px;color:#94a3b8;"></div>
        </div>

        <!-- Offline Income Popup -->
        <div id="offlinePopup" class="modal">
            <div class="modal-content" style="max-width: 350px;">
                <div class="modal-header">
                    <div class="modal-title">üí∞ –û—Ñ—Ñ–ª–∞–π–Ω –¥–æ—Ö–æ–¥</div>
                    <button class="close-btn" onclick="closeModal('offlinePopup')">‚úï</button>
                </div>
                <div id="offlineContent"></div>
            </div>
        </div>

        <div class="stats">
            <div class="stat-compact-row">
                <div class="stat-item-compact">
                    <div class="stat-main-value" id="coins">0</div>
                    <div class="stat-passive-value" id="passiveCoins">+0/—á–∞—Å</div>
                    <div class="stat-label-small">üí∞ –ö–æ–∏–Ω—ã</div>
                </div>
                <div class="stat-item-compact">
                    <div class="stat-main-value" id="quanhash">0</div>
                    <div class="stat-passive-value" id="passiveHash">+0/—á–∞—Å</div>
                    <div class="stat-label-small">üíé QuanHash</div>
                </div>
            </div>
            <div class="energy-bar-container" style="margin-bottom: 16px;">
                <div class="energy-bar-wrapper" style="position: relative; background: linear-gradient(135deg, rgba(15,15,30,0.92), rgba(20,20,35,0.95)); border: 2px solid rgba(118,75,162,0.4); border-radius: 18px; padding: 16px 12px; box-shadow: 0 0 30px rgba(118,75,162,0.3), 0 4px 20px rgba(0,0,0,0.5); width: 100%;">
                    <!-- Ultra-wide progress bar with everything inside -->
                    <div class="energy-bar" style="width: 100%; height: 44px; background: rgba(0,0,0,0.4); border-radius: 14px; overflow: visible; position: relative; box-shadow: inset 0 2px 10px rgba(0,0,0,0.7), 0 0 10px rgba(118,75,162,0.2); border: 1px solid rgba(118,75,162,0.3);">
                        <!-- Energy fill with tap button colors (soft purple gradient) -->
                        <div class="energy-fill" id="energy-bar-fill" style="width: 0%; height: 100%; background: linear-gradient(90deg, #667eea 0%, #764ba2 50%, #8b5cf6 100%); box-shadow: 0 0 30px rgba(102,126,234,0.6), inset 0 0 20px rgba(118,75,162,0.3), 0 2px 10px rgba(102,126,234,0.4); position: absolute; top: 0; left: 0; transition: width 0.2s cubic-bezier(0.25, 0.46, 0.45, 0.94); border-radius: 12px;">
                            <!-- Soft shine effect -->
                            <div style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: linear-gradient(90deg, transparent 0%, rgba(255,255,255,0.3) 50%, transparent 100%); animation: softShine 3s infinite; border-radius: 12px;"></div>
                        </div>
                        
                        <!-- Label: Energy - Value - Percentage with soft readable text -->
                        <div style="position: absolute; top: 50%; left: 0; right: 0; transform: translateY(-50%); display: flex; align-items: center; justify-content: space-between; padding: 0 16px; pointer-events: none; z-index: 10;">
                            <div style="font-size: 13px; font-weight: 700; color: #a78bfa; text-shadow: 0 1px 3px rgba(0,0,0,0.8), 0 0 10px rgba(167,139,250,0.5); letter-spacing: 0.3px;">‚ö° –≠–Ω–µ—Ä–≥–∏—è</div>
                            <div id="energy-text" style="font-size: 15px; font-weight: 800; color: #fff; text-shadow: 0 1px 4px rgba(0,0,0,1), 0 0 15px rgba(255,255,255,0.6); letter-spacing: 0.5px; font-variant-numeric: tabular-nums;">0/1000</div>
                            <div id="energy-percent" style="font-size: 13px; font-weight: 700; color: #86efac; text-shadow: 0 1px 3px rgba(0,0,0,0.8), 0 0 10px rgba(134,239,172,0.5); letter-spacing: 0.3px;">0%</div>
                        </div>
                    </div>
                    
                    <!-- Regen info nicely positioned under the bar -->
                    <div class="energy-regen" id="energy-regen-text" style="text-align: center; margin-top: 12px; font-size: 12px; color: #86efac; font-weight: 800; text-shadow: 0 0 10px rgba(134,239,172,0.7); letter-spacing: 0.5px;">–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: +1/—Å–µ–∫</div>
                </div>
                
                <style>
                    @keyframes softShine {
                        0% { transform: translateX(-150%); opacity: 0; }
                        20% { opacity: 0.4; }
                        80% { opacity: 0.4; }
                        100% { transform: translateX(350%); opacity: 0; }
                    }
                </style>
            </div>
            
            <!-- Autobot status display (no toggle button) -->
            <div id="autobotStatusSection" style="display: none; margin-top: 10px; opacity: 1; transition: opacity 0.3s ease;">
                <div id="autobotStatusBtn" style="width: 100%; padding: 12px 16px; background: linear-gradient(135deg, #10b981, #059669); color: #fff; border: none; border-radius: 10px; font-size: 13px; font-weight: 700; box-shadow: 0 4px 12px rgba(16,185,129,0.4); min-height: 44px; text-align: center;">
                    ü§ñ –ê–≤—Ç–æ–±–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω
                </div>
            </div>
        </div>

        <button class="tap-button" onclick="tap(); return false;" type="button" style="outline:none!important;box-shadow:none!important;-webkit-tap-highlight-color:transparent!important;">
            <svg width="220" height="220" viewBox="0 0 220 220" style="width:100%;height:100%;">
                <defs>
                    <radialGradient id="tapGrad" cx="50%" cy="50%">
                        <stop offset="0%" style="stop-color:#667eea;stop-opacity:1" />
                        <stop offset="100%" style="stop-color:#764ba2;stop-opacity:0.9" />
                    </radialGradient>
                    <filter id="glow">
                        <feGaussianBlur stdDeviation="4" result="coloredBlur"/>
                        <feMerge>
                            <feMergeNode in="coloredBlur"/>
                            <feMergeNode in="SourceGraphic"/>
                        </feMerge>
                    </filter>
                </defs>
                <circle cx="110" cy="110" r="100" fill="url(#tapGrad)" filter="url(#glow)" opacity="0.9"/>
                <circle cx="110" cy="110" r="90" fill="none" stroke="#f093fb" stroke-width="2" opacity="0.6"/>
                <text x="110" y="150" font-size="100" text-anchor="middle" fill="#fff" font-weight="bold" style="filter: drop-shadow(0 0 15px rgba(255, 192, 203, 0.8));">üí∞</text>
            </svg>
        </button>


        <div class="buttons">
            <a href="#" class="btn" onclick="openShop(event)">
                <div class="btn-emoji">üõí</div>
                <div>–ú–∞–≥–∞–∑–∏–Ω</div>
            </a>
            <a href="#" class="btn" onclick="openMining(event)">
                <div class="btn-emoji">üè≠</div>
                <div>–ú–∞–π–Ω–∏–Ω–≥</div>
            </a>
            <a href="#" class="btn" onclick="openCards(event)">
                <div class="btn-emoji">üí≥</div>
                <div>–ö–∞—Ä—Ç–æ—á–∫–∏</div>
            </a>
            <a href="#" class="btn" onclick="openSupport(event)" id="supportBtn" style="position:relative;">
                <div class="btn-emoji">üí¨</div>
                <div>–ü–æ–¥–¥–µ—Ä–∂–∫–∞</div>
                <span id="supportBadge" style="display:none;position:absolute;top:5px;right:5px;background:linear-gradient(135deg,#ef4444,#dc2626);color:#fff;padding:3px 7px;border-radius:10px;font-size:11px;font-weight:700;box-shadow:0 2px 8px rgba(239,68,68,0.5);animation:pulse 2s ease-in-out infinite;">0</span>
            </a>
            <a href="#" class="btn" onclick="openReferrals(event)">
                <div class="btn-emoji">üë•</div>
                <div>–†–µ—Ñ–µ—Ä–∞–ª—ã</div>
            </a>
            <a href="#" class="btn" onclick="openWithdrawModal(event)">
                <div class="btn-emoji">üí∏</div>
                <div>–í—ã–≤–æ–¥</div>
            </a>
            <a href="#" class="btn" onclick="openDailyBonus(event)">
                <div class="btn-emoji">üéÅ</div>
                <div>–ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</div>
            </a>
            <a href="#" class="btn" onclick="openBuyCurrency(event)" style="background:linear-gradient(135deg,rgba(255,215,0,0.3),rgba(255,140,0,0.3));border:2px solid rgba(255,215,0,0.6);box-shadow:0 4px 15px rgba(255,215,0,0.3);">
                <div class="btn-emoji">‚≠ê</div>
                <div style="font-weight:700;">–ö—É–ø–∏—Ç—å –≤–∞–ª—é—Ç—É</div>
            </a>
        </div>
    </div>

    <!-- Stats Modal -->
    <div id="statsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</div>
                <button class="close-btn" onclick="closeModal('statsModal')">‚úï</button>
            </div>
            <div class="stats-window" id="statsContent"></div>
        </div>
    </div>

    <!-- Shop Modal -->
    <div id="shopModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üõí –ú–∞–≥–∞–∑–∏–Ω</div>
                <button class="close-btn" onclick="closeModal('shopModal')">‚úï</button>
            </div>
            <div class="shop-category">
                <div class="category-title">‚ö° –ë—É—Å—Ç—ã</div>
                <div id="boostsList"></div>
            </div>
            <div class="shop-category">
                <div class="category-title">ü§ñ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è</div>
                <div id="automationList"></div>
            </div>
            <div class="shop-category">
                <div class="category-title">‚ö° –≠–Ω–µ—Ä–≥–∏—è</div>
                <div id="energyList"></div>
            </div>
            <div class="shop-category">
                <div class="category-title">üí≥ –ö–∞—Ä—Ç–æ—á–∫–∏</div>
                <div id="cardsList"></div>
            </div>
        </div>
    </div>

    <!-- Mining Modal -->
    <div id="miningModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üè≠ –ú–∞–π–Ω–∏–Ω–≥</div>
                <button class="close-btn" onclick="closeModal('miningModal')">‚úï</button>
            </div>
            <div id="machinesList"></div>
            <button class="btn" onclick="closeModal('miningModal'); openShop(event)">‚ûï –ö—É–ø–∏—Ç—å –º–∞—à–∏–Ω—É</button>
        </div>
    </div>

    <!-- Cards Modal -->
    <div id="cardsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üí≥ –ú–æ–∏ –ö–∞—Ä—Ç–æ—á–∫–∏</div>
                <button class="close-btn" onclick="closeModal('cardsModal')">‚úï</button>
            </div>
            <div id="myCardsList"></div>
        </div>
    </div>

    <!-- Withdraw Modal -->
    <div id="withdrawModal" class="modal">
        <div class="modal-content" style="max-height: 80vh; overflow-y: auto;">
            <div class="modal-header">
                <div class="modal-title">üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</div>
                <button class="close-btn" onclick="closeModal('withdrawModal')">‚úï</button>
            </div>
            <div id="withdrawContent"></div>
        </div>
    </div>

    <!-- Referrals Modal -->
    <div id="referralsModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <div class="modal-title">üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞</div>
                <button class="close-btn" onclick="closeModal('referralsModal')">‚úï</button>
            </div>
            <div class="referral-benefits">
                <div class="benefit-item">‚úÖ 5% –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ –æ—Ç –ø—Ä–∏–≥–ª–∞—à–µ–Ω–Ω—ã—Ö</div>
                <div class="benefit-item">üéÅ 100 ü™ô –∑–∞ –∫–∞–∂–¥–æ–≥–æ —Ä–µ—Ñ–µ—Ä–∞–ª–∞</div>
                <div class="benefit-item">üí∞ –î–æ—Ö–æ–¥ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏</div>
            </div>
            <div class="stats-window">
                <div class="stats-row">
                    <span class="stats-label">–†–µ—Ñ–µ—Ä–∞–ª–æ–≤</span>
                    <span class="stats-value" id="refCount">0</span>
                </div>
                <div class="stats-row">
                    <span class="stats-label">–†–µ—Ñ–µ—Ä–∞–ª—å–Ω—ã–π –¥–æ—Ö–æ–¥</span>
                    <span class="stats-value" id="refIncome">0 ü™ô</span>
                </div>
            </div>
            <div style="margin-top: 20px;">
                <div style="margin-bottom: 10px; font-weight: bold;">–í–∞—à–∞ —Ä–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è —Å—Å—ã–ª–∫–∞:</div>
                <div class="referral-link" id="refLink">-</div>
                <button class="btn" onclick="copyRefLink()">üìã –ö–æ–ø–∏—Ä–æ–≤–∞—Ç—å —Å—Å—ã–ª–∫—É</button>
            </div>
        </div>
    </div>

    <script>
        const tg = window.Telegram.WebApp;
        tg.ready();
        tg.expand();

        // Make user globally available
        window.user = tg.initDataUnsafe?.user;
        if (window.user) {
            const usernameEl = document.getElementById('username');
            if (usernameEl) {
                usernameEl.textContent = window.user.first_name || '–ú–∞–π–Ω–µ—Ä';
            }
        }

        let energyRegenInterval;

        // VIP Status Management
        function loadVIPStatus(userData) {
            const vipLevel = userData.vip_level || 0;
            const vipBadge = userData.vip_badge || '';
            const hasPremium = userData.has_premium_support || false;
            const hasGolden = userData.has_golden_profile || false;
            const hasTop = userData.has_top_place || false;
            const hasUnique = userData.has_unique_design || false;
            
            // Buttons are now in the header, no need to add them dynamically
            
            if (vipLevel > 0) {
                const badgeEl = document.getElementById('vipBadge');
                const privEl = document.getElementById('vipPrivileges');
                
                // VIP badge display
                const badges = {
                    'bronze_vip': 'ü•â BRONZE VIP',
                    'silver_vip': 'ü•à SILVER VIP',
                    'gold_vip': 'ü•á GOLD VIP',
                    'platinum_vip': 'üíé PLATINUM VIP',
                    'diamond_vip': 'üí† DIAMOND VIP',
                    'absolute_vip': 'üëë ABSOLUTE VIP'
                };
                
                if (badgeEl && vipBadge && vipLevel > 0) {
                    badgeEl.innerHTML = '<span style="background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;padding:4px 10px;border-radius:8px;font-size:10px;font-weight:700;">' + (badges[vipBadge] || 'VIP') + '</span>';
                    badgeEl.style.display = 'inline';
                } else if (badgeEl) {
                    badgeEl.style.display = 'none';
                }
                
                // VIP privileges display
                if (privEl) {
                    const privs = [];
                    if (hasPremium && vipLevel > 0) privs.push('‚≠ê Premium Support');
                    if (hasGolden && vipLevel > 0) privs.push('üåü Golden Profile');
                    if (hasTop && vipLevel > 0) privs.push('üèÜ Top Place');
                    if (hasUnique && vipLevel > 0) privs.push('‚ú® Unique Design');
                    
                    if (privs.length > 0) {
                        privEl.textContent = privs.join(' ‚Ä¢ ');
                        privEl.style.display = 'block';
                    } else {
                        privEl.style.display = 'none';
                    }
                }
                
                // Apply VIP styling to header
                if (hasGolden && document.getElementById('mainTitle')) {
                    document.getElementById('mainTitle').style.background = 'linear-gradient(135deg, #ffd700, #ffed4e)';
                    document.getElementById('mainTitle').style.webkitBackgroundClip = 'text';
                    document.getElementById('mainTitle').style.webkitTextFillColor = 'transparent';
                    document.getElementById('mainTitle').style.filter = 'drop-shadow(0 0 20px rgba(255,215,0,0.5))';
                }
                
                // Add VIP premium background effect
                if (vipLevel >= 3) {
                    let bgExists = document.querySelector('.vip-golden-bg');
                    if (!bgExists) {
                        const goldenBg = document.createElement('div');
                        goldenBg.className = 'vip-golden-bg';
                        document.body.appendChild(goldenBg);
                        
                        // Add premium shine effect
                        const premiumShine = document.createElement('div');
                        premiumShine.className = 'vip-premium-shine';
                        document.body.appendChild(premiumShine);
                    }
                }
                
                // Add VIP particle effects
                if (vipLevel >= 4) {
                    startVIPParticles();
                }
                
                // Add Aura effect for VIP level 6
                if (vipLevel >= 6) {
                    addVIPAura();
                    addRainbowEffects();
                }
                
                // Apply VIP glow to all clickable elements
                if (vipLevel >= 3) {
                    document.querySelectorAll('.btn, .tap-button').forEach(el => {
                        el.classList.add('vip-glow-box');
                    });
                }
                
                // Show VIP sections if user has appropriate level
                if (vipLevel >= 5) {
                    showVIPMiningSection();
                }
                
                if (vipLevel >= 4) {
                    showVIPEventsSection();
                }
            }
        }
        
        function showVIPMiningSection() {
            // This will be called when VIP user opens mining modal
            const miningModal = document.getElementById('miningModal2');
            if (miningModal && !miningModal.querySelector('#vipMiningSection')) {
                const vipSection = document.createElement('div');
                vipSection.innerHTML = document.getElementById('vipMiningSection')?.innerHTML || '';
                if (miningModal.querySelector('.machinesList')) {
                    miningModal.querySelector('.machinesList').appendChild(vipSection);
                }
            }
        }
        
        function showVIPEventsSection() {
            // VIP events accessible from menu
            // Will be integrated into main interface
        }
        
        function openVIPProfileModal() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(userData => {
                const vipLevel = userData.vip_level || 0;
                const badges = {
                    'bronze_vip': 'ü•â BRONZE VIP',
                    'silver_vip': 'ü•à SILVER VIP',
                    'gold_vip': 'ü•á GOLD VIP',
                    'platinum_vip': 'üíé PLATINUM VIP',
                    'diamond_vip': 'üí† DIAMOND VIP',
                    'absolute_vip': 'üëë ABSOLUTE VIP'
                };
                
                const savedPhoto = localStorage.getItem('vip_profile_photo') || '';
                const photoPlaceholder = 'data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48ZGVmcz48bGluZWFyR3JhZGllbnQgaWQ9ImciIHgxPSIwJSIgeTE9IjAlIiB4Mj0iMTAwJSIgeTI9IjEwMCUiPjxzdG9wIG9mZnNldD0iMCUiIHN0b3AtY29sb3I9IiM2NjdFZUEiLz48c3RvcCBvZmZzZXQ9IjEwMCUiIHN0b3AtY29sb3I9IiM3NjRCRUEiLz48L2xpbmVhckdyYWRpZW50PjwvZGVmcz48cmVjdCB3aWR0aD0iMTIwIiBoZWlnaHQ9IjEyMCIgZmlsbD0idXJsKCNnKSIgcng9IjUwJSIvPjx0ZXh0IHg9IjYwIiB5PSI2NSIgZm9udC1zaXplPSI1MCIgZmlsbD0iI2ZmZiIgdGV4dC1hbmNob3I9Im1pZGRsZSIgZHk9Ii4zZW0iIGZvbnQtZmFtaWx5PSJBcmlhbCI+4piCPC90ZXh0Pjwvc3ZnPg==';
                
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.style.zIndex = '10000';
                modal.innerHTML = `
                    <div class="modal-content" style="max-width: 400px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;border: 2px solid rgba(167,139,250,0.4);box-shadow: 0 10px 40px rgba(167,139,250,0.3);">
                        <div style="background:linear-gradient(135deg,#a78bfa,#c084fc,#d946ef);padding:24px;border-radius:22px 22px 0 0;text-align:center;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:18px;">
                                <h2 style="font-size: 24px; color: #fff; margin: 0; font-weight: 900;">üëë ${userData.username || '–ú–∞–π–Ω–µ—Ä'}</h2>
                                <button onclick="this.closest('.modal').remove()" style="background:rgba(255,255,255,0.2);border:2px solid rgba(255,255,255,0.4);border-radius:50%;width:38px;height:38px;color:#fff;cursor:pointer;font-size:20px;font-weight:800;">‚úï</button>
                            </div>
                            
                            <div style="position:relative;width:110px;height:110px;margin:0 auto 18px;border-radius:50%;background:linear-gradient(135deg,#a78bfa,#c084fc,#d946ef);padding:4px;cursor:pointer;transition:all 0.3s ease;" onclick="document.getElementById('photoInput').click()" onmouseover="this.style.transform='scale(1.05)'" onmouseout="this.style.transform='scale(1)'">
                                <img id="profilePhoto" src="${savedPhoto || photoPlaceholder}" style="width:100%;height:100%;border-radius:50%;object-fit:cover;border:3px solid rgba(255,255,255,0.3);">
                                <div style="position:absolute;bottom:0;right:0;width:36px;height:36px;background:#000;border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:18px;border:3px solid #fff;box-shadow:0 2px 10px rgba(0,0,0,0.3);">üì∑</div>
                            </div>
                            <input type="file" id="photoInput" accept="image/*" style="display:none;" onchange="handlePhotoUpload(event)">
                            
                            <div style="background:rgba(0,0,0,0.3);padding:12px;border-radius:12px;color:#fff;margin-bottom:10px;">
                                <div style="font-size:18px;font-weight:900;color:#fff;">${vipLevel > 0 ? (badges[userData.vip_badge || ''] || 'VIP') + ' (–£—Ä–æ–≤–µ–Ω—å ' + vipLevel + ')' : '–û–±—ã—á–Ω—ã–π –∏–≥—Ä–æ–∫'}</div>
                                <div style="font-size:13px;margin-top:5px;opacity:0.8;color:#fff;">${userData.username || '–ú–∞–π–Ω–µ—Ä'}</div>
                            </div>
                        </div>
                        
                        <div style="padding:20px;">
                            ${vipLevel >= 3 ? `
                            <div style="background:linear-gradient(135deg,rgba(255,215,0,0.1),rgba(255,255,255,0.05));padding:12px;border-radius:12px;border:1px solid rgba(255,215,0,0.2);margin-bottom:12px;">
                                <div style="font-size:13px;font-weight:700;margin-bottom:8px;color:#ffd700;">‚ú® VIP –ü–†–ò–í–ò–õ–ï–ì–ò–ò</div>
                                <div style="font-size:11px;color:#fff;line-height:1.8;">
                                    ${userData.has_premium_support ? '‚≠ê Premium Support ' : ''}
                                    ${userData.has_golden_profile ? 'üåü Golden Profile ' : ''}
                                    ${userData.has_top_place ? 'üèÜ Top Place ' : ''}
                                    ${userData.has_unique_design ? '‚ú® Unique Design' : ''}
                                </div>
                            </div>
                            ` : `
                            <button onclick="openBuyVIPModal(); this.closest('.modal').remove();" style="width:100%;padding:14px;background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;border:none;border-radius:12px;cursor:pointer;font-weight:800;font-size:15px;margin-bottom:15px;box-shadow:0 4px 15px rgba(255,215,0,0.5);">üëë –ö—É–ø–∏—Ç—å VIP</button>
                            `}
                            
                            <div style="background:rgba(0,0,0,0.2);padding:15px;border-radius:12px;margin-bottom:15px;border:1px solid rgba(255,255,255,0.2);">
                                <div style="font-size:14px;font-weight:700;margin-bottom:12px;color:#fff;text-align:center;">üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê</div>
                                <div style="font-size:12px;line-height:1.9;">
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">üí∞ –ö–æ–∏–Ω—ã:</span>
                                        <span data-stat="coins" style="font-weight:700;color:#fff;">${Math.floor(userData.coins || 0)}</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">üíé QuanHash:</span>
                                        <span data-stat="quanhash" style="font-weight:700;color:#fff;">${Math.floor(userData.quanhash || 0)}</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">‚ö° –≠–Ω–µ—Ä–≥–∏—è:</span>
                                        <span data-stat="energy" style="font-weight:700;color:#fff;">${Math.floor(userData.energy || 0)}</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">üéÆ –£—Ä–æ–≤–µ–Ω—å:</span>
                                        <span style="font-weight:700;color:#fff;">${userData.level || 1}</span>
                                    </div>
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">üëÜ –í—Å–µ–≥–æ —Ç–∞–ø–æ–≤:</span>
                                        <span data-stat="total_taps" style="font-weight:700;color:#fff;">${Math.floor(userData.total_taps || 0)}</span>
                                    </div>
                                    ${userData.active_multiplier > 1 ? `
                                    <div style="display:flex;justify-content:space-between;padding:10px;border-bottom:1px solid rgba(255,255,255,0.1);">
                                        <span style="color:#94a3b8;">‚ö° –£—Å–∏–ª–∏—Ç–µ–ª—å —Ç–∞–ø–∞:</span>
                                        <span style="font-weight:700;color:#fbbf24;">+${userData.active_multiplier} —Ç–∞–ø–æ–≤</span>
                                    </div>
                                    ` : ''}
                                    <div style="display:flex;justify-content:space-between;padding:10px;">
                                        <span style="color:#94a3b8;">üíµ –û–±—â–∏–π –¥–æ—Ö–æ–¥:</span>
                                        <span data-stat="total_earned" style="font-weight:700;color:#10b981;">${Math.floor(userData.total_earned || 0)}</span>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- My Purchases Button -->
                            <div id="myPurchasesBtn" style="margin-top:15px;cursor:pointer;padding:14px;background:linear-gradient(135deg,#10b981,#059669);border-radius:12px;text-align:center;font-weight:800;font-size:15px;color:#fff;transition:all 0.3s;box-shadow:0 4px 12px rgba(16,185,129,0.3);" onmouseover="this.style.transform='scale(1.02)';this.style.boxShadow='0 6px 16px rgba(16,185,129,0.4)'" onmouseout="this.style.transform='scale(1)';this.style.boxShadow='0 4px 12px rgba(16,185,129,0.3)'">
                                üõçÔ∏è –ú–æ–∏ –ø–æ–∫—É–ø–∫–∏
                            </div>
                            
                            <button onclick="this.closest('.modal').remove()" style="width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:15px;margin-top:10px;">–ó–∞–∫—Ä—ã—Ç—å</button>
                        </div>
                    </div>
                `;
                document.body.appendChild(modal);
                modal.onclick = (e) => {if(e.target === modal) modal.remove();};
                
                // Add click handler for My Purchases button
                const purchasesBtn = document.getElementById('myPurchasesBtn');
                if (purchasesBtn) {
                    purchasesBtn.addEventListener('click', () => {
                        openMyPurchases(userData);
                    });
                }
            });
        }
        
        function openMyPurchases(userData) {
            // Close profile modal first
            document.querySelectorAll('.modal.active').forEach(m => m.remove());
            
            // Fetch detailed purchase data
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const modal = document.createElement('div');
                modal.className = 'modal active';
                modal.style.zIndex = '10001';
                
                // Get current time for time remaining calculations
                const now = new Date();
                
                let purchasesContent = `
                    <div style="background:linear-gradient(135deg,rgba(10,14,39,0.98),rgba(15,23,42,0.98));border-radius:24px;border:2px solid rgba(167,139,250,0.4);box-shadow:0 10px 40px rgba(167,139,250,0.3);max-width:450px;max-height:85vh;overflow-y:auto;">
                        <div style="background:linear-gradient(135deg,#10b981,#059669);padding:20px;border-radius:22px 22px 0 0;text-align:center;">
                            <h2 style="font-size:22px;color:#fff;margin:0;font-weight:900;">üõçÔ∏è –ú–û–ò –ü–û–ö–£–ü–ö–ò</h2>
                            <button onclick="this.closest('.modal').remove()" style="position:absolute;top:20px;right:20px;background:rgba(255,255,255,0.2);border:2px solid rgba(255,255,255,0.4);border-radius:50%;width:36px;height:36px;color:#fff;cursor:pointer;font-size:18px;font-weight:800;">‚úï</button>
                        </div>
                        <div style="padding:20px;">
                `;
                
                // Active Boosts
                if (data.active_multiplier > 1 || (data.boost_expires_at && new Date(data.boost_expires_at) > now)) {
                    purchasesContent += `
                        <div style="margin-bottom:16px;">
                            <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(118,75,162,0.2);border-radius:8px;">üìà –ê–ö–¢–ò–í–ù–´–ï –ë–£–°–¢–´</div>
                    `;
                    
                    if (data.active_multiplier > 1) {
                        if (data.boost_expires_at) {
                            const expiresAt = new Date(data.boost_expires_at);
                            if (expiresAt > now) {
                                const remaining = Math.max(0, Math.floor((expiresAt - now) / 1000));
                                const hours = Math.floor(remaining / 3600);
                                const minutes = Math.floor((remaining % 3600) / 60);
                                const seconds = remaining % 60;
                                
                                purchasesContent += `
                                    <div style="background:rgba(118,75,162,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(118,75,162,0.5);">
                                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                            <span style="color:#fff;font-weight:700;font-size:13px;">üî• –î–æ—Ö–æ–¥ x${data.active_multiplier}</span>
                                            <span style="color:#4ade80;font-weight:700;font-size:13px;">+${(data.active_multiplier - 1) * 100}%</span>
                                        </div>
                                        <div style="color:#fbbf24;font-size:11px;font-weight:600;">‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: ${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}</div>
                                    </div>
                                `;
                            } else {
                                purchasesContent += `
                                    <div style="background:rgba(239,68,68,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(239,68,68,0.5);">
                                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                            <span style="color:#fff;font-weight:700;font-size:13px;">üî• –î–æ—Ö–æ–¥ x${data.active_multiplier}</span>
                                            <span style="color:#ef4444;font-weight:700;font-size:13px;">–ò—Å—Ç—ë–∫</span>
                                        </div>
                                    </div>
                                `;
                            }
                        } else {
                            purchasesContent += `
                                <div style="background:rgba(118,75,162,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(118,75,162,0.5);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                        <span style="color:#fff;font-weight:700;font-size:13px;">üî• –î–æ—Ö–æ–¥ x${data.active_multiplier}</span>
                                        <span style="color:#4ade80;font-weight:700;font-size:13px;">+${(data.active_multiplier - 1) * 100}%</span>
                                    </div>
                                    <div style="color:#86efac;font-size:11px;font-weight:600;">‚ú® –ù–∞–≤—Å–µ–≥–¥–∞</div>
                                </div>
                            `;
                        }
                    }
                    
                    purchasesContent += `</div>`;
                }
                
                // Tap boost status
                if (data.active_multiplier > 1) {
                    purchasesContent += `
                        <div style="margin-bottom:16px;">
                            <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(251,191,36,0.2);border-radius:8px;">‚ö° –£–°–ò–õ–ò–¢–ï–õ–¨ –¢–ê–ü–ê</div>
                            <div style="background:rgba(251,191,36,0.3);padding:12px;border-radius:10px;border:1px solid rgba(251,191,36,0.5);">
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                    <span style="color:#fff;font-weight:700;font-size:13px;">+${data.active_multiplier} —Ç–∞–ø–æ–≤ –∑–∞ –Ω–∞–∂–∞—Ç–∏–µ</span>
                                    <span style="color:#4ade80;font-weight:700;font-size:13px;">üü¢ –ê–∫—Ç–∏–≤–µ–Ω</span>
                                </div>
                                <div style="color:#86efac;font-size:11px;font-weight:600;">‚ú® –ù–∞–≤—Å–µ–≥–¥–∞</div>
                            </div>
                        </div>
                    `;
                }
                
                // Autobot status
                if (data.auto_tap_level > 0 && data.auto_tap_expires_at) {
                    const expiresAt = new Date(data.auto_tap_expires_at);
                    if (expiresAt > now) {
                        const remaining = Math.max(0, Math.floor((expiresAt - now) / 1000));
                        const days = Math.floor(remaining / 86400);
                        const hours = Math.floor((remaining % 86400) / 3600);
                        const minutes = Math.floor((remaining % 3600) / 60);
                        
                        purchasesContent += `
                            <div style="margin-bottom:16px;">
                                <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(16,185,129,0.2);border-radius:8px;">ü§ñ –ê–í–¢–û–ë–û–¢</div>
                                <div style="background:rgba(16,185,129,0.3);padding:12px;border-radius:10px;border:1px solid rgba(16,185,129,0.5);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                        <span style="color:#fff;font-weight:700;font-size:13px;">–£—Ä–æ–≤–µ–Ω—å ${data.auto_tap_level} | –°–∫–æ—Ä–æ—Å—Ç—å ${data.auto_tap_speed}/—Å–µ–∫</span>
                                        <span style="color:#4ade80;font-weight:700;font-size:13px;">${data.auto_tap_enabled ? 'üü¢ –ê–∫—Ç–∏–≤–µ–Ω' : '‚ö™ –û—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω'}</span>
                                    </div>
                                    <div style="color:#94a3b8;font-size:11px;font-weight:600;">‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: ${days}–¥ ${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}</div>
                                </div>
                            </div>
                        `;
                    }
                }
                
                // Group and display purchased cards
                if (data.cards && data.cards.length > 0) {
                    const cardGroups = {};
                    data.cards.forEach(card => {
                        if (!cardGroups[card.name]) {
                            cardGroups[card.name] = { count: 0, income: card.income || 0 };
                        }
                        cardGroups[card.name].count++;
                    });
                    
                    const cardsList = Object.entries(cardGroups);
                    if (cardsList.length > 0) {
                        purchasesContent += `
                            <div style="margin-bottom:16px;">
                                <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(59,130,246,0.2);border-radius:8px;">üí≥ –ú–û–ò –ö–ê–†–¢–û–ß–ö–ò</div>
                        `;
                        
                        cardsList.forEach(([name, info]) => {
                            purchasesContent += `
                                <div style="background:rgba(59,130,246,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(59,130,246,0.5);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                        <span style="color:#fff;font-weight:700;font-size:13px;">${name} ${info.count > 1 ? `x${info.count}` : ''}</span>
                                        <span style="color:#4ade80;font-weight:700;font-size:13px;">+${Math.floor(info.income * info.count)}/–º–∏–Ω</span>
                                    </div>
                                    <div style="color:#86efac;font-size:11px;font-weight:600;">‚ú® –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞</div>
                                </div>
                            `;
                        });
                        
                        purchasesContent += `</div>`;
                    }
                }
                
                // Group and display purchased machines
                if (data.machines && data.machines.length > 0) {
                    const machineGroups = {};
                    data.machines.forEach(machine => {
                        if (!machineGroups[machine.name]) {
                            machineGroups[machine.name] = { count: 0, hash_rate: machine.hash_rate || 0 };
                        }
                        machineGroups[machine.name].count++;
                    });
                    
                    const machinesList = Object.entries(machineGroups);
                    if (machinesList.length > 0) {
                        purchasesContent += `
                            <div style="margin-bottom:16px;">
                                <div style="font-size:15px;font-weight:800;color:#fff;margin-bottom:10px;padding:8px;background:rgba(168,85,247,0.2);border-radius:8px;">üè≠ –ú–û–ò –ú–ê–ô–ù–ò–ù–ì–ò</div>
                        `;
                        
                        machinesList.forEach(([name, info]) => {
                            purchasesContent += `
                                <div style="background:rgba(168,85,247,0.3);padding:12px;border-radius:10px;margin-bottom:8px;border:1px solid rgba(168,85,247,0.5);">
                                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:5px;">
                                        <span style="color:#fff;font-weight:700;font-size:13px;">${name} ${info.count > 1 ? `x${info.count}` : ''}</span>
                                        <span style="color:#4ade80;font-weight:700;font-size:13px;">+${Math.floor(info.hash_rate * info.count)}/—Å–µ–∫</span>
                                    </div>
                                    <div style="color:#86efac;font-size:11px;font-weight:600;">‚ú® –ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –º–∞–π–Ω–∏–Ω–≥-—Ñ–µ—Ä–º–∞</div>
                                </div>
                            `;
                        });
                        
                        purchasesContent += `</div>`;
                    }
                }
                
                purchasesContent += `
                        </div>
                    </div>
                `;
                
                modal.innerHTML = purchasesContent;
                document.body.appendChild(modal);
                modal.onclick = (e) => {if(e.target === modal) modal.remove();};
            })
            .catch(err => {
                console.error('Error loading purchases:', err);
                tg.showAlert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –ø–æ–∫—É–ø–æ–∫');
            });
        }
        
        function handlePhotoUpload(event) {
            const file = event.target.files[0];
            if (file) {
                const reader = new FileReader();
                reader.onload = (e) => {
                    const photoUrl = e.target.result;
                    localStorage.setItem('vip_profile_photo', photoUrl);
                    document.getElementById('profilePhoto').src = photoUrl;
                    const icon = document.querySelector('.vip-profile-icon');
                    if (icon) {
                        icon.innerHTML = '';
                        const img = document.createElement('img');
                        img.src = photoUrl;
                        icon.appendChild(img);
                    }
                };
                reader.readAsDataURL(file);
            }
        }
        
        function openVIPTopLeaders() {
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.style.zIndex = '10000';
            
            function loadTopData() {
                fetch('/api/top_users', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({limit: 999})
                })
                .then(res => {
                    console.log('[TOP_LEADERS] Response status:', res.status);
                    return res.json();
                })
                .then(topData => {
                    console.log('[TOP_LEADERS] Received data:', topData);
                    const topUsers = topData.users || [];
                    console.log('[TOP_LEADERS] Users count:', topUsers.length);
                    
                    // Sort: VIPs first, then by total_earned descending
                    const sortedUsers = [...topUsers].sort((a, b) => {
                        const aVip = a.vip_level || 0;
                        const bVip = b.vip_level || 0;
                        if (aVip !== bVip) return bVip - aVip; // VIPs first
                        return (b.total_earned || 0) - (a.total_earned || 0);
                    });
                    
                    let topHTML = sortedUsers.map((u, idx) => {
                        const medal = idx === 0 ? 'ü•á' : idx === 1 ? 'ü•à' : idx === 2 ? 'ü•â' : '';
                        const rankColor = idx === 0 ? '#ffd700' : idx === 1 ? '#c0c0c0' : idx === 2 ? '#cd7f32' : '#94a3b8';
                        const isVIP = u.vip_level && u.vip_level > 0;
                        const vipBadge = isVIP ? `<span style="background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;padding:2px 8px;border-radius:8px;font-size:10px;font-weight:800;">üëë VIP ${u.vip_level}</span>` : '';
                        
                        const vipNames = {1: 'Bronze', 2: 'Silver', 3: 'Gold', 4: 'Platinum', 5: 'Diamond', 6: 'Absolute'};
                        const vipName = vipNames[u.vip_level] || '';
                        const vipInfo = isVIP ? `<div style="font-size:10px;color:#ffd700;margin-top:2px;">${vipName} VIP</div>` : '';
                        
                        const passiveIncome = (u.passive_income || 0).toLocaleString();
                        const totalEarned = (u.total_earned || 0).toLocaleString();
                        const totalTaps = (u.total_taps || 0).toLocaleString();
                        const quanhash = (u.quanhash || 0).toLocaleString();
                        
                        return `<div style="padding:14px;background:${isVIP ? 'linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,255,255,0.08))' : 'rgba(0,0,0,0.25)'};border-radius:12px;margin-bottom:12px;border:2px solid ${isVIP ? 'rgba(255,215,0,0.4)' : 'rgba(255,255,255,0.1)'};">
                            <div style="display:flex;align-items:center;gap:14px;margin-bottom:10px;">
                                <div style="width:50px;height:50px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:50%;display:flex;align-items:center;justify-content:center;font-size:24px;font-weight:900;color:${rankColor};${idx < 3 ? 'box-shadow:0 0 15px rgba(255,215,0,0.5);' : ''}">${medal || (idx + 1)}</div>
                                <div style="flex:1;">
                                    <div style="font-size:16px;font-weight:800;color:#fff;margin-bottom:3px;">${u.username}</div>
                                    <div style="font-size:11px;color:#94a3b8;">–£—Ä–æ–≤–µ–Ω—å ${u.level || 1}</div>
                                    ${vipInfo}
                                    ${vipBadge}
                                </div>
                            </div>
                            <div style="display:grid;grid-template-columns:1fr 1fr;gap:8px;margin-top:10px;padding-top:10px;border-top:1px solid rgba(255,255,255,0.1);">
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">üí∞ –ö–æ–∏–Ω—ã</div>
                                    <div style="font-size:14px;font-weight:800;color:#ffd700;">${u.coins ? (u.coins).toLocaleString() : 0}</div>
                                </div>
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">üíé QuanHash</div>
                                    <div style="font-size:14px;font-weight:800;color:#10b981;">${quanhash}</div>
                                </div>
                                <div style="padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">üìà –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥</div>
                                    <div style="font-size:14px;font-weight:800;color:#f093fb;">+${passiveIncome}/—á–∞—Å</div>
                                </div>
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">üíµ –í—Å–µ–≥–æ –∑–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</div>
                                    <div style="font-size:14px;font-weight:800;color:#10b981;">${totalEarned}</div>
                                </div>
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">üëÜ –í—Å–µ–≥–æ —Ç–∞–ø–æ–≤</div>
                                    <div style="font-size:14px;font-weight:800;color:#94a3b8;">${totalTaps}</div>
                                </div>
                                <div style="background:rgba(0,0,0,0.3);padding:8px;border-radius:8px;">
                                    <div style="font-size:10px;color:#94a3b8;margin-bottom:3px;">üèÜ –†–µ–π—Ç–∏–Ω–≥</div>
                                    <div style="font-size:14px;font-weight:800;color:#667eea;">${totalEarned} ü™ô</div>
                                </div>
                            </div>
                        </div>`;
                    }).join('');
                    
                    const contentDiv = modal.querySelector('#topLeadersContent');
                    if (contentDiv) {
                        contentDiv.innerHTML = topUsers.length > 0 ? topHTML : '<div style="text-align:center;color:#94a3b8;padding:40px;font-size:14px;">–†–µ–π—Ç–∏–Ω–≥ –ø—É—Å—Ç</div>';
                    }
                })
                .catch(err => {
                    console.error('[TOP_LEADERS] Error loading top users:', err);
                    const contentDiv = modal.querySelector('#topLeadersContent');
                    if (contentDiv) {
                        contentDiv.innerHTML = '<div style="text-align:center;color:#ef4444;padding:40px;font-size:14px;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ä–µ–π—Ç–∏–Ω–≥–∞</div>';
                    }
                });
            }
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 450px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 20px;border: 2px solid rgba(102,126,234,0.4);">
                    <div style="background:linear-gradient(135deg,#667eea,#764ba2);padding:20px;border-radius:18px 18px 0 0;text-align:center;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                            <h2 style="font-size: 24px; color: #fff; margin: 0; font-weight: 900;">üèÜ –¢–û–ü –õ–ò–î–ï–†–´</h2>
                            <button onclick="this.closest('.modal').remove(); if(window.topLeadersInterval) clearInterval(window.topLeadersInterval);" style="background:rgba(255,255,255,0.2);border:2px solid rgba(255,255,255,0.3);border-radius:50%;width:36px;height:36px;color:#fff;cursor:pointer;font-size:20px;font-weight:800;">‚úï</button>
                        </div>
                        <div style="font-size:13px;color:rgba(255,255,255,0.8);">üîÑ –õ—É—á—à–∏–µ –∏–≥—Ä–æ–∫–∏ Quantum Nexus (–ê–≤—Ç–æ–æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ)</div>
                    </div>
                    
                    <div style="padding:20px;">
                        <div id="topLeadersContent" style="max-height:550px;overflow-y:auto;">
                            <div style="text-align:center;color:#94a3b8;padding:40px;font-size:14px;">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
                        </div>
                        
                        <button onclick="this.closest('.modal').remove(); if(window.topLeadersInterval) clearInterval(window.topLeadersInterval);" style="width:100%;margin-top:15px;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:15px;">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            modal.onclick = (e) => {if(e.target === modal) { modal.remove(); if(window.topLeadersInterval) clearInterval(window.topLeadersInterval); }};
            
            // Load data immediately
            loadTopData();
            
            // Auto-refresh every 2.5 seconds
            window.topLeadersInterval = setInterval(loadTopData, 2500);
        }
        
        function addVIPAura() {
            let aura = document.querySelector('.vip-aura');
            if (!aura) {
                aura = document.createElement('div');
                aura.className = 'vip-aura';
                document.body.appendChild(aura);
            }
        }
        
        function openBuyVIPModal() {
            const vipPackages = [
                {level: 1, name: 'Bronze VIP', stars: 300, color: '#cd7f32', badge: 'ü•â', benefits: ['‚≠ê Premium Support', '‚ú® –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä', '‚ûï 20% –∫ —Ç–∞–ø—É'], productId: 51},
                {level: 2, name: 'Silver VIP', stars: 600, color: '#c0c0c0', badge: 'ü•à', benefits: ['‚≠ê Premium Support', '‚ú® –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –º–∞—Ä–∫–µ—Ä', 'üèÜ Top Place', '‚ûï 50% –∫ —Ç–∞–ø—É'], productId: 52},
                {level: 3, name: 'Gold VIP', stars: 1000, color: '#ffd700', badge: 'ü•á', benefits: ['‚≠ê Premium Support', 'üåü Golden Profile', 'üèÜ Top Place', '‚ú® Unique Design', '‚ûï 100% –∫ —Ç–∞–ø—É', '‚ö° 50% —ç–Ω–µ—Ä–≥–∏–∏'], productId: 53},
                {level: 4, name: 'Platinum VIP', stars: 1500, color: '#e5e4e2', badge: 'üíé', benefits: ['–í—Å–µ –∏–∑ Gold VIP', 'üéâ VIP –¢—É—Ä–Ω–∏—Ä—ã', '‚ú® –ß–∞—Å—Ç–∏—Ü—ã', '‚ûï 150% –∫ —Ç–∞–ø—É'], productId: 54},
                {level: 5, name: 'Diamond VIP', stars: 2000, color: '#b9f2ff', badge: 'üí†', benefits: ['–í—Å–µ –∏–∑ Platinum VIP', 'üëë –ö–æ—Ä–æ–Ω–∞', 'üí∞ 0% –∫–æ–º–∏—Å—Å–∏—è', '‚ûï 250% –∫ —Ç–∞–ø—É', 'üíé VIP Boost 50x'], productId: 55},
                {level: 6, name: 'Absolute VIP', stars: 3000, color: '#ff69b4', badge: 'üëë', benefits: ['–í—Å–µ –∏–∑ Diamond VIP', '‚ú® –ê—É—Ä–∞', 'üåà –†–∞–¥—É–≥–∞', '‚ûï 450% –∫ —Ç–∞–ø—É', 'üåê VIP –ú–∞—à–∏–Ω—ã'], productId: 56}
            ];
            
            let vipHTML = vipPackages.map(pkg => `
                <div style="background:linear-gradient(135deg,${pkg.color},rgba(255,255,255,0.1));padding:14px;border-radius:12px;margin-bottom:12px;border:2px solid ${pkg.color};box-shadow:0 4px 15px ${pkg.color}40;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                        <div style="display:flex;align-items:center;gap:10px;">
                            <span style="font-size:28px;">${pkg.badge}</span>
                            <div>
                                <div style="font-size:16px;font-weight:900;color:#000;">${pkg.name}</div>
                                <div style="font-size:12px;color:rgba(0,0,0,0.7);">–£—Ä–æ–≤–µ–Ω—å ${pkg.level}</div>
                            </div>
                        </div>
                        <div style="text-align:right;">
                            <div style="font-size:20px;font-weight:900;color:#000;">${pkg.stars}</div>
                            <div style="font-size:11px;color:rgba(0,0,0,0.7);">‚≠ê –∑–≤–µ–∑–¥</div>
                        </div>
                    </div>
                    <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:8px;margin-bottom:10px;">
                        <div style="font-size:11px;color:rgba(0,0,0,0.8);line-height:1.8;">
                            ${pkg.benefits.map(b => `<div>‚úì ${b}</div>`).join('')}
                        </div>
                    </div>
                    <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_${pkg.productId}')" style="width:100%;padding:10px;background:#000;color:${pkg.color};border:none;border-radius:8px;font-weight:900;font-size:13px;cursor:pointer;">–ö—É–ø–∏—Ç—å VIP –∑–∞ ${pkg.stars} ‚≠ê</button>
                </div>
            `).join('');
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.style.zIndex = '10000';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 420px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;border: 2px solid rgba(255,215,0,0.4);box-shadow: 0 10px 40px rgba(255,215,0,0.3);">
                    <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:24px;border-radius:22px 22px 0 0;text-align:center;">
                        <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
                            <h2 style="font-size: 26px; color: #000; margin: 0; font-weight: 900;">üëë VIP –°–¢–ê–¢–£–°–´</h2>
                            <button onclick="this.closest('.modal').remove()" style="background:rgba(0,0,0,0.2);border:2px solid #000;border-radius:50%;width:38px;height:38px;color:#000;cursor:pointer;font-size:20px;font-weight:800;">‚úï</button>
                        </div>
                        <div style="font-size:14px;color:rgba(0,0,0,0.7);">–í—ã–±–µ—Ä–∏—Ç–µ VIP –ø–∞–∫–µ—Ç</div>
                    </div>
                    
                    <div style="padding:20px;">
                        ${vipHTML}
                        
                        <button onclick="this.closest('.modal').remove()" style="width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:15px;margin-top:10px;">–ó–∞–∫—Ä—ã—Ç—å</button>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            modal.onclick = (e) => {if(e.target === modal) modal.remove();};
        }
        
        function addRainbowEffects() {
            // Apply rainbow border to key elements
            const elements = document.querySelectorAll('.stat-item-compact, .btn');
            elements.forEach(el => {
                el.style.border = '3px solid #ffd700';
                el.style.animation = 'vip-rainbow 3s linear infinite';
            });
        }
        
        function startVIPParticles() {
            // Remove existing particles
            const existing = document.querySelector('.vip-particles');
            if (existing) existing.remove();
            
            const particles = document.createElement('div');
            particles.className = 'vip-particles';
            
            for (let i = 0; i < 15; i++) {
                setTimeout(() => {
                    if (!particles.parentNode) return;
                    const particle = document.createElement('div');
                    particle.style.position = 'absolute';
                    particle.style.width = Math.random() * 6 + 2 + 'px';
                    particle.style.height = particle.style.width;
                    particle.style.background = '#ffd700';
                    particle.style.borderRadius = '50%';
                    particle.style.left = Math.random() * 100 + '%';
                    particle.style.top = '100%';
                    particle.style.boxShadow = '0 0 10px #ffd700, 0 0 20px #ffed4e';
                    particle.style.animation = `vip-float ${10 + Math.random() * 10}s linear infinite`;
                    particles.appendChild(particle);
                }, i * 200);
            }
            
            document.body.appendChild(particles);
        }
        
        const shopItems = {
            boosts: [
                {name: "2x –ú–Ω–æ–∂–∏—Ç–µ–ª—å", emoji: "‚ö°", price: 1000, desc: "–£–¥–≤–∞–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥ —Å —Ç–∞–ø–∞", type: "multiplier_2x"},
                {name: "5x –ú–Ω–æ–∂–∏—Ç–µ–ª—å", emoji: "üî•", price: 5000, desc: "–£–≤–µ–ª–∏—á–∏–≤–∞–µ—Ç –¥–æ—Ö–æ–¥ –≤ 5 —Ä–∞–∑", type: "multiplier_5x"},
                {name: "10x –ú–Ω–æ–∂–∏—Ç–µ–ª—å", emoji: "üí•", price: 20000, desc: "x10 –∫ –∫–∞–∂–¥–æ–º—É —Ç–∞–ø—É!", type: "multiplier_10x"},
            ],
            automation: [
                {name: "ü§ñ –ê–≤—Ç–æ-–±–æ—Ç —Ç–∞–ø–æ–≤", emoji: "ü§ñ", price: 50000, desc: "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Ç–∞–ø–∞–µ—Ç –∑–∞ –≤–∞—Å (5/—Å–µ–∫)", type: "auto_bot"},
                {name: "‚ö° –î–≤–æ–π–Ω–∞—è —ç–Ω–µ—Ä–≥–∏—è", emoji: "‚ö°", price: 30000, desc: "–ú–∞–∫—Å–∏–º—É–º —ç–Ω–µ—Ä–≥–∏–∏: 2000", type: "double_energy"},
                {name: "üîÑ –£—Å–∫–æ—Ä–µ–Ω–∏–µ —Ä–µ–≥–µ–Ω–µ—Ä–∞—Ü–∏–∏", emoji: "üîÑ", price: 40000, desc: "–≠–Ω–µ—Ä–≥–∏—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–∏–≤–∞–µ—Ç—Å—è –±—ã—Å—Ç—Ä–µ–µ", type: "regen_boost"},
            ],
            energy: [
                {name: "–≠–Ω–µ—Ä–≥–∏—è +50", emoji: "‚ö°", price: 1000, amount: 50},
                {name: "–≠–Ω–µ—Ä–≥–∏—è +200", emoji: "‚ö°‚ö°", price: 3500, amount: 200},
                {name: "–≠–Ω–µ—Ä–≥–∏—è +500", emoji: "‚ö°‚ö°‚ö°", price: 8000, amount: 500},
            ],
            cards: [
                {name: "–û–±—ã—á–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞", emoji: "üü¢", price: 500, desc: "–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥: 0.5 ü™ô/–º–∏–Ω", type: "common"},
                {name: "–†–µ–¥–∫–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞", emoji: "üîµ", price: 2000, desc: "–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥: 2 ü™ô/–º–∏–Ω", type: "rare"},
                {name: "–≠–ø–∏—á–µ—Å–∫–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞", emoji: "üü£", price: 10000, desc: "–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥: 10 ü™ô/–º–∏–Ω", type: "epic"},
                {name: "–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –∫–∞—Ä—Ç–æ—á–∫–∞", emoji: "üü†", price: 50000, desc: "–ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥: 50 ü™ô/–º–∏–Ω", type: "legendary"},
            ]
        };

        function loadData() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const coins = Math.floor(data.coins || 0);
                const quanhash = Math.floor(data.quanhash || 0);
                const energy = parseInt(data.energy || 0);
                const maxEnergy = parseInt(data.max_energy || 1000);
                const energyRegenRate = parseFloat(data.energy_regen_rate || 1.0);
                const passiveCoins = Math.floor(data.passive_coins_per_hour || 0);
                const passiveHash = Math.floor(data.passive_hash_per_hour || 0);
                
                document.getElementById('coins').textContent = coins.toLocaleString();
                document.getElementById('quanhash').textContent = quanhash.toLocaleString();
                document.getElementById('energy-text').textContent = `${energy}/${maxEnergy}`;
                document.getElementById('passiveCoins').textContent = `+${passiveCoins.toLocaleString()}/—á–∞—Å`;
                document.getElementById('passiveHash').textContent = `+${passiveHash.toLocaleString()}/—á–∞—Å`;
                
                const energyPercent = Math.min(100, Math.max(0, (energy / maxEnergy) * 100));
                const fillBar = document.getElementById('energy-bar-fill');
                const percentText = document.getElementById('energy-percent');
                if (fillBar) {
                    fillBar.style.width = energyPercent + '%';
                }
                if (percentText) {
                    percentText.textContent = Math.round(energyPercent) + '%';
                }

                // Update energy regeneration rate display
                const energyRegenText = document.getElementById('energy-regen-text');
                if (energyRegenText) {
                    energyRegenText.textContent = `–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ: +${energyRegenRate.toFixed(1)}/—Å–µ–∫`;
                }
                
                // Update energy regeneration rate in the running interval
                if (window.energyRegenRate !== undefined) {
                    window.energyRegenRate = energyRegenRate;
                }

                // Load VIP status and display it
                loadVIPStatus(data);
                
                // Update autobot toggle button
                updateAutobotToggle(data);
                
                // Update autobot shop buttons
                updateAutobotShopButtons(data);

                // Show withdraw button if user has 500k+ quanhash
            })
            .catch(err => console.error('Error:', err));
        }
        
        function updateAutobotToggle(data) {
            const autobotStatusSection = document.getElementById('autobotStatusSection');
            const autobotStatusBtn = document.getElementById('autobotStatusBtn');
            
            if (!autobotStatusSection || !autobotStatusBtn) return;
            
            const autobotLevel = data.auto_tap_level || 0;
            const autobotSpeed = data.auto_tap_speed || 2.0;
            const autobotExpiresAt = data.auto_tap_expires_at || 0;
            
            // Show status if user has autobot (level > 0 and not expired)
            if (autobotLevel > 0 && autobotExpiresAt > Date.now()) {
                autobotStatusSection.style.display = 'block';
                
                // Store current state globally
                window.autobotExpiresAt = autobotExpiresAt;
                
                // Calculate remaining time
                const remainingMs = autobotExpiresAt - Date.now();
                const hours = Math.floor(remainingMs / 3600000);
                const minutes = Math.floor((remainingMs % 3600000) / 60000);
                const seconds = Math.floor((remainingMs % 60000) / 1000);
                const timeText = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                
                // Update status text
                autobotStatusBtn.innerHTML = `ü§ñ –ê–≤—Ç–æ–±–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω | –£—Ä–æ–≤–µ–Ω—å ${autobotLevel} | –°–∫–æ—Ä–æ—Å—Ç—å ${autobotSpeed}/—Å–µ–∫ | ‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: ${timeText}`;
                
                // Update countdown
                if (window.autobotInterval) clearInterval(window.autobotInterval);
                window.autobotInterval = setInterval(() => {
                    const now = Date.now();
                    const remainingMs = window.autobotExpiresAt - now;
                    
                    if (remainingMs <= 0) {
                        clearInterval(window.autobotInterval);
                        autobotStatusSection.style.display = 'none';
                        return;
                    }
                    
                    const hours = Math.floor(remainingMs / 3600000);
                    const minutes = Math.floor((remainingMs % 3600000) / 60000);
                    const seconds = Math.floor((remainingMs % 60000) / 1000);
                    const timeText = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                    
                    autobotStatusBtn.innerHTML = `ü§ñ –ê–≤—Ç–æ–±–æ—Ç –∞–∫—Ç–∏–≤–µ–Ω | –£—Ä–æ–≤–µ–Ω—å ${autobotLevel} | –°–∫–æ—Ä–æ—Å—Ç—å ${autobotSpeed}/—Å–µ–∫ | ‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: ${timeText}`;
                }, 1000);
            } else {
                autobotStatusSection.style.display = 'none';
                if (window.autobotInterval) clearInterval(window.autobotInterval);
            }
        }
        
        function updateAutobotShopButtons(data) {
            const autobotExpiresAt = data.auto_tap_expires_at || 0;
            const autobotLevel = data.auto_tap_level || 0;
            const currentTime = Date.now();
            
            // Check if autobot is active
            if (autobotExpiresAt > currentTime && autobotLevel > 0) {
                const remainingMs = autobotExpiresAt - currentTime;
                const hours = Math.floor(remainingMs / 3600000);
                const minutes = Math.floor((remainingMs % 3600000) / 60000);
                const seconds = Math.floor((remainingMs % 60000) / 1000);
                const timeText = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                
                // Block all autobot buttons
                for (let i = 1; i <= 20; i++) {
                    const btn = document.getElementById(`autobot-btn-${i}`);
                    if (btn) {
                        btn.disabled = true;
                        btn.style.background = 'rgba(148,163,184,0.3)';
                        btn.style.cursor = 'not-allowed';
                        
                        // Show countdown only on the purchased button
                        if (i === autobotLevel) {
                            btn.innerHTML = `‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: ${timeText}`;
                            btn.style.background = 'rgba(239,68,68,0.6)';
                        } else {
                            btn.innerHTML = 'üîí –ù–µ–¥–æ—Å—Ç—É–ø–Ω–æ';
                        }
                    }
                }
                
                // Update countdown
                if (window.autobotShopInterval) clearInterval(window.autobotShopInterval);
                window.autobotShopInterval = setInterval(() => {
                    const now = Date.now();
                    const remainingMs = autobotExpiresAt - now;
                    
                    if (remainingMs <= 0) {
                        clearInterval(window.autobotShopInterval);
                        // Unblock all buttons
                        for (let i = 1; i <= 20; i++) {
                            const btn = document.getElementById(`autobot-btn-${i}`);
                            if (btn) {
                                btn.disabled = false;
                                btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                                btn.style.cursor = 'pointer';
                                btn.innerHTML = `–ö—É–ø–∏—Ç—å ${window.shopData?.autobot?.items?.[i-1]?.price?.toLocaleString() || 0} ü™ô`;
                            }
                        }
                        return;
                    }
                    
                    const hours = Math.floor(remainingMs / 3600000);
                    const minutes = Math.floor((remainingMs % 3600000) / 60000);
                    const seconds = Math.floor((remainingMs % 60000) / 1000);
                    const timeText = `${String(hours).padStart(2,'0')}:${String(minutes).padStart(2,'0')}:${String(seconds).padStart(2,'0')}`;
                    
                    // Update only the purchased button with countdown
                    const purchasedBtn = document.getElementById(`autobot-btn-${autobotLevel}`);
                    if (purchasedBtn) {
                        purchasedBtn.innerHTML = `‚è±Ô∏è –û—Å—Ç–∞–ª–æ—Å—å: ${timeText}`;
                    }
                }, 1000);
            } else {
                // Unblock all buttons
                if (window.autobotShopInterval) clearInterval(window.autobotShopInterval);
                for (let i = 1; i <= 20; i++) {
                    const btn = document.getElementById(`autobot-btn-${i}`);
                    if (btn) {
                        btn.disabled = false;
                        btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                        btn.style.cursor = 'pointer';
                        btn.innerHTML = `–ö—É–ø–∏—Ç—å ${window.shopData?.autobot?.items?.[i-1]?.price?.toLocaleString() || 0} ü™ô`;
                    }
                }
            }
        }

        function checkOfflineIncome() {
            fetch('/api/offline_income', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                if (data.offline_time > 0 && data.offline_income > 0) {
                    const hours = Math.floor(data.offline_time / 3600);
                    const minutes = Math.floor((data.offline_time % 3600) / 60);
                    
                    // Check for offline QuanHash income too
                    const offlineHash = data.offline_hash || 0;
                    
                    const offlineContent = `
                        <div style="text-align: center; padding: 25px 15px;">
                            <div style="margin-bottom: 16px;">
                                <div style="font-size: 50px; filter: drop-shadow(0 0 15px rgba(74,222,128,0.6)); margin-bottom: 10px;">üí∞</div>
                                <div style="font-size: 16px; font-weight: 700; color: #4ade80; margin-bottom: 8px;">–ü—Ä–∏–≤–µ—Ç, —Å –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ–º!</div>
                                <div style="font-size: 11px; color: rgba(255,255,255,0.6); padding: 5px 12px; background: rgba(102,126,234,0.12); border-radius: 12px; display: inline-block;">‚è±Ô∏è ${hours}—á ${minutes}–º</div>
                            </div>
                            
                            <div style="display: grid; gap: 10px; margin-bottom: 12px;">
                                ${data.offline_income > 0 ? `
                                <div style="background: linear-gradient(135deg, rgba(102,126,234,0.2), rgba(118,75,162,0.2)); border: 1px solid rgba(102,126,234,0.5); border-radius: 14px; padding: 12px 16px; backdrop-filter: blur(10px);">
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.7); margin-bottom: 4px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                        <span>ü™ô</span> <span>–ö–û–ò–ù–´</span>
                                    </div>
                                    <div style="font-size: 32px; font-weight: 900; color: #4ade80; letter-spacing: -1px;">+${Math.floor(data.offline_income).toLocaleString()}</div>
                                </div>
                                ` : ''}
                                
                                ${offlineHash > 0 ? `
                                <div style="background: linear-gradient(135deg, rgba(118,75,162,0.2), rgba(240,147,251,0.2)); border: 1px solid rgba(118,75,162,0.5); border-radius: 14px; padding: 12px 16px; backdrop-filter: blur(10px);">
                                    <div style="font-size: 12px; color: rgba(255,255,255,0.7); margin-bottom: 4px; font-weight: 600; display: flex; align-items: center; justify-content: center; gap: 4px;">
                                        <span>üíé</span> <span>QUANHASH</span>
                                    </div>
                                    <div style="font-size: 32px; font-weight: 900; color: #f093fb; letter-spacing: -1px;">+${Math.floor(offlineHash).toLocaleString()}</div>
                                </div>
                                ` : ''}
                            </div>
                            
                            <div style="font-size: 10px; opacity: 0.4; font-style: italic; margin-top: 12px;">‚ú® –î–æ–±–∞–≤–ª–µ–Ω–æ –Ω–∞ –±–∞–ª–∞–Ω—Å</div>
                        </div>
                    `;
                    document.getElementById('offlineContent').innerHTML = offlineContent;
                    document.getElementById('offlinePopup').classList.add('active');
                    
                    // Update user data
                    fetch('/api/user_data', {
                        method: 'POST',
                        headers: {'Content-Type': 'application/json'},
                        body: JSON.stringify({user_id: window.user?.id})
                    })
                    .then(res => res.json())
                    .then(data => {
                        const coins = Math.floor(data.coins || 0);
                        document.getElementById('coins').textContent = coins;
                    });
                }
            });
        }

        function startEnergyRegen() {
            if (energyRegenInterval) clearInterval(energyRegenInterval);
            
            let lastEnergy = 0;
            window.energyRegenRate = 1.0; // Default rate, stored globally
            let energyAccumulator = 0; // For fractional energy regeneration
            let lastUpdateTime = Date.now();
            
            // Get current regeneration rate from the display
            const regenText = document.getElementById('energy-regen-text');
            if (regenText) {
                const match = regenText.textContent.match(/\+(\d+\.?\d*)\/—Å–µ–∫/);
                if (match) {
                    window.energyRegenRate = parseFloat(match[1]);
                }
            }
            
            energyRegenInterval = setInterval(() => {
                const energyText = document.getElementById('energy-text').textContent;
                const [energy, maxEnergy] = energyText.split('/').map(e => parseInt(e));
                
                if (energy < maxEnergy) {
                    const now = Date.now();
                    const deltaTime = (now - lastUpdateTime) / 1000; // Convert to seconds
                    lastUpdateTime = now;
                    
                    // Accumulate energy based on time passed
                    energyAccumulator += window.energyRegenRate * deltaTime;
                    
                    // Only update when we have at least 1 energy to add
                    if (energyAccumulator >= 1) {
                        const energyToAdd = Math.floor(energyAccumulator);
                        energyAccumulator -= energyToAdd; // Keep the remainder
                        
                        const newEnergy = Math.min(energy + energyToAdd, maxEnergy);
                        if (newEnergy !== lastEnergy) {
                            lastEnergy = newEnergy;
                            document.getElementById('energy-text').textContent = `${newEnergy}/${maxEnergy}`;
                            const energyPercent = Math.min(100, Math.max(0, (newEnergy / maxEnergy) * 100));
                            const fillBar = document.getElementById('energy-bar-fill');
                            const percentText = document.getElementById('energy-percent');
                            if (fillBar) {
                                fillBar.style.width = energyPercent + '%';
                            }
                            if (percentText) {
                                percentText.textContent = Math.round(energyPercent) + '%';
                            }
                            
                            // Update server only when energy actually changes
                            fetch('/api/update_energy', {
                                method: 'POST',
                                headers: {'Content-Type': 'application/json'},
                                body: JSON.stringify({user_id: user?.id, energy: newEnergy})
                            });
                        }
                    }
                }
            }, 100); // Update every 100ms for smoother animation
        }

        function tap() {
            tg.HapticFeedback.impactOccurred('light');
            
            const button = document.querySelector('.tap-button');
            if(button){
                button.classList.add('tap-pressed');
                setTimeout(()=>{if(button)button.classList.remove('tap-pressed');},300);
            }
            
            const energy = parseInt(document.getElementById('energy-text').textContent.split('/')[0]);
            if (energy < 1) {
                tg.showAlert('‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ —ç–Ω–µ—Ä–≥–∏–∏!');
                return;
            }
            
            fetch('/api/tap', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    // Only show animation if no modal is open
                    const hasOpenModal = document.querySelector('.modal.active');
                    if (!hasOpenModal) {
                        const button = document.querySelector('.tap-button');
                        if(button){
                            const rect = button.getBoundingClientRect();
                            const centerX = rect.left + rect.width / 2;
                            const centerY = rect.top + rect.height / 2;
                            
                            const coinAnimation = document.createElement('div');
                            coinAnimation.className = 'coin-animation';
                            coinAnimation.textContent = '+' + data.reward;
                            // Position from center of button
                            coinAnimation.style.left = centerX + 'px';
                            coinAnimation.style.top = centerY + 'px';
                            coinAnimation.style.transform = 'translate(-50%, -50%)';
                            coinAnimation.style.zIndex = '1000'; // Lower than modals
                            document.body.appendChild(coinAnimation);
                            setTimeout(() => { 
                                if(document.body.contains(coinAnimation)) {
                                    document.body.removeChild(coinAnimation); 
                                }
                            }, 2000);
                        }
                    }
                    loadData();
                }
            });
        }

        function openShop(e) {
            e.preventDefault();
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'shopModal2';
            
            // New comprehensive shop with 4 categories
            const shopData = {
                'tap_boost': {
                    name: 'üí™ –£—Å–∏–ª–∏—Ç–µ–ª—å –¢–∞–ø–∞',
                    emoji: 'üí™',
                    items: [
                        // 10 –ø–æ–∑–∏—Ü–∏–π –∑–∞ –∫–æ–∏–Ω—ã
                        {level: 1, name: 'üî• –•–æ–ª–æ–¥–Ω–æ–µ –°–µ—Ä–¥—Ü–µ', desc: '–ë–∞–∑–æ–≤–æ–µ —É—Å–∏–ª–µ–Ω–∏–µ —Ç–∞–ø–∞', bonus: 1, price: 1000, currency: 'coins', locked: false},
                        {level: 2, name: '‚ö° –ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω—ã–π', desc: '+1 –∫–ª–∏–∫ –∑–∞ —Ç–∞–ø', bonus: 2, price: 3000, currency: 'coins', locked: false},
                        {level: 3, name: 'üí® –£—Ä–∞–≥–∞–Ω', desc: '+2 –∫–ª–∏–∫–∞ –∑–∞ —Ç–∞–ø', bonus: 3, price: 8000, currency: 'coins', locked: false},
                        {level: 4, name: 'üå™Ô∏è –¢–æ—Ä–Ω–∞–¥–æ', desc: '+3 –∫–ª–∏–∫–∞ –∑–∞ —Ç–∞–ø', bonus: 4, price: 20000, currency: 'coins', locked: false},
                        {level: 5, name: 'üí• –í–∑—Ä—ã–≤–Ω–∞—è –í–æ–ª–Ω–∞', desc: '+5 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 6, price: 50000, currency: 'coins', locked: false},
                        {level: 6, name: 'üåü –°—É–ø–µ—Ä –≠–Ω–µ—Ä–≥–∏—è', desc: '+8 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 9, price: 120000, currency: 'coins', locked: false},
                        {level: 7, name: 'üöÄ –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π', desc: '+12 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 13, price: 300000, currency: 'coins', locked: false},
                        {level: 8, name: 'üí´ –ù–µ–±–µ—Å–Ω—ã–π', desc: '+18 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 19, price: 800000, currency: 'coins', locked: false},
                        {level: 9, name: '‚öõÔ∏è –ö–≤–∞–Ω—Ç–æ–≤—ã–π', desc: '+25 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 26, price: 2000000, currency: 'coins', locked: false},
                        {level: 10, name: 'üåå –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π', desc: '+35 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 36, price: 5000000, currency: 'coins', locked: false},
                    ]
                },
                'energy_buy': {
                    name: '‚ö° –£—Å–∫–æ—Ä–µ–Ω–∏–µ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è',
                    emoji: '‚ö°',
                    items: [
                        // 10 –ø–æ–∑–∏—Ü–∏–π –∑–∞ –∫–æ–∏–Ω—ã
                        {level: 1, name: 'üîã –ú–∏–Ω–∏ –ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä', desc: '+0.2 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 0.2, price: 1000, currency: 'coins', locked: false},
                        {level: 2, name: '‚ö° –°–≤–µ—Ç–æ–≤–æ–π', desc: '+0.4 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 0.4, price: 2500, currency: 'coins', locked: false},
                        {level: 3, name: 'üí´ –ó–≤–µ–∑–¥–Ω—ã–π', desc: '+0.6 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 0.6, price: 5000, currency: 'coins', locked: false},
                        {level: 4, name: 'üåü –ó–æ–ª–æ—Ç–æ–π', desc: '+0.8 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 0.8, price: 10000, currency: 'coins', locked: false},
                        {level: 5, name: 'üíé –ë—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤—ã–π', desc: '+1.0 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 1.0, price: 20000, currency: 'coins', locked: false},
                        {level: 6, name: 'üî• –û–≥–Ω–µ–Ω–Ω—ã–π', desc: '+1.2 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 1.2, price: 40000, currency: 'coins', locked: false},
                        {level: 7, name: '‚ùÑÔ∏è –õ–µ–¥—è–Ω–æ–π', desc: '+1.4 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 1.4, price: 80000, currency: 'coins', locked: false},
                        {level: 8, name: 'üåä –ú–æ—Ä—Å–∫–æ–π', desc: '+1.6 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 1.6, price: 160000, currency: 'coins', locked: false},
                        {level: 9, name: '‚ö° –ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω—ã–π', desc: '+1.8 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 1.8, price: 320000, currency: 'coins', locked: false},
                        {level: 10, name: 'üåô –õ—É–Ω–Ω—ã–π', desc: '+2.0 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 2.0, price: 640000, currency: 'coins', locked: false},
                    ]
                },
                'energy_expand': {
                    name: 'üìà –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≠–Ω–µ—Ä–≥–∏–∏',
                    emoji: 'üìà',
                    items: [
                        // 10 –ø–æ–∑–∏—Ü–∏–π –∑–∞ –∫–æ–∏–Ω—ã
                        {level: 1, name: 'üèÉ –ù–∞—á–∞–ª—å–Ω—ã–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 100', bonus: 100, price: 2000, currency: 'coins', locked: false},
                        {level: 2, name: 'üí® –ë—ã—Å—Ç—Ä—ã–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 150', bonus: 150, price: 5000, currency: 'coins', locked: false},
                        {level: 3, name: '‚ö° –£—Å–∫–æ—Ä–µ–Ω–Ω—ã–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 250', bonus: 250, price: 10000, currency: 'coins', locked: false},
                        {level: 4, name: 'üöÄ –¢—É—Ä–±–æ', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 400', bonus: 400, price: 20000, currency: 'coins', locked: false},
                        {level: 5, name: 'üí• –£–ª—å—Ç—Ä–∞', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 600', bonus: 600, price: 40000, currency: 'coins', locked: false},
                        {level: 6, name: 'üåü –°—É–ø–µ—Ä', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 900', bonus: 900, price: 80000, currency: 'coins', locked: false},
                        {level: 7, name: 'üå™Ô∏è –ú–µ–≥–∞', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 1250', bonus: 1250, price: 160000, currency: 'coins', locked: false},
                        {level: 8, name: 'üî• –û–≥–Ω–µ–Ω–Ω—ã–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 1750', bonus: 1750, price: 320000, currency: 'coins', locked: false},
                        {level: 9, name: '‚ùÑÔ∏è –õ–µ–¥—è–Ω–æ–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 2500', bonus: 2500, price: 640000, currency: 'coins', locked: false},
                        {level: 10, name: 'üí´ –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 3750', bonus: 3750, price: 1280000, currency: 'coins', locked: false},
                    ]
                },
                'autobot': {
                    name: 'ü§ñ –ê–≤—Ç–æ–±–æ—Ç',
                    emoji: 'ü§ñ',
                    items: [
                        // 10 –ø–æ–∑–∏—Ü–∏–π –∑–∞ –∫–æ–∏–Ω—ã (–≤—Å–µ–≥–¥–∞ 1 —Ç–∞–ø/—Å–µ–∫)
                        {level: 1, name: 'üî© –ë–∞–∑–æ–≤—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 15 –º–∏–Ω—É—Ç', speed: 1, duration: 15, price: 2000, currency: 'coins', locked: false},
                        {level: 2, name: '‚öôÔ∏è –ù–∞–¥–µ–∂–Ω—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 30 –º–∏–Ω—É—Ç', speed: 1, duration: 30, price: 5000, currency: 'coins', locked: false},
                        {level: 3, name: 'üí´ –ó–≤–µ–∑–¥–Ω—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 1 —á–∞—Å', speed: 1, duration: 60, price: 10000, currency: 'coins', locked: false},
                        {level: 4, name: 'üöÄ –†–∞–∫–µ—Ç–Ω—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 2 —á–∞—Å–∞', speed: 1, duration: 120, price: 20000, currency: 'coins', locked: false},
                        {level: 5, name: 'üåü –°—É–ø–µ—Ä –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 4 —á–∞—Å–∞', speed: 1, duration: 240, price: 40000, currency: 'coins', locked: false},
                        {level: 6, name: 'üî• –û–≥–Ω–µ–Ω–Ω—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 6 —á–∞—Å–æ–≤', speed: 1, duration: 360, price: 80000, currency: 'coins', locked: false},
                        {level: 7, name: '‚ö° –ú–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 12 —á–∞—Å–æ–≤', speed: 1, duration: 720, price: 160000, currency: 'coins', locked: false},
                        {level: 8, name: 'üåå –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 1 –¥–µ–Ω—å', speed: 1, duration: 1440, price: 320000, currency: 'coins', locked: false},
                        {level: 9, name: 'üíé –ë—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 2 –¥–Ω—è', speed: 1, duration: 2880, price: 640000, currency: 'coins', locked: false},
                        {level: 10, name: 'üëë –ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 3 –¥–Ω—è', speed: 1, duration: 4320, price: 1280000, currency: 'coins', locked: false},
                    ]
                }
            };
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 450px; max-height: 85vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.98), rgba(15, 23, 42, 0.98));border-radius: 24px;border: 2px solid rgba(167,139,250,0.4);box-shadow: 0 10px 40px rgba(167,139,250,0.3);">
                    <div style="background:linear-gradient(135deg,#a78bfa,#c084fc,#d946ef);padding:20px;border-radius:22px 22px 0 0;text-align:center;">
                        <h2 style="font-size: 22px; color: #fff; margin: 0; font-weight: 900;">üõí –ú–ê–ì–ê–ó–ò–ù</h2>
                        <button onclick="this.closest('.modal').remove()" style="position:absolute;top:20px;right:20px;background:rgba(255,255,255,0.2);border:2px solid rgba(255,255,255,0.4);border-radius:50%;width:36px;height:36px;color:#fff;cursor:pointer;font-size:18px;font-weight:800;">‚úï</button>
                    </div>
                    <div style="padding:20px;">
                        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:20px;">
                            <button class="shop-cat-btn" data-category="tap_boost" onclick="loadShopCategory('tap_boost')" style="padding:12px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:13px;">üí™ –£—Å–∏–ª–∏—Ç–µ–ª—å</button>
                            <button class="shop-cat-btn" data-category="energy_buy" onclick="loadShopCategory('energy_buy')" style="padding:12px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:12px;cursor:pointer;font-weight:700;font-size:13px;">‚ö° –≠–Ω–µ—Ä–≥–∏—è</button>
                            <button class="shop-cat-btn" data-category="energy_expand" onclick="loadShopCategory('energy_expand')" style="padding:12px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:12px;cursor:pointer;font-weight:700;font-size:13px;">üìà –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ</button>
                            <button class="shop-cat-btn" data-category="autobot" onclick="loadShopCategory('autobot')" style="padding:12px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:12px;cursor:pointer;font-weight:700;font-size:13px;">ü§ñ –ê–≤—Ç–æ–±–æ—Ç</button>
                        </div>
                        <div id="shopItemsList" style="display:grid;grid-template-columns:repeat(auto-fit,minmax(200px,1fr));gap:10px;"></div>
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            window.shopData = shopData; // Store globally
            loadShopCategory('tap_boost');
        }
        
        function showVIPShopSection() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const vipLevel = data.vip_level || 0;
                const listDiv = document.getElementById('shopItemsList');
                
                if (vipLevel >= 3 && listDiv && !listDiv.querySelector('.vip-boosts-section')) {
                    const vipSection = document.createElement('div');
                    vipSection.className = 'vip-boosts-section';
                    vipSection.innerHTML = `
                        <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:12px;border-radius:12px;margin-bottom:15px;border:2px solid #ffd700;">
                            <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;">
                                <div style="font-size:14px;font-weight:700;color:#000;margin-bottom:5px;">üëë VIP BOOST 20x</div>
                                <div style="font-size:11px;color:rgba(0,0,0,0.7);margin-bottom:8px;">x20 –¥–æ—Ö–æ–¥ –Ω–∞ 1 —á–∞—Å ‚Ä¢ –¢–æ–ª—å–∫–æ –¥–ª—è VIP</div>
                                <div style="font-size:10px;color:#000;margin-bottom:8px;">‚úÖ –¢—Ä–µ–±—É–µ—Ç—Å—è Gold VIP+</div>
                                <button onclick="buyVIPBoost('vip_boost_20x', 5000000)" style="width:100%;padding:10px;background:#000;color:#ffd700;border:none;border-radius:8px;font-weight:800;font-size:12px;cursor:pointer;">üí∞ 5M ü™ô</button>
                            </div>
                        </div>
                        ${vipLevel >= 5 ? `
                        <div style="background:linear-gradient(135deg,#c084fc,#a78bfa);padding:12px;border-radius:12px;margin-bottom:15px;border:2px solid #c084fc;">
                            <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;">
                                <div style="font-size:14px;font-weight:700;color:#fff;margin-bottom:5px;">üíé DIAMOND BOOST 50x</div>
                                <div style="font-size:11px;color:rgba(255,255,255,0.8);margin-bottom:8px;">x50 –¥–æ—Ö–æ–¥ –Ω–∞ 24 —á–∞—Å–∞</div>
                                <div style="font-size:10px;color:#c084fc;margin-bottom:8px;">‚úÖ –¢–æ–ª—å–∫–æ –¥–ª—è Diamond VIP</div>
                                <button onclick="buyVIPBoost('diamond_boost_50x', 20000000)" style="width:100%;padding:10px;background:#fff;color:#a78bfa;border:none;border-radius:8px;font-weight:800;font-size:12px;cursor:pointer;">üí∞ 20M ü™ô</button>
                            </div>
                        </div>
                        ` : ''}
                    `;
                    if (listDiv) {
                        listDiv.insertBefore(vipSection, listDiv.firstChild);
                    }
                }
            });
        }
        
        function buyVIPBoost(boostType, price) {
            fetch('/api/buy_vip_boost', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: user?.id,
                    boost_type: boostType,
                    price: price
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('‚úÖ VIP –±—É—Å—Ç –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω!');
                    loadData();
                } else {
                    tg.showAlert('‚ùå ' + data.error);
                }
            })
            .catch(err => tg.showAlert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏'));
        }
        
        function openVIPModal(category) {
            const vipItems = vipData[category];
            if (!vipItems) return;
            
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'vipModal';
            
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 450px; max-height: 80vh; overflow-y: auto; background: linear-gradient(135deg, rgba(255,215,0,0.95), rgba(255,237,78,0.95)); border-radius: 24px; border: 3px solid #ffd700; box-shadow: 0 15px 50px rgba(255,215,0,0.6);">
                    <div style="background: linear-gradient(135deg, #000, #1a1a1a); padding: 20px; border-radius: 20px 20px 0 0; text-align: center; position: relative;">
                        <h2 style="font-size: 24px; color: #ffd700; margin: 0; font-weight: 900; text-shadow: 0 0 10px rgba(255,215,0,0.5);">${vipItems.name}</h2>
                        <div style="font-size: 14px; color: rgba(255,255,255,0.8); margin-top: 8px;">–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞ Telegram Stars</div>
                        <button onclick="this.closest('.modal').remove()" style="position: absolute; top: 20px; right: 20px; background: rgba(255,215,0,0.2); border: 2px solid #ffd700; border-radius: 50%; width: 40px; height: 40px; color: #ffd700; cursor: pointer; font-size: 20px; font-weight: 800;">‚úï</button>
                    </div>
                    
                    <div style="padding: 20px;">
                        <div style="display: grid; gap: 12px;">
                            ${vipItems.items.map(item => `
                                <div style="background: rgba(0,0,0,0.3); padding: 16px; border-radius: 12px; border: 2px solid rgba(255,215,0,0.4); position: relative;">
                                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 8px;">
                                        <span style="font-size: 24px;">${item.name.split(' ')[0]}</span>
                                        <div style="flex: 1;">
                                            <div style="font-weight: 800; font-size: 16px; color: #fff;">${item.name.split(' ').slice(1).join(' ')}</div>
                                            <div style="font-size: 12px; color: rgba(255,255,255,0.7); margin-top: 2px;">${item.desc}</div>
                                        </div>
                                    </div>
                                    
                                    ${category === 'autobot' ? `
                                        <div style="background: rgba(74,222,128,0.2); padding: 8px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                                            <span style="color: #4ade80; font-size: 12px; font-weight: 700;">‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</span>
                                            <span style="color: #fff; font-size: 12px; font-weight: 800;">${item.duration < 60 ? item.duration + ' –º–∏–Ω—É—Ç' : Math.floor(item.duration / 60) + ' —á–∞—Å–æ–≤'}</span>
                                        </div>
                                        <div style="background: rgba(74,222,128,0.2); padding: 8px; border-radius: 8px; margin-bottom: 8px; display: flex; justify-content: space-between; align-items: center;">
                                            <span style="color: #4ade80; font-size: 12px; font-weight: 700;">‚ö° –°–∫–æ—Ä–æ—Å—Ç—å:</span>
                                            <span style="color: #4ade80; font-size: 12px; font-weight: 800;">${item.speed} —Ç–∞–ø–æ–≤/—Å–µ–∫</span>
                                        </div>
                                    ` : ''}
                                    
                                    <button onclick="buyWithStars('${category}', ${item.level}, ${item.price})" 
                                            style="width: 100%; padding: 12px; background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700); color: #000; border: 2px solid #ffd700; border-radius: 10px; cursor: pointer; font-weight: 800; font-size: 14px; transition: all 0.3s; position: relative; overflow: hidden; box-shadow: 0 4px 15px rgba(255,215,0,0.4);"
                                            onmousedown="this.style.transform='scale(0.95)'; this.style.boxShadow='0 6px 20px rgba(255,215,0,0.6)'"
                                            onmouseup="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 15px rgba(255,215,0,0.4)'"
                                            onmouseleave="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 15px rgba(255,215,0,0.4)'">
                                        –ö—É–ø–∏—Ç—å –∑–∞ ${item.price} ‚≠ê Telegram Stars
                                    </button>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                </div>
            `;
            
            document.body.appendChild(modal);
        }
        
        function buyWithStars(category, level, price) {
            // Map shop items to existing product IDs (51-56 are VIP, 1-10 are currency)
            const productIdMap = {
                'tap_boost': {11: 1, 12: 2, 13: 3, 14: 4, 15: 5},
                'energy_buy': {11: 6, 12: 7, 13: 8, 14: 9, 15: 10},
                'energy_expand': {11: 1, 12: 2, 13: 3, 14: 4, 15: 5},
                'autobot': {11: 6, 12: 7, 13: 8, 14: 9, 15: 10}
            };
            
            const productId = productIdMap[category]?.[level] || 1;
            
            // Open Telegram payment (same as in currency purchase)
            const paymentUrl = `https://t.me/qanexus_bot?start=buy_stars_${productId}`;
            window.open(paymentUrl, '_blank');
            
            // Show beautiful VIP confirmation message
            const anim = document.createElement('div');
            anim.style.cssText='position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
            anim.innerHTML='<div style="background:linear-gradient(135deg,rgba(255,215,0,0.95),rgba(255,237,78,0.95));padding:25px 50px;border-radius:25px;font-size:26px;box-shadow:0 15px 50px rgba(255,215,0,0.7);color:#000;font-weight:800;display:flex;align-items:center;gap:20px;border:3px solid rgba(255,215,0,0.8);"><span style="font-size:40px;">‚≠ê</span><div><div style="font-size:28px;margin-bottom:8px;">VIP –ü–æ–∫—É–ø–∫–∞</div><div style="font-size:20px;opacity:0.8;">–û—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è –æ–ø–ª–∞—Ç–∞ –∑–∞ ' + price + ' ‚≠ê Telegram Stars</div></div></div>';
            document.body.appendChild(anim);
            setTimeout(()=>{anim.style.opacity='0';anim.style.transform='translate(-50%,-70%)';setTimeout(()=>{anim.remove();},300);},2000);
        }
        
        // VIP –¥–∞–Ω–Ω—ã–µ –¥–ª—è –∫–∞–∂–¥–æ–π –∫–∞—Ç–µ–≥–æ—Ä–∏–∏ (–≥–ª–æ–±–∞–ª—å–Ω—ã–µ)
        const vipData = {
            'tap_boost': {
                name: 'üí™ VIP –£—Å–∏–ª–∏—Ç–µ–ª–∏ –¢–∞–ø–∞',
                items: [
                    {level: 11, name: 'üå† –ó–≤–µ–∑–¥–Ω—ã–π –®—Ç–æ—Ä–º', desc: '+50 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 51, price: 50},
                    {level: 12, name: 'üåë –ß–µ—Ä–Ω–∞—è –î—ã—Ä–∞', desc: '+70 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 71, price: 100},
                    {level: 13, name: '‚ú® –ê–±—Å–æ–ª—é—Ç', desc: '+100 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 101, price: 200},
                    {level: 14, name: 'üëë –ò–º–ø–µ—Ä—Å–∫–∏–π', desc: '+140 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 141, price: 350},
                    {level: 15, name: 'üåü –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π', desc: '+200 –∫–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø', bonus: 201, price: 500}
                ]
            },
            'energy_buy': {
                name: '‚ö° VIP –£—Å–∫–æ—Ä–µ–Ω–∏–µ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è',
                items: [
                    {level: 11, name: '‚òÄÔ∏è –°–æ–ª–Ω–µ—á–Ω—ã–π', desc: '+3.0 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 3.0, price: 40},
                    {level: 12, name: 'üåå –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π', desc: '+4.5 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 4.5, price: 80},
                    {level: 13, name: 'üí´ –ù–æ–≤–∞—è –ï—Ä–∞', desc: '+6.0 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 6.0, price: 150},
                    {level: 14, name: '‚öõÔ∏è –ö–≤–∞–Ω—Ç–æ–≤—ã–π', desc: '+8.0 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 8.0, price: 250},
                    {level: 15, name: 'üå† –ù–µ–±–µ—Å–Ω—ã–π', desc: '+10.0 —ç–Ω–µ—Ä–≥–∏–∏/—Å–µ–∫', bonus: 10.0, price: 400}
                ]
            },
            'energy_expand': {
                name: 'üìà VIP –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ –≠–Ω–µ—Ä–≥–∏–∏',
                items: [
                    {level: 11, name: 'üåå –ì–∞–ª–∞–∫—Ç–∏—á–µ—Å–∫–∏–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 7500', bonus: 7500, price: 60},
                    {level: 12, name: '‚öõÔ∏è –ö–≤–∞–Ω—Ç–æ–≤—ã–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 12500', bonus: 12500, price: 120},
                    {level: 13, name: 'üå† –ó–≤–µ–∑–¥–Ω—ã–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 20000', bonus: 20000, price: 200},
                    {level: 14, name: 'üåë –ê–±—Å–æ–ª—é—Ç–Ω—ã–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 37500', bonus: 37500, price: 350},
                    {level: 15, name: 'üëë –ò–º–ø–µ—Ä—Å–∫–∏–π', desc: '–†–∞—Å—à–∏—Ä–∏—Ç—å –º–∞–∫—Å–∏–º—É–º –Ω–∞ 75000', bonus: 75000, price: 500}
                ]
            },
            'autobot': {
                name: 'ü§ñ VIP –ê–≤—Ç–æ–±–æ—Ç—ã',
                items: [
                    {level: 11, name: 'üåä –û–∫–µ–∞–Ω—Å–∫–∏–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 5 –¥–Ω–µ–π', speed: 6, duration: 7200, price: 30},
                    {level: 12, name: '‚öõÔ∏è –ö–≤–∞–Ω—Ç–æ–≤—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 7 –¥–Ω–µ–π', speed: 6.5, duration: 10080, price: 60},
                    {level: 13, name: 'üå† –ù–µ–±–µ—Å–Ω—ã–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 10 –¥–Ω–µ–π', speed: 7, duration: 14400, price: 120},
                    {level: 14, name: 'üåã –í—É–ª–∫–∞–Ω–∏—á–µ—Å–∫–∏–π –ë–æ—Ç', desc: '–ê–≤—Ç–æ—Ç–∞–ø 14 –¥–Ω–µ–π', speed: 7.5, duration: 20160, price: 200},
                    {level: 15, name: 'üåü –ó–≤–µ–∑–¥–Ω–∞—è –í–ª–∞—Å—Ç—å', desc: '–ê–≤—Ç–æ—Ç–∞–ø 20 –¥–Ω–µ–π', speed: 8, duration: 28800, price: 300}
                ]
            }
        };
        
        function loadShopCategory(category) {
            // Update button states
            document.querySelectorAll('.shop-cat-btn').forEach(btn => {
                const btnCategory = btn.getAttribute('data-category');
                if(btnCategory === category) {
                    btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                    btn.style.border = 'none';
                } else {
                    btn.style.background = 'rgba(255,255,255,0.1)';
                    btn.style.border = '1px solid rgba(255,255,255,0.3)';
                }
            });
            
            const items = window.shopData[category].items;
            const list = document.getElementById('shopItemsList');
            
            // Find user's current level for this category
            let userLevel = 0;
            
            list.innerHTML = items.map(item => {
                const isLocked = false; // Remove locking - all items are available
                const rarityColors = {
                    1: 'rgba(148,163,184,0.3)', // gray
                    5: 'rgba(59,130,246,0.3)', // blue
                    10: 'rgba(139,92,246,0.3)', // purple
                    15: 'rgba(236,72,153,0.3)', // pink
                    20: 'rgba(251,191,36,0.3)' // gold
                };
                const rarityColor = item.level <= 5 ? rarityColors[1] : 
                                   item.level <= 10 ? rarityColors[5] : 
                                   item.level <= 15 ? rarityColors[10] : 
                                   item.level <= 19 ? rarityColors[15] : rarityColors[20];
                
                return `
                    <div style="background:${isLocked ? 'rgba(0,0,0,0.5)' : item.premium ? 'linear-gradient(135deg,rgba(255,215,0,0.15),rgba(255,237,78,0.15))' : rarityColor};padding:14px;border-radius:14px;border:2px solid ${isLocked ? 'rgba(239,68,68,0.5)' : item.premium ? 'rgba(255,215,0,0.6)' : 'rgba(102,126,234,0.4)'};position:relative;${isLocked ? 'opacity:0.6;' : ''}">
                        ${isLocked ? `
                            <div style="position:absolute;top:8px;right:8px;background:rgba(239,68,68,0.8);color:#fff;padding:4px 8px;border-radius:6px;font-size:10px;font-weight:700;">üîí</div>
                        ` : item.premium ? `
                            <div style="position:absolute;top:8px;right:8px;background:linear-gradient(135deg,#ffd700,#ffed4e);color:#000;padding:4px 8px;border-radius:6px;font-size:10px;font-weight:700;box-shadow:0 2px 8px rgba(255,215,0,0.4);">‚≠ê VIP</div>
                        ` : ''}
                        <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                            <span style="font-size:20px;">${item.name.split(' ')[0]}</span>
                            <div style="flex:1;">
                                <div style="font-weight:800;font-size:14px;color:#fff;">${item.name.split(' ').slice(1).join(' ')}</div>
                                <div style="font-size:11px;color:#94a3b8;margin-top:2px;">${item.desc}</div>
                            </div>
                        </div>
                        ${category === 'tap_boost' ? `
                            <div style="background:rgba(102,126,234,0.2);padding:8px;border-radius:8px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center;">
                                <span style="color:#a78bfa;font-size:12px;font-weight:700;">üí™ –ö–ª–∏–∫–æ–≤ –∑–∞ —Ç–∞–ø:</span>
                                <span style="color:#4ade80;font-size:13px;font-weight:800;">+${item.bonus}</span>
                            </div>
                        ` : category === 'energy_buy' ? `
                            <div style="background:rgba(251,191,36,0.2);padding:8px;border-radius:8px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center;">
                                <span style="color:#fbbf24;font-size:12px;font-weight:700;">‚ö° –í–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å:</span>
                                <span style="color:#4ade80;font-size:13px;font-weight:800;">+${item.bonus} —ç–Ω–µ—Ä–≥–∏–∏</span>
                            </div>
                        ` : category === 'energy_expand' ? `
                            <div style="background:rgba(236,72,153,0.2);padding:8px;border-radius:8px;margin-bottom:8px;display:flex;justify-content:space-between;align-items:center;">
                                <span style="color:#ec4899;font-size:12px;font-weight:700;">üìà –†–∞—Å—à–∏—Ä–∏—Ç—å –Ω–∞:</span>
                                <span style="color:#4ade80;font-size:13px;font-weight:800;">+${item.bonus.toLocaleString()}</span>
                            </div>
                        ` : `
                            <div style="background:rgba(16,185,129,0.2);padding:8px;border-radius:8px;margin-bottom:8px;">
                                <div style="display:flex;justify-content:space-between;align-items:center;">
                                    <span style="color:#10b981;font-size:12px;font-weight:700;">‚è±Ô∏è –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:</span>
                                    <span style="color:#fff;font-size:12px;font-weight:800;">${item.duration < 60 ? item.duration + ' –º–∏–Ω—É—Ç' : Math.floor(item.duration / 60) + ' —á–∞—Å–æ–≤'}</span>
                                </div>
                                ${item.speed > 1 ? `
                                <div style="display:flex;justify-content:space-between;align-items:center;margin-top:4px;">
                                    <span style="color:#10b981;font-size:12px;font-weight:700;">‚ö° –°–∫–æ—Ä–æ—Å—Ç—å:</span>
                                    <span style="color:#4ade80;font-size:12px;font-weight:800;">${item.speed} —Ç–∞–ø–æ–≤/—Å–µ–∫</span>
                                </div>
                                ` : ''}
                            </div>
                        `}
                        ${category === 'autobot' ? `
                            <button id="autobot-btn-${item.level}" onclick="${isLocked ? 'tg.showAlert(\'üîí –°–Ω–∞—á–∞–ª–∞ –∫—É–ø–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å\')' : item.currency === 'stars' ? `buyWithStars('${category}', ${item.level}, ${item.price})` : `buyShopItem('${category}', ${item.level}, ${item.price})`}" 
                                    style="width:100%;padding:11px;background:${isLocked ? 'rgba(239,68,68,0.6)' : item.currency === 'stars' ? 'linear-gradient(135deg,#ffd700,#ffed4e,#ffd700)' : 'linear-gradient(135deg,#667eea,#764ba2)'};color:${item.currency === 'stars' ? '#000' : '#fff'};border:${item.currency === 'stars' ? '2px solid #ffd700' : 'none'};border-radius:12px;cursor:${isLocked ? 'not-allowed' : 'pointer'};font-weight:800;font-size:14px;transition:all 0.3s;position:relative;overflow:hidden;box-shadow:${item.currency === 'stars' ? '0 4px 15px rgba(255,215,0,0.4)' : 'none'};"
                                    onmousedown="if(!${isLocked}){this.style.transform='scale(0.95)';this.style.boxShadow='${item.currency === 'stars' ? '0 6px 20px rgba(255,215,0,0.6)' : '0 2px 8px rgba(102,126,234,0.4)'}'}"
                                    onmouseup="if(!${isLocked}){this.style.transform='scale(1)';this.style.boxShadow='${item.currency === 'stars' ? '0 4px 15px rgba(255,215,0,0.4)' : 'none'}'}"
                                    onmouseleave="if(!${isLocked}){this.style.transform='scale(1)';this.style.boxShadow='${item.currency === 'stars' ? '0 4px 15px rgba(255,215,0,0.4)' : 'none'}'}">
                                ${isLocked ? 'üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ' : item.currency === 'stars' ? `–ö—É–ø–∏—Ç—å –∑–∞ ${item.price} ‚≠ê Telegram Stars` : `–ö—É–ø–∏—Ç—å –∑–∞ ${item.price.toLocaleString()} ü™ô`}
                            </button>
                        ` : `
                            <button onclick="${isLocked ? 'tg.showAlert(\'üîí –°–Ω–∞—á–∞–ª–∞ –∫—É–ø–∏—Ç–µ –ø—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–≤–µ–Ω—å\')' : item.currency === 'stars' ? `buyWithStars('${category}', ${item.level}, ${item.price})` : `buyShopItem('${category}', ${item.level}, ${item.price})`}" 
                                    style="width:100%;padding:11px;background:${isLocked ? 'rgba(239,68,68,0.6)' : item.currency === 'stars' ? 'linear-gradient(135deg,#ffd700,#ffed4e,#ffd700)' : 'linear-gradient(135deg,#667eea,#764ba2)'};color:${item.currency === 'stars' ? '#000' : '#fff'};border:${item.currency === 'stars' ? '2px solid #ffd700' : 'none'};border-radius:12px;cursor:${isLocked ? 'not-allowed' : 'pointer'};font-weight:800;font-size:14px;transition:all 0.3s;position:relative;overflow:hidden;box-shadow:${item.currency === 'stars' ? '0 4px 15px rgba(255,215,0,0.4)' : 'none'};"
                                    onmousedown="if(!${isLocked}){this.style.transform='scale(0.95)';this.style.boxShadow='${item.currency === 'stars' ? '0 6px 20px rgba(255,215,0,0.6)' : '0 2px 8px rgba(102,126,234,0.4)'}'}"
                                    onmouseup="if(!${isLocked}){this.style.transform='scale(1)';this.style.boxShadow='${item.currency === 'stars' ? '0 4px 15px rgba(255,215,0,0.4)' : 'none'}'}"
                                    onmouseleave="if(!${isLocked}){this.style.transform='scale(1)';this.style.boxShadow='${item.currency === 'stars' ? '0 4px 15px rgba(255,215,0,0.4)' : 'none'}'}">
                                ${isLocked ? 'üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ' : item.currency === 'stars' ? `–ö—É–ø–∏—Ç—å –∑–∞ ${item.price} ‚≠ê Telegram Stars` : `–ö—É–ø–∏—Ç—å –∑–∞ ${item.price.toLocaleString()} ü™ô`}
                            </button>
                        `}
                    </div>
                `;
            }).join('');
            
            // Add VIP button after regular items (for all categories)
            const vipItems = vipData[category];
            console.log('VIP check:', category, vipItems);
            if (vipItems) {
                list.innerHTML += `
                    <div style="grid-column: 1 / -1; margin-top: 15px; padding: 16px; background: linear-gradient(135deg, rgba(255,215,0,0.15), rgba(255,237,78,0.15)); border: 2px solid rgba(255,215,0,0.5); border-radius: 16px; position: relative; overflow: hidden; box-shadow: 0 6px 20px rgba(255,215,0,0.2);">
                        <!-- VIP Badge -->
                        <div style="position: absolute; top: 8px; right: 8px; background: linear-gradient(135deg, #ffd700, #ffed4e); color: #000; padding: 4px 8px; border-radius: 8px; font-size: 10px; font-weight: 800; box-shadow: 0 2px 8px rgba(255,215,0,0.4);">‚≠ê VIP</div>
                        
                        <!-- VIP Button -->
                        <button onclick="openVIPModal('${category}')" 
                                style="width: 100%; padding: 14px; background: linear-gradient(135deg, #ffd700, #ffed4e, #ffd700); color: #000; border: 2px solid #ffd700; border-radius: 12px; cursor: pointer; font-weight: 800; font-size: 16px; transition: all 0.3s; position: relative; overflow: hidden; box-shadow: 0 4px 15px rgba(255,215,0,0.4); text-shadow: 0 1px 2px rgba(0,0,0,0.2);"
                                onmousedown="this.style.transform='scale(0.96)'; this.style.boxShadow='0 6px 20px rgba(255,215,0,0.6)'"
                                onmouseup="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 15px rgba(255,215,0,0.4)'"
                                onmouseleave="this.style.transform='scale(1)'; this.style.boxShadow='0 4px 15px rgba(255,215,0,0.4)'">
                            <span style="font-size: 18px; margin-right: 8px;">‚≠ê</span>
                            –ö—É–ø–∏—Ç—å VIP —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞ Telegram Stars
                        </button>
                    </div>
                `;
                console.log('VIP button added for category:', category);
            } else {
                console.log('No VIP data for category:', category);
            }
            
            // Update autobot buttons if autobot category is loaded
            if (category === 'autobot') {
                // Fetch current user data to update autobot buttons
                fetch('/api/user_data', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: window.user?.id})
                })
                .then(res => res.json())
                .then(data => {
                    updateAutobotShopButtons(data);
                })
                .catch(err => console.error('Error loading user data for autobots:', err));
            }
        }
        
        function buyShopItem(category, level, price) {
            fetch('/api/buy_shop_item', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: window.user?.id, 
                    category: category,
                    level: level,
                    price: price
                })
            })
            .then(res => res.json())
            .then(data => {
                if(data.success) {
                    // Beautiful single success notification
                    const anim = document.createElement('div');
                    anim.style.cssText='position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
                    anim.innerHTML='<div style="background:linear-gradient(135deg,rgba(34,197,94,0.95),rgba(16,185,129,0.95));padding:20px 40px;border-radius:20px;font-size:24px;box-shadow:0 10px 40px rgba(16,185,129,0.6);color:#fff;font-weight:700;display:flex;align-items:center;gap:15px;"><span style="font-size:32px;">‚ú®</span> –ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞!</div>';
                    document.body.appendChild(anim);
                    setTimeout(()=>{anim.style.opacity='0';anim.style.transform='translate(-50%,-70%)';setTimeout(()=>{anim.remove();},300);},1000);
                    
                    loadData();
                    
                    // Force immediate reload of cards shop - preserve current category
                    if(document.getElementById('shopCardsList')) {
                        const activeBtn = document.querySelector('#cardsShopSection .shop-cat-btn[style*="linear-gradient"]');
                        const cardCategory = activeBtn && activeBtn.dataset.category ? activeBtn.dataset.category : 
                                          (activeBtn && activeBtn.textContent.includes('–í –º–∏–Ω—É—Ç—É') ? 'per_minute' : 'per_hour');
                        fetch('/api/shop', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({user_id: user?.id, category: 'cards'})
                        })
                        .then(res => res.json())
                        .then(shopData => {
                            const shopList = document.getElementById('shopCardsList');
                            const filterCategory = cardCategory || 'per_hour';
                            const cards = shopData.items.filter(item => item.type === 'card' && (filterCategory === 'all' || item.income_type === filterCategory));
                            if(cards && cards.length > 0) {
                                shopList.innerHTML = cards.map(card => {
                                // Remove locking - all cards are available
                                const rarity = card.rarity || 'common';
                                const rarityInfo = {
                                    'common': {emoji:'‚ö™', name:'–û–±—ã—á–Ω–∞—è', color:'rgba(255,255,255,0.15)', border:'rgba(255,255,255,0.4)'},
                                    'rare': {emoji:'üîµ', name:'–†–µ–¥–∫–∞—è', color:'rgba(102,126,234,0.25)', border:'rgba(102,126,234,0.8)'},
                                    'epic': {emoji:'üü£', name:'–≠–ø–∏—á–µ—Å–∫–∞—è', color:'rgba(118,75,162,0.25)', border:'rgba(118,75,162,0.8)'},
                                    'legendary': {emoji:'üü°', name:'–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è', color:'rgba(234,179,8,0.25)', border:'rgba(234,179,8,0.8)'}
                                };
                                const info = rarityInfo[rarity];
                                const income = card.income_per_min || 0;
                                const incomeType = card.income_type === 'per_minute' ? '/–º–∏–Ω' : '/—á–∞—Å';
                                const level = card.level || 1;
                                const nameParts = card.name || '–ö–∞—Ä—Ç–æ—á–∫–∞';
                                const cardEmoji = nameParts.match(/[\u{1F600}-\u{1F9FF}]/u)?.[0] || 'üí≥';
                                const cardName = nameParts.replace(/[\u{1F600}-\u{1F9FF}]/u, '').trim();
                                return `
                                    <div style="background:${info.color};padding:12px;border-radius:12px;border:2px solid ${info.border};">
                                        <div style="font-size:24px;text-align:center;margin-bottom:6px;">${cardEmoji}</div>
                                        <div style="font-size:10px;font-weight:700;color:#fff;text-align:center;margin-bottom:6px;">${cardName}</div>
                                        <div style="font-size:11px;color:#94a3b8;text-align:center;margin-bottom:6px;">${card.description}</div>
                                        <div style="font-size:12px;color:#10b981;text-align:center;margin-bottom:6px;font-weight:700;">+${income.toFixed(1)} ü™ô${incomeType}</div>
                                        <div style="font-size:9px;color:#fbbf24;text-align:center;margin-bottom:8px;font-weight:600;">Lv.${level} ${info.name}</div>
                                        <button onclick="buyShopItem('card', 1, ${card.price || 0})" style="width:100%;padding:8px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:11px;">
                                            ü™ô ${(card.price || 0).toLocaleString()}
                                        </button>
                                    </div>
                                `;
                                }).join('');
                            }
                        });
                    }
                    
                    // Update passive income immediately
                    updatePassiveIncome();
                } else {
                    const error = document.createElement('div');
                    error.style.cssText='position:fixed;top:20%;left:50%;transform:translate(-50%,-50%);z-index:10000;pointer-events:none;';
                    error.innerHTML='<div style="background:rgba(239,68,68,0.95);padding:20px 40px;border-radius:20px;font-size:24px;color:#fff;font-weight:700;">‚ùå ' + data.error + '</div>';
                    document.body.appendChild(error);
                    setTimeout(()=>{error.remove();},2000);
                }
            });
        }

        function renderShop() {
            const boostsHtml = shopItems.boosts.map(item => `
                <div class="item" onclick="buyItem('boost', '${item.type}', ${item.price})">
                    <div class="item-info">
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="item-desc">${item.desc}</div>
                            <div class="item-price">${item.price.toLocaleString()} ü™ô</div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('boostsList').innerHTML = boostsHtml;

            const automationHtml = shopItems.automation.map(item => `
                <div class="item" onclick="buyItem('automation', '${item.type}', ${item.price})">
                    <div class="item-info">
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="item-desc">${item.desc}</div>
                            <div class="item-price">${item.price.toLocaleString()} ü™ô</div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('automationList').innerHTML = automationHtml;

            const energyHtml = shopItems.energy.map(item => `
                <div class="item" onclick="buyEnergy(${item.amount}, ${item.price})">
                    <div class="item-info">
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-details">
                            <div class="item-name">–≠–Ω–µ—Ä–≥–∏—è +${item.amount}</div>
                            <div class="item-price">${item.price.toLocaleString()} ü™ô</div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('energyList').innerHTML = energyHtml;

            const cardsHtml = shopItems.cards.map(item => `
                <div class="item" onclick="buyItem('card', '${item.type}', ${item.price})">
                    <div class="item-info">
                        <div class="item-emoji">${item.emoji}</div>
                        <div class="item-details">
                            <div class="item-name">${item.name}</div>
                            <div class="item-desc">${item.desc}</div>
                            <div class="item-price">${item.price.toLocaleString()} ü™ô</div>
                        </div>
                    </div>
                </div>
            `).join('');
            document.getElementById('cardsList').innerHTML = cardsHtml;
        }

        function buyItem(type, id, price) {
            fetch('/api/buy', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: user?.id, item_type: id, price: price})
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('‚úÖ –ü–æ–∫—É–ø–∫–∞ —É—Å–ø–µ—à–Ω–∞!');
                    loadData();
                    renderShop();
                } else {
                    tg.showAlert('‚ö†Ô∏è ' + data.error);
                }
            })
            .catch(err => {
                tg.showAlert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏');
            });
        }

        function buyEnergy(amount, price) {
            fetch('/api/buy_energy', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: user?.id, amount: amount, price: price})
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('‚úÖ –≠–Ω–µ—Ä–≥–∏—è –∫—É–ø–ª–µ–Ω–∞!');
                    loadData();
                    renderShop();
                } else {
                    tg.showAlert('‚ö†Ô∏è ' + data.error);
                }
            })
            .catch(err => {
                tg.showAlert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏');
            });
        }

        function openMining(e) {
            e.preventDefault();
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'miningModal2';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px; max-height: 80vh; overflow-y: auto;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h2 style="font-size: 20px; color: #fff;">‚ö° –ú–∞–π–Ω–∏–Ω–≥</h2>
                        <button onclick="this.closest('.modal').remove()" style="background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:8px;width:32px;height:32px;color:#fff;cursor:pointer;font-size:18px;">‚úï</button>
                    </div>
                    <div style="display:flex;gap:10px;margin-bottom:20px;">
                        <button class="category-btn" onclick="loadMiningCategory('starter')" style="padding:10px 20px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:600;">üìä –°—Ç–∞—Ä—Ç–æ–≤—ã–µ</button>
                        <button class="category-btn" onclick="loadMiningCategory('premium')" style="padding:10px 20px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:12px;cursor:pointer;font-weight:600;">üíé –ü—Ä–µ–º–∏—É–º</button>
                    </div>
                    <div id="miningShop" style="display:grid;gap:10px;margin-bottom:20px;"></div>
                    <div id="userMachines" style="margin-top:20px;padding-top:20px;border-top:1px solid rgba(255,255,255,0.1);">
                        <h3 style="font-size:16px;margin-bottom:10px;">üóÉÔ∏è –í–∞—à–∏ –º–∞—à–∏–Ω—ã</h3>
                        <div id="machinesList"></div>
                    </div>
                    <button onclick="this.closest('.modal').remove()" style="width:100%;padding:12px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:12px;cursor:pointer;font-weight:600;margin-top:20px;">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            `;
            document.body.appendChild(modal);
            loadMiningCategory('starter');
            
            // Check VIP level and add VIP section if applicable
            setTimeout(() => {
                checkAndShowVIPMachines();
            }, 100);
        }
        
        function checkAndShowVIPMachines() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const vipLevel = data.vip_level || 0;
                const shopDiv = document.getElementById('miningShop');
                
                if (vipLevel >= 5 && shopDiv && !shopDiv.querySelector('.vip-machines-section')) {
                    const vipSection = document.createElement('div');
                    vipSection.className = 'vip-machines-section';
                    vipSection.innerHTML = `
                        <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:12px;border-radius:12px;margin-bottom:15px;border:2px solid #ffd700;">
                            <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;">
                                <div style="font-size:14px;font-weight:700;color:#000;margin-bottom:5px;">‚ö° Quantum Miners Pro</div>
                                <div style="font-size:11px;color:rgba(0,0,0,0.7);margin-bottom:8px;">500 QuanHash/—á–∞—Å ‚Ä¢ –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω–∞—è –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å</div>
                                <div style="font-size:10px;color:#000;margin-bottom:8px;">‚úÖ –¢–æ–ª—å–∫–æ –¥–ª—è Diamond VIP –∏ –≤—ã—à–µ</div>
                                <button onclick="buyVipMiningMachine('quantum_pro', 50000000)" style="width:100%;padding:10px;background:#000;color:#ffd700;border:none;border-radius:8px;font-weight:800;font-size:12px;cursor:pointer;">üí∞ 50M ü™ô</button>
                            </div>
                        </div>
                        ${vipLevel >= 6 ? `
                        <div style="background:linear-gradient(135deg,#c084fc,#a78bfa);padding:12px;border-radius:12px;margin-bottom:15px;border:2px solid #c084fc;">
                            <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;">
                                <div style="font-size:14px;font-weight:700;color:#fff;margin-bottom:5px;">üíé Absolute Hash Machine</div>
                                <div style="font-size:11px;color:rgba(255,255,255,0.8);margin-bottom:8px;">1000 QuanHash/—á–∞—Å ‚Ä¢ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å</div>
                                <div style="font-size:10px;color:#c084fc;margin-bottom:8px;">‚úÖ –¢–æ–ª—å–∫–æ –¥–ª—è Absolute VIP</div>
                                <button onclick="buyVipMiningMachine('absolute_pro', 100000000)" style="width:100%;padding:10px;background:#fff;color:#a78bfa;border:none;border-radius:8px;font-weight:800;font-size:12px;cursor:pointer;">üí∞ 100M ü™ô</button>
                            </div>
                        </div>
                        ` : ''}
                    `;
                    if (shopDiv) {
                        shopDiv.insertBefore(vipSection, shopDiv.firstChild);
                    }
                }
            });
        }
        
        function buyVipMiningMachine(machineType, price) {
            fetch('/api/buy_vip_machine', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: user?.id,
                    machine_type: machineType,
                    price: price
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('‚úÖ VIP –º–∞—à–∏–Ω–∞ –∫—É–ø–ª–µ–Ω–∞!');
                    loadData();
                    document.querySelector('.modal').remove();
                    openMining({preventDefault:()=>{}});
                } else {
                    tg.showAlert('‚ùå ' + data.error);
                }
            })
            .catch(err => tg.showAlert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏'));
        }
        
        function loadMiningCategory(category) {
            // Update button states
            document.querySelectorAll('.category-btn').forEach(btn => {
                if(btn.textContent.includes(category === 'starter' ? '–°—Ç–∞—Ä—Ç–æ–≤—ã–µ' : '–ü—Ä–µ–º–∏—É–º')) {
                    btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                    btn.style.border = 'none';
                } else {
                    btn.style.background = 'rgba(255,255,255,0.1)';
                    btn.style.border = '1px solid rgba(255,255,255,0.3)';
                }
            });
            
            fetch('/api/mining', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: user?.id, category: category})
            })
            .then(res => res.json())
            .then(data => {
                const shop = document.getElementById('miningShop');
                if(shop) {
                    shop.innerHTML = data.shop_machines.map((m, index) => {
                        // Remove locking - all machines are available
                        const isLocked = false;
                        
                        if (isLocked) {
                            return `
                                <div style="background:rgba(60,60,60,0.3);padding:15px;border-radius:12px;border:1px solid rgba(100,100,100,0.4);opacity:0.6;position:relative;">
                                    <div style="position:absolute;top:5px;right:5px;background:rgba(239,68,68,0.8);color:#fff;padding:2px 8px;border-radius:10px;font-size:10px;font-weight:700;">üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</div>
                                    <div style="font-size:24px;text-align:center;margin-bottom:6px;">üîí</div>
                                    <div style="font-weight:700;margin-bottom:8px;color:#999;">${m.name}</div>
                                    <div style="font-size:12px;color:#666;margin-bottom:10px;">
                                        ü™ô Hash: ${m.hash_rate}/s | üí∞ –î–æ—Ö–æ–¥/—á: ${m.hash_per_hour}
                                    </div>
                                    <button disabled style="width:100%;padding:8px;background:rgba(100,100,100,0.5);color:#ccc;border:none;border-radius:8px;cursor:not-allowed;font-weight:600;">üîí –î–æ—Å—Ç—É–ø–Ω–æ —Å —É—Ä.5 –ø—Ä–µ–¥—ã–¥—É—â–µ–π</button>
                                </div>
                            `;
                        } else {
                            return `
                                <div style="background:rgba(0,0,0,0.3);padding:15px;border-radius:12px;border:1px solid rgba(102,126,234,0.3);">
                                    <div style="font-weight:700;margin-bottom:8px;">${m.name}</div>
                                    <div style="font-size:12px;color:#94a3b8;margin-bottom:10px;">
                                        ü™ô Hash: ${m.hash_rate}/s | üí∞ –î–æ—Ö–æ–¥/—á: ${m.hash_per_hour}
                                    </div>
                                    <button onclick="buyMachine('${m.id}', ${m.price}, '${m.currency}')" style="width:100%;padding:8px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:600;">
                                        –ö—É–ø–∏—Ç—å –∑–∞ ${m.price} ${m.currency === 'coins' ? 'ü™ô' : 'üíé'}
                                    </button>
                                </div>
                            `;
                        }
                    }).join('');
                    
                    // Show user machines
                    const machinesList = document.getElementById('machinesList');
                    if(machinesList && data.user_machines) {
                        if(data.user_machines.length > 0) {
                            machinesList.innerHTML = data.user_machines.map(m => `
                                <div style="background:rgba(102,126,234,0.1);padding:12px;border-radius:10px;border:2px solid rgba(102,126,234,0.3);margin-bottom:8px;animation:slideIn 0.3s ease-out;">
                                    <div style="display:flex;justify-content:space-between;align-items:center;">
                                        <div>
                                            <div style="font-weight:700;font-size:14px;margin-bottom:4px;">${m.name}</div>
                                            <div style="font-size:11px;color:#94a3b8;">–£—Ä–æ–≤–µ–Ω—å ${m.level} | ${m.hash_rate} Hash/s</div>
                                            <div style="font-size:12px;color:#4ade80;margin-top:4px;">üí∞ +${Math.floor(m.income_per_hour || 0)}üíé/—á–∞—Å</div>
                                        </div>
                                        <div style="text-align:right;">
                                            <div style="font-size:20px;">‚ö°</div>
                                        </div>
                                    </div>
                                </div>
                            `).join('');
                        } else {
                            machinesList.innerHTML = '<p style="text-align:center;opacity:0.7;padding:15px;">–£ –≤–∞—Å –Ω–µ—Ç –º–∞—à–∏–Ω. –ö—É–ø–∏—Ç–µ –∏—Ö –≤—ã—à–µ!</p>';
                        }
                    }
                }
            });
        }
        
        function buyMachine(id, price, currency) {
            const anim = document.createElement('div');
            anim.style.cssText='position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0.5);z-index:10000;opacity:0;transition:all 0.4s ease-out;pointer-events:none;';
            anim.innerHTML='<div style="background:linear-gradient(135deg,rgba(102,126,234,0.98),rgba(118,75,162,0.98));padding:25px 50px;border-radius:20px;font-size:36px;box-shadow:0 20px 60px rgba(102,126,234,0.8);text-shadow:0 0 20px rgba(255,255,255,0.8);">‚ö° –ü–æ–∫—É–ø–∫–∞...</div>';
            document.body.appendChild(anim);
            setTimeout(()=>{anim.style.opacity='1';anim.style.transform='translate(-50%,-50%) scale(1)';},10);
            
            fetch('/api/buy_machine', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: user?.id,
                    machine_id: id,
                    price: price,
                    currency: currency
                })
            })
            .then(res => res.json())
            .then(data => {
                if(data.success) {
                    anim.innerHTML='‚úÖ';
                    setTimeout(()=>{
                        anim.style.opacity='0';anim.style.transform='translate(-50%,-50%) scale(1.5)';
                        setTimeout(()=>{anim.remove();},300);
                    },500);
                    loadMiningCategory(document.querySelector('.category-btn[style*="background: linear-gradient"]').textContent.includes('–°—Ç–∞—Ä—Ç–æ–≤—ã–µ') ? 'starter' : 'premium');
                    loadData();
                } else {
                    anim.innerHTML='‚ùå ' + data.error;
                    anim.style.background='rgba(239,68,68,0.95)';
                    setTimeout(()=>{anim.remove();},1500);
                }
            });
        }

        function openCards(e) {
            e.preventDefault();
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'cardsModal2';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 420px; max-height: 85vh; overflow-y: auto;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h2 style="font-size: 24px; color: #fff; font-weight: 800;">üí≥ –ö—Ä–∏–ø—Ç–æ-–ö–∞—Ä—Ç–æ—á–∫–∏</h2>
                        <button onclick="this.closest('.modal').remove()" style="background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:8px;width:32px;height:32px;color:#fff;cursor:pointer;font-size:18px;">‚úï</button>
                    </div>
                    
                    <div style="background:linear-gradient(135deg,rgba(102,126,234,0.15),rgba(118,75,162,0.15));padding:15px;border-radius:15px;margin-bottom:20px;border:2px solid rgba(102,126,234,0.3);">
                        <div style="font-size:13px;color:#94a3b8;line-height:1.6;">
                            <strong style="color:#fff;">üìã –ü–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥ 24/7:</strong> –ö—Ä–∏–ø—Ç–æ-–∫–∞—Ä—Ç–æ—á–∫–∏ –≥–µ–Ω–µ—Ä–∏—Ä—É—é—Ç –∫–æ–∏–Ω—ã –∫–∞–∂–¥—É—é –º–∏–Ω—É—Ç—É! –†–∞–∑–Ω—ã–µ —Ä–µ–¥–∫–æ—Å—Ç–∏ = —Ä–∞–∑–Ω—ã–π –¥–æ—Ö–æ–¥. –ó–∞—Ä–∞–±–∞—Ç—ã–≤–∞–π—Ç–µ –¥–∞–∂–µ –æ—Ñ—Ñ–ª–∞–π–Ω!
                        </div>
                    </div>
                    
                    <div id="cardsShopSection" style="margin-bottom:25px;">
                        <div style="font-size:16px;font-weight:700;color:#fff;margin-bottom:15px;display:flex;align-items:center;gap:8px;grid-column:1/-1;">
                            <span style="background:linear-gradient(135deg,#667eea,#764ba2);padding:6px 12px;border-radius:8px;width:100%;text-align:center;">üõí –ú–∞–≥–∞–∑–∏–Ω –∫–∞—Ä—Ç–æ—á–µ–∫</span>
                        </div>
                        <div style="display:grid;grid-template-columns:repeat(2,1fr);gap:10px;margin-bottom:15px;">
                            <button class="filter-btn shop-cat-btn" data-category="per_hour" onclick="loadCardsCategory('per_hour')" style="padding:10px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:10px;cursor:pointer;font-weight:600;font-size:12px;">‚ö° –í —á–∞—Å (–û—Å–Ω–æ–≤–Ω—ã–µ)</button>
                            <button class="filter-btn shop-cat-btn" data-category="per_minute" onclick="loadCardsCategory('per_minute')" style="padding:10px;background:rgba(255,255,255,0.1);color:#fff;border:1px solid rgba(255,255,255,0.3);border-radius:10px;cursor:pointer;font-weight:600;font-size:12px;">üíé –í –º–∏–Ω—É—Ç—É (–ü—Ä–µ–º–∏—É–º)</button>
                        </div>
                        <div id="shopCardsList" style="display:grid;grid-template-columns:repeat(2,1fr);gap:12px;"></div>
                        <div id="vipCardsSection" style="display:none;margin-top:20px;"></div>
                    </div>
                    
                    <div id="passiveInfo" style="background:linear-gradient(135deg,rgba(16,185,129,0.2),rgba(34,197,94,0.2));padding:20px;border-radius:15px;border:2px solid rgba(16,185,129,0.4);text-align:center;margin-top:20px;margin-bottom:15px;">
                        <div style="font-size:14px;font-weight:700;margin-bottom:10px;color:#10b981;">üí∞ –û–±—â–∏–π –ø–∞—Å—Å–∏–≤–Ω—ã–π –¥–æ—Ö–æ–¥</div>
                        <div style="font-size:36px;font-weight:900;color:#10b981;text-shadow:0 0 20px rgba(16,185,129,0.5);">+0 ü™ô/—á–∞—Å</div>
                    </div>
                    
                    <button onclick="this.closest('.modal').remove()" style="width:100%;padding:14px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:12px;cursor:pointer;font-weight:700;font-size:16px;">–ó–∞–∫—Ä—ã—Ç—å</button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Load VIP cards
            showVIPCards();
            
            // Load cards function
            window.loadCardsCategory = function(category) {
                document.querySelectorAll('#cardsShopSection .shop-cat-btn').forEach(btn => {
                    if(btn.textContent.toLowerCase().includes(category === 'per_hour' ? '—á–∞—Å' : '–º–∏–Ω—É—Ç—É')) {
                        btn.style.background = 'linear-gradient(135deg,#667eea,#764ba2)';
                        btn.style.border = 'none';
                    } else {
                        btn.style.background = 'rgba(255,255,255,0.1)';
                        btn.style.border = '1px solid rgba(255,255,255,0.3)';
                    }
                });
                loadCardsList(category);
            };
            
            function showVIPCards() {
                fetch('/api/user_data', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: window.user?.id})
                })
                .then(res => res.json())
                .then(data => {
                    const vipLevel = data.vip_level || 0;
                    const vipCardsSection = document.getElementById('vipCardsSection');
                    
                    if (vipLevel >= 3 && vipCardsSection) {
                        vipCardsSection.style.display = 'block';
                        vipCardsSection.innerHTML = `
                            <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:12px;border-radius:12px;margin-bottom:15px;border:3px solid #ffd700;">
                                <div style="font-size:14px;font-weight:800;color:#000;margin-bottom:5px;">üëë VIP –ö–ê–†–¢–û–ß–ö–ò</div>
                                <div style="font-size:11px;color:rgba(0,0,0,0.7);margin-bottom:10px;">–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –∫–∞—Ä—Ç–æ—á–∫–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è VIP!</div>
                                <div style="background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;">
                                    <div style="font-size:12px;font-weight:700;color:#000;margin-bottom:5px;">üíé VIP Diamond Card</div>
                                    <div style="font-size:11px;color:rgba(0,0,0,0.7);margin-bottom:8px;">+500,000 ü™ô/—á–∞—Å ‚Ä¢ –¢–æ–ª—å–∫–æ –¥–ª—è Diamond VIP</div>
                                    <button onclick="buyVIPCard('diamond')" style="width:100%;padding:9px;background:#000;color:#ffd700;border:none;border-radius:8px;font-weight:800;font-size:11px;cursor:pointer;">üí∞ 50M ü™ô</button>
                                </div>
                            </div>
                        `;
                    }
                });
            }
            
            window.buyVIPCard = function(cardType) {
                fetch('/api/buy_vip_card', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({
                        user_id: user?.id,
                        card_type: cardType
                    })
                })
                .then(res => res.json())
                .then(data => {
                    if (data.success) {
                        tg.showAlert('‚úÖ VIP –∫–∞—Ä—Ç–æ—á–∫–∞ –∫—É–ø–ª–µ–Ω–∞!');
                        loadData();
                        showVIPCards();
                    } else {
                        tg.showAlert('‚ùå ' + data.error);
                    }
                })
                .catch(err => tg.showAlert('‚ùå –û—à–∏–±–∫–∞ –ø–æ–∫—É–ø–∫–∏'));
            };
            
            function loadCardsList(category) {
                fetch('/api/shop', {
                    method: 'POST',
                    headers: {'Content-Type': 'application/json'},
                    body: JSON.stringify({user_id: user?.id, category: 'cards'})
                })
                .then(res => res.json())
                .then(shopData => {
                    const shopList = document.getElementById('shopCardsList');
                    const cards = shopData.items.filter(item => item.type === 'card' && (category === 'all' || item.income_type === category));
                    if(cards && cards.length > 0) {
                        shopList.innerHTML = cards.map(card => {
                        // Skip locked cards
                        // Remove locking - all cards are available
                        const rarity = card.rarity || 'common';
                        const rarityInfo = {
                            'common': {emoji:'‚ö™', name:'–û–±—ã—á–Ω–∞—è', color:'rgba(255,255,255,0.15)', border:'rgba(255,255,255,0.4)'},
                            'rare': {emoji:'üîµ', name:'–†–µ–¥–∫–∞—è', color:'rgba(102,126,234,0.25)', border:'rgba(102,126,234,0.8)'},
                            'epic': {emoji:'üü£', name:'–≠–ø–∏—á–µ—Å–∫–∞—è', color:'rgba(118,75,162,0.25)', border:'rgba(118,75,162,0.8)'},
                            'legendary': {emoji:'üü°', name:'–õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è', color:'rgba(234,179,8,0.25)', border:'rgba(234,179,8,0.8)'}
                        };
                        const info = rarityInfo[rarity];
                        const income = card.income_per_min || 0;
                        const incomeType = card.income_type === 'per_minute' ? '/–º–∏–Ω' : '/—á–∞—Å';
                        const level = card.level || 1;
                        const nameParts = card.name || '–ö–∞—Ä—Ç–æ—á–∫–∞';
                        const cardEmoji = nameParts.match(/[\u{1F600}-\u{1F9FF}]/u)?.[0] || 'üí≥';
                        const cardName = nameParts.replace(/[\u{1F600}-\u{1F9FF}]/u, '').trim();
                        return `
                            <div style="background:${info.color};padding:12px;border-radius:12px;border:2px solid ${info.border};">
                                <div style="font-size:24px;text-align:center;margin-bottom:6px;">${cardEmoji}</div>
                                <div style="font-size:10px;font-weight:700;color:#fff;text-align:center;margin-bottom:6px;">${cardName}</div>
                                <div style="font-size:11px;color:#94a3b8;text-align:center;margin-bottom:6px;">${card.description}</div>
                                <div style="font-size:12px;color:#10b981;text-align:center;margin-bottom:6px;font-weight:700;">+${income.toFixed(1)} ü™ô${incomeType}</div>
                                <div style="font-size:9px;color:#fbbf24;text-align:center;margin-bottom:8px;font-weight:600;">Lv.${level} ${info.name}</div>
                                <button onclick="buyShopItem('${card.id}', ${card.price || 0})" style="width:100%;padding:8px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:11px;">
                                    ü™ô ${(card.price || 0).toLocaleString()}
                                </button>
                            </div>
                        `;
                    }).join('');
                    } else {
                        shopList.innerHTML = '<div style="grid-column:span 2;text-align:center;padding:20px;color:#94a3b8;background:rgba(255,255,255,0.05);border-radius:12px;">–ö–∞—Ä—Ç–æ—á–∫–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã</div>';
                    }
                });
            }
            
            // Load per_hour cards by default
            loadCardsList('per_hour');
            
            // Update passive income immediately
            updatePassiveIncome();
        }
        
        function updatePassiveIncome() {
            fetch('/api/cards', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                // Update passive info display with rounded whole numbers
                const totalPassive = Math.round(data.total_passive_per_hour || 0);
                const passiveInfo = document.getElementById('passiveInfo');
                if(passiveInfo && passiveInfo.querySelector('div:last-child')) {
                    passiveInfo.querySelector('div:last-child').textContent = `+${totalPassive.toLocaleString()} ü™ô/—á–∞—Å`;
                }
            })
            .catch(err => console.error('Error updating passive income:', err));
        }
        
        // Update passive income every second when cards modal is open
        let passiveIncomeInterval = null;
        document.addEventListener('click', function(e) {
            if(e.target.textContent && e.target.textContent.includes('–ö–∞—Ä—Ç–æ—á–∫–∏')) {
                if(!passiveIncomeInterval) {
                    updatePassiveIncome();
                    passiveIncomeInterval = setInterval(updatePassiveIncome, 1000);
                }
            }
        });

        function openStats(e) {
            e.preventDefault();
            document.getElementById('statsModal').classList.add('active');
            fetch('/api/stats', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const statsHtml = `
                    <div class="stats-row">
                        <span class="stats-label">üëÜ –í—Å–µ–≥–æ —Ç–∞–ø–æ–≤</span>
                        <span class="stats-value">${data.total_taps || 0}</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">üí∞ –ó–∞—Ä–∞–±–æ—Ç–∞–Ω–æ</span>
                        <span class="stats-value">${Math.floor(data.total_earned || 0)} ü™ô</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">üíé –î–æ–±—ã—Ç–æ</span>
                        <span class="stats-value">${Math.floor(data.total_mined || 0)} ‚ö°</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">üí∞ –ë–∞–ª–∞–Ω—Å</span>
                        <span class="stats-value">${Math.floor(data.coins || 0)} ü™ô</span>
                    </div>
                    <div class="stats-row">
                        <span class="stats-label">üíé QuanHash</span>
                        <span class="stats-value">${Math.floor(data.quanhash || 0)} ‚ö°</span>
                    </div>
                `;
                document.getElementById('statsContent').innerHTML = statsHtml;
            });
        }

        function openReferrals(e) {
            e.preventDefault();
            document.getElementById('referralsModal').classList.add('active');
            fetch('/api/referrals', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                document.getElementById('refCount').textContent = data.referrals_count || 0;
                document.getElementById('refIncome').textContent = `${Math.floor(data.referral_income || 0)} ü™ô`;
                // Generate correct referral link using referral_code
                const botUsername = 'qanexus_bot'; // Correct bot username
                const refCode = data.referral_code || user?.id || 'no_code'; // Use referral_code from API
                const refLink = `https://t.me/${botUsername}?start=${refCode}`;
                document.getElementById('refLink').textContent = refLink;
            });
        }

        function copyRefLink() {
            const link = document.getElementById('refLink').textContent;
            navigator.clipboard.writeText(link);
            tg.showAlert('‚úÖ –°—Å—ã–ª–∫–∞ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∞!');
        }

        function openWithdrawModal(e) {
            if(e && e.preventDefault) e.preventDefault();
            document.getElementById('withdrawModal').classList.add('active');
            
            // Check if user has enough QuanHash
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const quanhash = Math.floor(data.quanhash || 0);
                const hasEnough = quanhash >= 500000;
                const vipLevel = data.vip_level || 0;
                const isVIP = vipLevel >= 3;
                const isDiamond = vipLevel >= 5;
                
                // VIP bonuses
                const feePercent = isDiamond ? 0 : isVIP ? 2 : 5;
                const minWithdraw = isDiamond ? 100000 : isVIP ? 250000 : 500000;
                const withdrawMultiplier = isDiamond ? 2 : isVIP ? 1.5 : 1;
                
                document.getElementById('withdrawContent').innerHTML = `
                    <div style="padding: 15px;">
                        <div style="text-align: center; margin-bottom: 15px;">
                            <div style="font-size: 40px; margin-bottom: 8px;">üíé</div>
                            <div style="font-size: 16px; font-weight: bold;">–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</div>
                            <div style="font-size: 13px; opacity: 0.7; margin-top: 4px;">–£ –≤–∞—Å: ${quanhash.toLocaleString()} üíé</div>
                            ${isVIP ? `
                            <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:8px 12px;border-radius:8px;margin-top:8px;font-size:12px;font-weight:800;color:#000;border:2px solid #ffd700;">
                                üëë VIP –ë–û–ù–£–°: ${feePercent === 0 ? '0% –∫–æ–º–∏—Å—Å–∏—è!' : feePercent + '% –∫–æ–º–∏—Å—Å–∏—è ‚Ä¢ x' + withdrawMultiplier + ' –ª–∏–º–∏—Ç'}
                            </div>
                            ` : ''}
                        </div>
                        <div style="background: rgba(102, 126, 234, 0.1); border: 1px solid rgba(102, 126, 234, 0.3); border-radius: 10px; padding: 12px; margin-bottom: 15px;">
                            <div style="font-size: 13px; opacity: 0.8; margin-bottom: 4px;">–û–±–º–µ–Ω</div>
                            <div style="font-size: 16px; font-weight: bold;">500,000 üíé = $1 USDT</div>
                            ${feePercent === 0 ? `
                            <div style="font-size:12px;color:#ffd700;font-weight:700;margin-top:4px;">‚ú® –ù–ï–¢ –ö–û–ú–ò–°–°–ò–ò (Diamond VIP)</div>
                            ` : ''}
                        </div>
                        <div style="margin-bottom: 12px;">
                            <div style="margin-bottom: 6px; font-weight: 500; font-size: 13px;">–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ QuanHash (–º–∏–Ω. 500,000):</div>
                            <input type="number" id="quanhashAmount" value="${minWithdraw}" min="${minWithdraw}" step="1000" style="width: 100%; padding: 10px; background: rgba(255,255,255,0.1); border: 1px solid rgba(102, 126, 234, 0.3); border-radius: 10px; color: white; font-size: 14px;" oninput="updateUSDTAmount()">
                            <div id="usdtAmount" style="margin-top: 6px; font-size: 13px; font-weight: bold; color: #10b981;">–ü–æ–ª—É—á–∏—Ç–µ: $1.00 USDT</div>
                        </div>
                        <div style="margin-bottom: 15px;">
                            <div style="margin-bottom: 6px; font-weight: 500; font-size: 13px;">BEP20 –∞–¥—Ä–µ—Å:</div>
                            <input type="text" id="usdtAddress" placeholder="0x0000...0000" style="width: 100%; padding: 12px; background: rgba(255,255,255,0.1); border: 1px solid rgba(102, 126, 234, 0.3); border-radius: 10px; color: white; font-size: 14px; font-weight: 600;">
                        </div>
                        <button id="withdrawBtn" class="action-btn" onclick="withdraw()" style="width: 100%; margin-bottom: 15px; padding: 12px; ${hasEnough ? '' : 'opacity: 0.5; cursor: not-allowed;'}" ${hasEnough ? '' : 'disabled'}>${hasEnough ? 'üí∏ –í—ã–≤–µ—Å—Ç–∏' : '‚ö†Ô∏è –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ QuanHash'}</button>
                        <div style="border-top: 2px solid rgba(255,255,255,0.1); padding-top: 15px; margin-top: 15px;">
                            <div style="font-size: 15px; font-weight: bold; margin-bottom: 12px; text-align: center;">üìú –ò—Å—Ç–æ—Ä–∏—è –≤—ã–≤–æ–¥–æ–≤</div>
                            <div id="withdrawHistory" style="max-height: 120px; overflow-y: auto;"></div>
                        </div>
                    </div>
                `;
                    
                    // Load transaction history
                    loadWithdrawHistory();
            });
        }

        function loadWithdrawHistory() {
            fetch('/api/history', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const historyDiv = document.getElementById('withdrawHistory');
                if(!historyDiv) return;
                
                console.log('Withdrawal history data:', data);
                
                const withdrawals = data.history || [];
                console.log('Withdrawals found:', withdrawals.length);
                
                if(withdrawals.length > 0) {
                    historyDiv.innerHTML = withdrawals.map(w => {
                        const date = new Date(w.date);
                        // Status in Russian from server
                        const statusText = w.status || '–í –ø—Ä–æ—Ü–µ—Å—Å–µ';
                        const statusEmoji = statusText === '–í –ø—Ä–æ—Ü–µ—Å—Å–µ' ? '‚è≥' : statusText === '–í—ã–ø–ª–∞—á–µ–Ω–æ' ? '‚úÖ' : statusText === '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ' ? '‚ùå' : '‚è≥';
                        const statusColor = statusText === '–í –ø—Ä–æ—Ü–µ—Å—Å–µ' ? '#f59e0b' : statusText === '–í—ã–ø–ª–∞—á–µ–Ω–æ' ? '#10b981' : statusText === '–û—Ç–∫–ª–æ–Ω–µ–Ω–æ' ? '#ef4444' : '#94a3b8';
                        return `
                            <div style="background:rgba(0,0,0,0.2);padding:10px;border-radius:8px;margin-bottom:8px;">
                                <div style="display:flex;justify-content:space-between;margin-bottom:5px;">
                                    <span style="font-size:12px;font-weight:600;">${statusEmoji} $${Math.floor(w.amount || 0)}</span>
                                    <span style="font-size:11px;opacity:0.7;">${date.toLocaleDateString('ru')}</span>
                                </div>
                                <div style="font-size:10px;opacity:0.6;margin-bottom:5px;">${w.address ? (w.address.substring(0,10) + '...') : ''}</div>
                                <div style="font-size:10px;color:${statusColor};font-weight:600;">${statusText}</div>
                            </div>
                        `;
                    }).join('');
                } else {
                    historyDiv.innerHTML = '<div style="text-align:center;opacity:0.5;font-size:12px;padding:10px;">–ò—Å—Ç–æ—Ä–∏—è –ø—É—Å—Ç–∞</div>';
                }
            })
            .catch(err => {
                console.error('Error loading history:', err);
                const historyDiv = document.getElementById('withdrawHistory');
                if(historyDiv) {
                    historyDiv.innerHTML = '<div style="text-align:center;opacity:0.5;font-size:12px;padding:10px;">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏</div>';
                }
            });
        }

        function updateUSDTAmount() {
            const amount = parseInt(document.getElementById('quanhashAmount').value) || 500000;
            const usdtAmount = amount / 500000;
            document.getElementById('usdtAmount').textContent = `–ü–æ–ª—É—á–∏—Ç–µ: $${usdtAmount.toFixed(2)} USDT`;
        }
        
        function withdraw() {
            const address = document.getElementById('usdtAddress').value.trim();
            const amount = parseInt(document.getElementById('quanhashAmount').value) || 500000;
            
            if (!address || !address.match(/^0x[a-fA-F0-9]{40}$/)) {
                tg.showAlert('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π BEP20 –∞–¥—Ä–µ—Å');
                return;
            }
            
            if (amount < 500000) {
                tg.showAlert('‚ö†Ô∏è –ú–∏–Ω–∏–º—É–º 500,000 QuanHash');
                return;
            }

            fetch('/api/withdraw', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: user?.id, 
                    address: address,
                    amount: amount
                })
            })
            .then(res => res.json())
            .then(data => {
                if (data.success) {
                    tg.showAlert('‚úÖ –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!');
                    loadData();
                    // Reload withdrawal history after successful request
                    setTimeout(() => {
                        openWithdrawModal({preventDefault: () => {}});
                    }, 500);
                } else {
                    tg.showAlert('‚ö†Ô∏è ' + data.error);
                }
            });
        }

        function closeModal(modalId) {
            document.getElementById(modalId).classList.remove('active');
        }

        loadData();
        checkOfflineIncome();
        startEnergyRegen();
        startAutoTap();
        updateSupportBadge();
        
        // Create loadUserDataOnly function to update stats without flickering autobot
        function loadUserDataOnly() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                // Update only stats, don't touch autobot button
                const coins = Math.floor(data.coins || 0);
                const quanhash = Math.floor(data.quanhash || 0);
                const energy = parseInt(data.energy || 0);
                const maxEnergy = parseInt(data.max_energy || 1000);
                const passiveCoins = Math.floor(data.passive_coins_per_hour || 0);
                const passiveHash = Math.floor(data.passive_hash_per_hour || 0);
                
                document.getElementById('coins').textContent = coins.toLocaleString();
                document.getElementById('quanhash').textContent = quanhash.toLocaleString();
                document.getElementById('energy-text').textContent = `${energy}/${maxEnergy}`;
                document.getElementById('passiveCoins').textContent = `+${passiveCoins.toLocaleString()}/—á–∞—Å`;
                document.getElementById('passiveHash').textContent = `+${passiveHash.toLocaleString()}/—á–∞—Å`;
                
                const energyPercent = Math.min(100, Math.max(0, (energy / maxEnergy) * 100));
                const fillBar = document.getElementById('energy-bar-fill');
                const percentText = document.getElementById('energy-percent');
                if (fillBar) {
                    fillBar.style.width = energyPercent + '%';
                }
                if (percentText) {
                    percentText.textContent = Math.round(energyPercent) + '%';
                }
            })
            .catch(err => console.error('Error:', err));
        }
        
        // Auto-update data every 2 seconds
        setInterval(() => {
            loadUserDataOnly();
        }, 2000);
        
        // Update support badge every 5 seconds
        setInterval(() => {
            updateSupportBadge();
        }, 5000);
        
        function updateSupportBadge() {
            fetch('/api/user_support', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const answeredTickets = (data.tickets || []).filter(t => t.status === 'answered' && t.answer && !t.is_read).length;
                const badge = document.getElementById('supportBadge');
                if(answeredTickets > 0) {
                    badge.textContent = answeredTickets;
                    badge.style.display = 'inline-block';
                } else {
                    badge.style.display = 'none';
                }
            })
            .catch(() => {});
        }
        
        // Auto-tap function
        function startAutoTap() {
            fetch('/api/user_data', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                // Check if auto tap is enabled and still valid
                const isEnabled = data.auto_tap_enabled;
                const hasMinEnergy = data.energy > 10; // Auto-tap stops at 10 energy
                
                if(isEnabled && hasMinEnergy) {
                    const speed = 1000 / (data.auto_tap_speed || 2); // taps per second
                    if(!window.autoTapInterval) {
                        window.autoTapInterval = setInterval(() => {
                            const energyElement = document.getElementById('energy-text');
                            if(energyElement) {
                                const energy = parseInt(energyElement.textContent.split('/')[0]);
                                // Auto-tap stops at 10 energy, manual taps can go to 0
                                if(energy > 10) {
                                    // Call tap with auto flag but show animation
                                    fetch('/api/tap', {
                                        method: 'POST',
                                        headers: {'Content-Type': 'application/json'},
                                        body: JSON.stringify({user_id: user?.id, is_auto: true})
                                    })
                                    .then(res => res.json())
                                    .then(data => {
                                        if(data.success) {
                                            // Only show animation if no modal is open
                                            const hasOpenModal = document.querySelector('.modal.active');
                                            if (!hasOpenModal) {
                                                const button = document.querySelector('.tap-button');
                                                if(button){
                                                    const rect = button.getBoundingClientRect();
                                                    const centerX = rect.left + rect.width / 2;
                                                    const centerY = rect.top + rect.height / 2;
                                                    
                                                    const coinAnimation = document.createElement('div');
                                                    coinAnimation.className = 'coin-animation';
                                                    coinAnimation.textContent = '+' + data.reward;
                                                    coinAnimation.style.left = centerX + 'px';
                                                    coinAnimation.style.top = centerY + 'px';
                                                    coinAnimation.style.transform = 'translate(-50%, -50%)';
                                                    coinAnimation.style.zIndex = '1000'; // Lower than modals
                                                    document.body.appendChild(coinAnimation);
                                                    setTimeout(() => { 
                                                        if(document.body.contains(coinAnimation)) {
                                                            document.body.removeChild(coinAnimation); 
                                                        }
                                                    }, 2000);
                                                }
                                            }
                                            loadData();
                                        }
                                    });
                                } else {
                                    clearInterval(window.autoTapInterval);
                                    window.autoTapInterval = null;
                                }
                            }
                        }, speed);
                    }
                } else {
                    if(window.autoTapInterval) {
                        clearInterval(window.autoTapInterval);
                        window.autoTapInterval = null;
                    }
                }
            });
        }
        
        // Support functions
        function openSupport(event) {
            event.preventDefault();
            tg.HapticFeedback.impactOccurred('light');
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'supportModal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h2 style="font-size:20px;color:#fff;font-weight:700;">üí¨ –ü–æ–¥–¥–µ—Ä–∂–∫–∞</h2>
                        <button onclick="document.getElementById('supportModal').remove()" style="background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:8px;width:32px;height:32px;color:#fff;cursor:pointer;font-size:18px;">‚úï</button>
                    </div>
                    
                    <div style="margin-bottom:20px;">
                        <label style="display:block;font-size:13px;font-weight:600;margin-bottom:8px;color:#94a3b8;">–¢–µ–º–∞ –æ–±—Ä–∞—â–µ–Ω–∏—è</label>
                        <select id="supportTopic" style="width:100%;padding:14px 16px;background:rgba(0,0,0,0.4);border:2px solid rgba(102,126,234,0.3);border-radius:14px;color:#fff;font-size:14px;outline:none;transition:all 0.3s;">
                            <option value="–û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã">‚ùì –û–±—â–∏–µ –≤–æ–ø—Ä–æ—Å—ã</option>
                            <option value="–ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–ª–∞–Ω—Å–æ–º">üí≥ –ü—Ä–æ–±–ª–µ–º—ã —Å –±–∞–ª–∞–Ω—Å–æ–º</option>
                            <option value="–í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤">üí∏ –í—ã–≤–æ–¥ —Å—Ä–µ–¥—Å—Ç–≤</option>
                            <option value="–ú–∞–π–Ω–∏–Ω–≥">‚ö° –ú–∞–π–Ω–∏–Ω–≥</option>
                            <option value="–ö–∞—Ä—Ç–æ—á–∫–∏">üí≥ –ö–∞—Ä—Ç–æ—á–∫–∏</option>
                            <option value="–†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞">üë• –†–µ—Ñ–µ—Ä–∞–ª—å–Ω–∞—è –ø—Ä–æ–≥—Ä–∞–º–º–∞</option>
                            <option value="–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã">üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã</option>
                            <option value="–ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è">üí° –ü—Ä–µ–¥–ª–æ–∂–µ–Ω–∏—è</option>
                            <option value="–ñ–∞–ª–æ–±—ã">‚ö†Ô∏è –ñ–∞–ª–æ–±—ã</option>
                            <option value="–î—Ä—É–≥–æ–µ">üìù –î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                    
                    <div style="margin-bottom:25px;">
                        <label style="display:block;font-size:13px;font-weight:600;margin-bottom:8px;color:#94a3b8;">–°–æ–æ–±—â–µ–Ω–∏–µ</label>
                        <textarea id="supportMessage" placeholder="–û–ø–∏—à–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–æ –≤–∞—à –≤–æ–ø—Ä–æ—Å –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—É..." rows="5" style="width:100%;padding:14px 16px;background:rgba(0,0,0,0.4);border:2px solid rgba(102,126,234,0.3);border-radius:14px;color:#fff;font-size:14px;outline:none;transition:all 0.3s;resize:vertical;font-family:inherit;"></textarea>
                    </div>
                    
                    <div style="display:flex;gap:12px;">
                        <button onclick="sendSupport()" style="flex:1;padding:16px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:14px;cursor:pointer;font-weight:700;font-size:15px;box-shadow:0 8px 24px rgba(102,126,234,0.4);transition:all 0.3s;">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
                        <button onclick="document.getElementById('supportModal').remove()" style="flex:1;padding:16px;background:rgba(255,255,255,0.1);color:#fff;border:2px solid rgba(255,255,255,0.3);border-radius:14px;cursor:pointer;font-weight:600;font-size:15px;transition:all 0.3s;">–û—Ç–º–µ–Ω–∞</button>
                    </div>
                    
                    <div style="text-align:center;margin-top:20px;padding-top:20px;border-top:1px solid rgba(255,255,255,0.1);">
                        <p style="font-size:11px;opacity:0.5;">‚è±Ô∏è –°—Ä–µ–¥–Ω–µ–µ –≤—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞: 24 —á–∞—Å–∞</p>
                    </div>
                    
                    <button onclick="loadMyTickets()" style="width:100%;margin-top:15px;padding:12px;background:rgba(102,126,234,0.2);color:#667eea;border:1px solid rgba(102,126,234,0.4);border-radius:12px;cursor:pointer;font-weight:600;">üìã –ú–æ–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è</button>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Add focus effects
            const topicSelect = document.getElementById('supportTopic');
            const messageText = document.getElementById('supportMessage');
            
            if(topicSelect) {
                topicSelect.addEventListener('focus', () => {
                    topicSelect.style.borderColor = 'rgba(102,126,234,0.8)';
                    topicSelect.style.boxShadow = '0 0 20px rgba(102,126,234,0.3)';
                });
                topicSelect.addEventListener('blur', () => {
                    topicSelect.style.borderColor = 'rgba(102,126,234,0.3)';
                    topicSelect.style.boxShadow = 'none';
                });
            }
            
            if(messageText) {
                messageText.addEventListener('focus', () => {
                    messageText.style.borderColor = 'rgba(102,126,234,0.8)';
                    messageText.style.boxShadow = '0 0 20px rgba(102,126,234,0.3)';
                });
                messageText.addEventListener('blur', () => {
                    messageText.style.borderColor = 'rgba(102,126,234,0.3)';
                    messageText.style.boxShadow = 'none';
                });
            }
        }
        
        function sendSupport() {
            const topicEl = document.querySelector('[id*="supportTopic"]');
            const messageEl = document.querySelector('[id*="supportMessage"]');
            
            if (!topicEl || !messageEl) {
                console.error('Support form elements not found');
                return;
            }
            
            const topic = topicEl.value;
            const message = messageEl.value;
            
            if (!topic) {
                alert('‚ö†Ô∏è –í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É');
                return;
            }
            
            if (!message) {
                alert('‚ö†Ô∏è –í–≤–µ–¥–∏—Ç–µ —Å–æ–æ–±—â–µ–Ω–∏–µ');
                return;
            }
            
            fetch('/api/support', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({
                    user_id: user?.id,
                    topic: topic,
                    message: message
                })
            })
            .then(res => {
                console.log('Support response status:', res.status);
                return res.json();
            })
            .then(data => {
                console.log('Support response data:', data);
                if (data.success) {
                    alert('‚úÖ –°–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ!');
                    const modal = document.querySelector('#supportModal') || document.querySelector('.modal.active');
                    if (modal) modal.remove();
                } else {
                    alert('‚ùå –û—à–∏–±–∫–∞: ' + (data.error || '–Ω–µ–∏–∑–≤–µ—Å—Ç–Ω–∞—è'));
                }
            })
            .catch(err => {
                console.error('Support send error:', err);
                alert('‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ: ' + err.message);
            });
        }
        
        function loadMyTickets() {
            // Hide badge when opening my tickets
            const badge = document.getElementById('supportBadge');
            badge.style.display = 'none';
            
            // Mark all answered tickets as read
            fetch('/api/mark_tickets_read', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            });
            
            fetch('/api/user_support', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                if(data.tickets && data.tickets.length > 0) {
                    const ticketsList = data.tickets.map(t => `
                        <div style="background:rgba(0,0,0,0.3);padding:15px;border-radius:12px;margin-bottom:10px;border-left:4px solid ${t.status === 'answered' ? '#10b981' : '#f59e0b'};">
                            <div style="display:flex;justify-content:space-between;align-items:start;margin-bottom:10px;">
                                <div>
                                    <div style="font-weight:700;font-size:14px;color:#fff;margin-bottom:4px;">${t.topic}</div>
                                    <div style="font-size:11px;color:#94a3b8;">${new Date(t.created_at).toLocaleString()}</div>
                                </div>
                                <div style="padding:4px 10px;background:${t.status === 'answered' ? 'rgba(16,185,129,0.2)' : 'rgba(245,158,11,0.2)'};border-radius:8px;font-size:11px;font-weight:700;color:${t.status === 'answered' ? '#10b981' : '#f59e0b'};">
                                    ${t.status === 'answered' ? '‚úÖ –ì–æ—Ç–æ–≤–æ' : '‚è≥ –í –ø—Ä–æ—Ü–µ—Å—Å–µ'}
                                </div>
                            </div>
                            <div style="font-size:12px;color:#fff;margin-bottom:10px;opacity:0.9;">${t.message}</div>
                            ${t.answer ? `<div style="background:rgba(16,185,129,0.15);padding:10px;border-radius:8px;margin-top:10px;border-left:3px solid #10b981;"><div style="font-size:11px;color:#10b981;font-weight:700;margin-bottom:6px;">üìù –û—Ç–≤–µ—Ç:</div><div style="font-size:12px;color:#fff;">${t.answer}</div></div>` : ''}
                        </div>
                    `).join('');
                    
                    const modal = document.createElement('div');
                    modal.className = 'modal active';
                    modal.innerHTML = `
                        <div class="modal-content" style="max-width: 400px; max-height: 80vh; overflow-y: auto;">
                            <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                                <h2 style="font-size: 20px; color: #fff;">üìã –ú–æ–∏ –æ–±—Ä–∞—â–µ–Ω–∏—è</h2>
                                <button onclick="this.closest('.modal').remove()" style="background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:8px;width:32px;height:32px;color:#fff;cursor:pointer;font-size:18px;">‚úï</button>
                            </div>
                            <div>${ticketsList}</div>
                        </div>
                    `;
                    document.body.appendChild(modal);
                } else {
                    alert('üì≠ –£ –≤–∞—Å –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—Ä–∞—â–µ–Ω–∏–π');
                }
            })
            .catch(() => alert('‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏'));
        }
    </script>
    
    <script>
        function openDailyBonus(e) {
            e.preventDefault();
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'dailyBonusModal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 400px; max-height: 80vh; overflow-y: auto;">
                    <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;">
                        <h2 style="font-size: 24px; color: #fff;">üéÅ –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–µ –∑–∞–¥–∞–Ω–∏—è</h2>
                        <button onclick="this.closest('.modal').remove()" style="background:rgba(255,255,255,0.1);border:1px solid rgba(255,255,255,0.3);border-radius:8px;width:32px;height:32px;color:#fff;cursor:pointer;font-size:18px;">‚úï</button>
                    </div>
                    <div id="dailyTasksList" style="display:flex;flex-direction:column;gap:15px;"></div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Load daily tasks
            fetch('/api/daily_tasks', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: window.user?.id})
            })
            .then(res => res.json())
            .then(data => {
                const list = document.getElementById('dailyTasksList');
                if(data.tasks && data.tasks.length > 0) {
                    let html = '';
                    
                    // Add VIP tasks section if VIP
                    const checkVIPTasks = () => {
                        fetch('/api/user_data', {
                            method: 'POST',
                            headers: {'Content-Type': 'application/json'},
                            body: JSON.stringify({user_id: window.user?.id})
                        })
                        .then(res => res.json())
                        .then(userData => {
                            const vipLevel = userData.vip_level || 0;
                            if (vipLevel >= 3) {
                                list.innerHTML = `
                                    ${vipLevel >= 4 ? `
                                    <div style="background:linear-gradient(135deg,#ffd700,#ffed4e);padding:15px;border-radius:12px;border:3px solid #ffd700;margin-bottom:15px;">
                                        <div style="font-size:16px;font-weight:800;color:#000;margin-bottom:8px;">üéâ VIP –¢—É—Ä–Ω–∏—Ä</div>
                                        <div style="font-size:12px;color:rgba(0,0,0,0.7);margin-bottom:10px;">–°–æ—Ä–µ–≤–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–ª—å–∫–æ –¥–ª—è VIP! –¢–æ–ø-3 –ø–æ–ª—É—á–∞—é—Ç —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–µ –Ω–∞–≥—Ä–∞–¥—ã.</div>
                                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                            <span style="font-size:13px;color:#000;font-weight:700;">üèÜ –ù–∞–≥—Ä–∞–¥—ã:</span>
                                            <span style="font-size:13px;color:#000;font-weight:800;">500M ü™ô</span>
                                        </div>
                                        <button onclick="joinVIPTournament()" style="width:100%;padding:10px;background:#000;color:#ffd700;border:none;border-radius:8px;font-weight:800;cursor:pointer;">üéØ –£—á–∞—Å—Ç–≤–æ–≤–∞—Ç—å</button>
                                    </div>
                                    ` : ''}
                                    ${vipLevel >= 5 ? `
                                    <div style="background:linear-gradient(135deg,#c084fc,#a78bfa);padding:15px;border-radius:12px;border:3px solid #c084fc;margin-bottom:15px;">
                                        <div style="font-size:16px;font-weight:800;color:#fff;margin-bottom:8px;">üíé Diamond Challenge</div>
                                        <div style="font-size:12px;color:rgba(255,255,255,0.8);margin-bottom:10px;">–≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π —á–µ–ª–ª–µ–Ω–¥–∂ –¥–ª—è Diamond VIP!</div>
                                        <div style="display:flex;justify-content:space-between;margin-bottom:8px;">
                                            <span style="font-size:13px;color:#fff;font-weight:700;">üíé –ë–æ–Ω—É—Å:</span>
                                            <span style="font-size:13px;color:#fff;font-weight:800;">x50 –Ω–∞ 24—á</span>
                                        </div>
                                        <button onclick="activateDiamondChallenge()" style="width:100%;padding:10px;background:#fff;color:#a78bfa;border:none;border-radius:8px;font-weight:800;cursor:pointer;">‚ö° –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
                                    </div>
                                    ` : ''}
                                    ` + list.innerHTML;
                            }
                        });
                    };
                    checkVIPTasks();
                    
                    html += data.tasks.map(task => `
                        <div style="background:rgba(0,0,0,0.3);padding:15px;border-radius:12px;border:2px solid ${task.completed ? 'rgba(74,222,128,0.5)' : 'rgba(102,126,234,0.5)'};">
                            <div style="font-size:18px;font-weight:700;margin-bottom:8px;">${task.emoji} ${task.name}</div>
                            <div style="font-size:12px;color:#94a3b8;margin-bottom:8px;">${task.description}</div>
                            <div style="display:flex;justify-content:space-between;align-items:center;">
                                <div style="font-size:14px;color:${task.completed ? '#4ade80' : '#f093fb'};">${task.completed ? '‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ' : '–ü—Ä–æ–≥—Ä–µ—Å—Å: ' + task.progress + '/' + task.target}</div>
                                <div style="font-size:16px;font-weight:700;">üí∞ +${task.reward}</div>
                            </div>
                            ${task.completed ? '<button onclick="claimReward(' + task.id + ')" style="width:100%;margin-top:10px;padding:10px;background:linear-gradient(135deg,#667eea,#764ba2);color:#fff;border:none;border-radius:10px;cursor:pointer;font-weight:600;">üéÅ –ó–∞–±—Ä–∞—Ç—å –Ω–∞–≥—Ä–∞–¥—É</button>' : ''}
                        </div>
                    `).join('');
                    list.innerHTML = html;
                } else {
                    list.innerHTML = '<p style="text-align:center;opacity:0.7;padding:20px;">–ó–∞–¥–∞–Ω–∏—è –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è...</p>';
                }
            });
        }
        
        function joinVIPTournament() {
            tg.showAlert('üéâ –í—ã –ø—Ä–∏—Å–æ–µ–¥–∏–Ω–∏–ª–∏—Å—å –∫ VIP –¢—É—Ä–Ω–∏—Ä—É! –°—Ä–∞–∑–∏—Ç–µ—Å—å –∑–∞ —Ç–æ–ø-3 –º–µ—Å—Ç–∞!');
        }
        
        function activateDiamondChallenge() {
            tg.showAlert('‚ö° Diamond Challenge –∞–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω! –ü–æ–ª—É—á–∞–π—Ç–µ x50 –±–æ–Ω—É—Å –∫ –¥–æ—Ö–æ–¥–∞–º –Ω–∞ 24 —á–∞—Å–∞!');
        }
        
        function claimReward(taskId) {
            fetch('/api/claim_task', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({user_id: user?.id, task_id: taskId})
            })
            .then(res => res.json())
            .then(data => {
                if(data.success) {
                    openDailyBonus({preventDefault:()=>{}});
                    loadData();
                }
            });
        }
        
        let currentCategory = 'all';
        
        window.openBuyCurrency = function(e) {
            try {
                e.preventDefault();
            } catch(err) {}
            try {
                tg.HapticFeedback.impactOccurred('light');
            } catch(err) {}
            
            // Debug: Create simple modal
            const modal = document.createElement('div');
            modal.className = 'modal active';
            modal.id = 'buyCurrencyModal';
            modal.innerHTML = `
                <div class="modal-content" style="max-width: 420px; max-height: 90vh; overflow-y: auto;background: linear-gradient(135deg, rgba(10, 14, 39, 0.95), rgba(15, 23, 42, 0.95));border-radius: 20px;">
                    <!-- Simple Header -->
                    <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                        <h2 style="font-size: 20px; color: #fff; margin: 0; font-weight: 700;">‚≠ê –ö—É–ø–∏—Ç—å –≤–∞–ª—é—Ç—É</h2>
                        <button onclick="this.closest('.modal').remove()" style="background: rgba(255,255,255,0.1); border: none; border-radius: 8px; width: 32px; height: 32px; color: #fff; cursor: pointer; font-size: 18px;">‚úï</button>
                    </div>
                    
                    <!-- Category Buttons -->
                    <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 8px; margin-bottom: 15px;">
                        <button onclick="filterCategory('starter')" class="category-btn active" style="background: rgba(102,126,234,0.3); border: 2px solid rgba(102,126,234,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">üéØ –°—Ç–∞—Ä—Ç</button>
                        <button onclick="filterCategory('premium')" class="category-btn" style="background: rgba(234,179,8,0.3); border: 2px solid rgba(234,179,8,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">üöÄ –ü—Ä–µ–º–∏—É–º</button>
                        <button onclick="filterCategory('vip')" class="category-btn" style="background: rgba(255,215,0,0.3); border: 2px solid rgba(255,215,0,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">‚≠ê –ü—Ä–µ–º–∏—É–º</button>
                        <button onclick="filterCategory('limited')" class="category-btn" style="background: rgba(255,0,0,0.3); border: 2px solid rgba(255,0,0,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">üîÆ QuanHash</button>
                        <button onclick="filterCategory('ultra')" class="category-btn" style="background: rgba(128,0,128,0.3); border: 2px solid rgba(128,0,128,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">üéÅ –ö–æ–º–±–æ</button>
                        <button onclick="filterCategory('mega')" class="category-btn" style="background: rgba(255,215,0,0.3); border: 2px solid rgba(255,215,0,0.6); padding: 10px; border-radius: 10px; color: #fff; cursor: pointer; font-weight: 700; font-size: 11px;">üëë VIP —Ñ—É–Ω–∫—Ü–∏–∏</button>
                    </div>
                    
                    <div id="currencyProductsList" style="display:flex;flex-direction:column;gap:8px;max-height:60vh;overflow-y:auto;padding-right:5px;">
                        <div data-category="starter" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">üéØ –°–¢–ê–†–¢–û–í–´–ï –ù–ê–ë–û–†–´</div>

                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üåü</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üí´ –ü–µ—Ä–≤—ã–µ —à–∞–≥–∏</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 200,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è —Å—Ç–∞—Ä—Ç–∞ –∏–≥—Ä—ã</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –û—Ç–ª–∏—á–Ω–æ–µ –Ω–∞—á–∞–ª–æ –∏–≥—Ä—ã</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_1')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 50 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚ú®</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">‚ú® –ë–∞–∑–æ–≤—ã–π —Å—Ç–∞—Ä—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ —Ä–æ—Å—Ç–∞</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_2')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 120 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚≠ê</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üåü –ù–∞—á–∞–ª–æ –ø—É—Ç–∏</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 800,000 –∫–æ–∏–Ω–æ–≤ —á—Ç–æ–±—ã –Ω–∞—á–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—é</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –¢–≤—ë—Ä–¥—ã–π —Ñ—É–Ω–¥–∞–º–µ–Ω—Ç</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_3')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 180 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω—ã–π</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 1,000,000 –∫–æ–∏–Ω–æ–≤ - –≤–µ–ª–∏–∫–æ–ª–µ–ø–Ω—ã–π —Å—Ç–∞—Ä—Ç</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ VIP –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_4')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 240 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üéÅ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üéÅ –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 1,500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –º–æ—â–Ω–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –≤—ã–≥–æ–¥–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_5')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 320 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üí∞</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üí∞ –°—Ç–∞—Ä—Ç–æ–≤—ã–π –ø–∞–∫–µ—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 2,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è —Å–µ—Ä—å—ë–∑–Ω–æ–π –∏–≥—Ä—ã</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –°–µ—Ä—å—ë–∑–Ω—ã–π —Å—Ç–∞—Ä—Ç</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_6')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 400 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚ö°</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 2,500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –º–æ–ª–Ω–∏–µ–Ω–æ—Å–Ω–æ–≥–æ —Ä–æ—Å—Ç–∞</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_7')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 480 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üéØ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üéØ –ü–µ—Ä–≤—ã–π —à–∞–≥</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 3,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è —É–≤–µ—Ä–µ–Ω–Ω–æ–≥–æ –Ω–∞—á–∞–ª–∞</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –¢–æ—á–Ω–æ–µ –ø–æ–ø–∞–¥–∞–Ω–∏–µ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_8')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 560 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üåà</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üåà –†–∞–¥—É–∂–Ω—ã–π –Ω–∞–±–æ—Ä</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 3,500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è —è—Ä–∫–æ–≥–æ —Å—Ç–∞—Ä—Ç–∞</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –†–∞–∑–Ω–æ—Ü–≤–µ—Ç–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_9')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 640 ‚≠ê</button>
                        </div>
                        
                        <div data-category="starter" style="background:rgba(102,126,234,0.25);padding:12px;border-radius:10px;border:1px solid rgba(102,126,234,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üí´</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üí´ –í–æ–ª—à–µ–±–Ω—ã–π —Å—Ç–∞—Ä—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 4,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ –Ω–∞—á–∞–ª–∞</div>
                                    <div style="font-size:10px;color:102,126,234;margin-top:4px;">‚úÖ –í–æ–ª—à–µ–±–Ω–∞—è —Å–∏–ª–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_10')" style="width:100%;padding:9px;background:linear-gradient(135deg,#667eea,#667eea);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 720 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">üöÄ –ü–†–ï–ú–ò–£–ú –ù–ê–ë–û–†–´</div>

                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚ö°</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">‚ö° –°–≤–µ—Ç–æ–≤–æ–π –ø–∞–∫–µ—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 1,500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è —è—Ä–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –°–≤–µ—Ç–æ–≤–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_11')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 300 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üéØ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üéØ –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 3,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –ø—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–æ–π –∏–≥—Ä—ã</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –¢–æ—á–Ω–æ—Å—Ç—å –º–∞—Å—Ç–µ—Ä–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_12')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 600 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üöÄ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üöÄ –ú–æ—â–Ω—ã–π –Ω–∞–±–æ—Ä</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 4,500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –º–æ—â–Ω–æ–≥–æ —Ä—ã–≤–∫–∞</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –†–∞–∫–µ—Ç–Ω—ã–π —Å—Ç–∞—Ä—Ç</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_13')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 900 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé –ê–ª–º–∞–∑–Ω—ã–π –ø–∞–∫–µ—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 6,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –∞–ª–º–∞–∑–Ω–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –ê–ª–º–∞–∑–Ω–∞—è –ø—Ä–æ—á–Ω–æ—Å—Ç—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_14')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 1200 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üî•</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üî• –û–≥–Ω–µ–Ω–Ω—ã–π –Ω–∞–±–æ—Ä</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 7,500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –æ–≥–Ω–µ–Ω–Ω–æ–π –º–æ—â–∏</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –ü—ã–ª–∞—é—â–∞—è —ç–Ω–µ—Ä–≥–∏—è</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_15')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 1500 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚ö°</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">‚ö° –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω—ã–π</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 9,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è —ç–ª–µ–∫—Ç—Ä–æ–Ω–Ω–æ–≥–æ –±—É—Å—Ç–∞</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –≠–ª–µ–∫—Ç—Ä–∏—á–µ—Å–∫–∞—è –º–æ—â—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_16')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 1800 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üåü</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üåü –ó–≤—ë–∑–¥–Ω—ã–π –ø–∞–∫–µ—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 10,500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –∑–≤—ë–∑–¥–Ω–æ–≥–æ —É—Ä–æ–≤–Ω—è</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –ó–≤—ë–∑–¥–Ω–∞—è —Å–ª–∞–≤–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_17')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 2100 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üí´</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üí´ –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 12,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –∫–æ—Å–º–∏—á–µ—Å–∫–æ–≥–æ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_18')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 2400 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üéÅ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üéÅ –ü–æ–¥–∞—Ä–æ—á–Ω—ã–π VIP</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 13,500,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è VIP —Å—Ç–∞—Ç—É—Å–∞</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ VIP –ø–æ–¥–∞—Ä–æ–∫</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_19')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 2700 ‚≠ê</button>
                        </div>
                        
                        <div data-category="premium" style="background:rgba(234,179,8,0.25);padding:12px;border-radius:10px;border:1px solid rgba(234,179,8,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üîÆ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üîÆ –ú–∞–≥–∏—á–µ—Å–∫–∏–π</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 15,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –º–∞–≥–∏—á–µ—Å–∫–æ–≥–æ —Ä–æ—Å—Ç–∞</div>
                                    <div style="font-size:10px;color:234,179,8;margin-top:4px;">‚úÖ –ú–∞–≥–∏—á–µ—Å–∫–∞—è —Å–∏–ª–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_20')" style="width:100%;padding:9px;background:linear-gradient(135deg,#f59e0b,#f59e0b);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 3000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">‚≠ê –ü–†–ï–ú–ò–£–ú –§–£–ù–ö–¶–ò–ò</div>

                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé VIP —Å—Ç–∞—Ä—Ç–æ–≤—ã–π</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 5,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –Ω–∞—á–∞–ª–∞ VIP –ø—É—Ç–∏</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –°—Ç–∞—Ä—Ç–æ–≤—ã–π –±–æ–Ω—É—Å –≤–∫–ª—é—á—ë–Ω</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_21')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 1000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üöÄ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üöÄ VIP —É—Å–∫–æ—Ä–µ–Ω–∏–µ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 8,000,000 –∫–æ–∏–Ω–æ–≤ + –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –£—Å–∫–æ—Ä–µ–Ω–Ω–æ–µ –Ω–∞—á–∏—Å–ª–µ–Ω–∏–µ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_22')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 1600 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üëë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üëë VIP —Å—Ç–∞—Ç—É—Å</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 12,000,000 –∫–æ–∏–Ω–æ–≤ + —ç–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –±–æ–Ω—É—Å</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –û—Ñ–∏—Ü–∏–∞–ª—å–Ω—ã–π VIP —Å—Ç–∞—Ç—É—Å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_23')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 2400 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚ö°</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">‚ö° VIP —Ç—É—Ä–±–æ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 16,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è —Ç—É—Ä–±–æ —É—Å–∫–æ—Ä–µ–Ω–∏—è</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –¢—É—Ä–±–æ —Ä–µ–∂–∏–º –∞–∫—Ç–∏–≤–µ–Ω</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_24')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 3200 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé VIP –∫–æ—Ä–æ–ª–µ–≤—Å—Ç–≤–æ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 20,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –∫–æ—Ä–æ–ª–µ–≤—Å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ö–æ—Ä–æ–ª–µ–≤—Å–∫–∞—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_25')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 4000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üîì</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üîì VIP –±–µ–∑–ª–∏–º–∏—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 25,000,000 –∫–æ–∏–Ω–æ–≤ + –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π –±–æ–Ω—É—Å</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_26')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 5000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üèÜ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üèÜ VIP —á–µ–º–ø–∏–æ–Ω</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 30,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è —á–µ–º–ø–∏–æ–Ω—Å–∫–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ß–µ–º–ø–∏–æ–Ω—Å–∫–∏–π —É—Ä–æ–≤–µ–Ω—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_27')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 6000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üåü</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üåü VIP –ª–µ–≥–µ–Ω–¥–∞</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 35,000,000 –∫–æ–∏–Ω–æ–≤ –¥–ª—è –ª–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ —Å—Ç–∞—Ç—É—Å–∞</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –º–æ—â—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_28')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 7000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé VIP –∞–ª–º–∞–∑</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 40,000,000 –∫–æ–∏–Ω–æ–≤ + –≤—Å–µ VIP –±–æ–Ω—É—Å—ã</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ê–ª–º–∞–∑–Ω–∞—è –ø—Ä–∏–≤–∏–ª–µ–≥–∏—è</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_29')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 8000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="vip" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üëë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üëë VIP –∏–º–ø–µ—Ä–∞—Ç–æ—Ä</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 45,000,000 –∫–æ–∏–Ω–æ–≤ + –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–µ –ø—Ä–µ–º–∏—É–º –±–æ–Ω—É—Å—ã</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä—Å–∫–∏–π –¥–æ—Å—Ç—É–ø</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_30')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 9000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">üîÆ QUANHASH –ù–ê–ë–û–†–´</div>

                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üîÆ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üîÆ Starter Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 1,000 QuanHash –¥–ª—è –Ω–∞—á–∞–ª–∞ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –°—Ç–∞—Ä—Ç–æ–≤—ã–π –º–∞–π–Ω–∏–Ω–≥</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_31')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 2500 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé Basic Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 5,000 QuanHash –¥–ª—è –±–∞–∑–æ–≤–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –ë–∞–∑–æ–≤—ã–π —Ö—ç—à</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_32')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 3200 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚ö°</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">‚ö° Power Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 10,000 QuanHash –¥–ª—è –º–æ—â–Ω–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –ú–æ—â–Ω—ã–π —Ö—ç—à</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_33')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 3900 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üî•</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üî• Fire Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 15,000 QuanHash –¥–ª—è –æ–≥–Ω–µ–Ω–Ω–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –û–≥–Ω–µ–Ω–Ω–∞—è –º–æ—â–Ω–æ—Å—Ç—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_34')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 4600 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üí•</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üí• Blast Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 25,000 QuanHash –¥–ª—è –≤–∑—Ä—ã–≤–Ω–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –í–∑—Ä—ã–≤–Ω–æ–π –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_35')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 5300 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üåü</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üåü Stellar Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 50,000 QuanHash –¥–ª—è –∑–≤—ë–∑–¥–Ω–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –ó–≤—ë–∑–¥–Ω–∞—è —Å–∫–æ—Ä–æ—Å—Ç—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_36')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 6000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé Diamond Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 100,000 QuanHash –¥–ª—è –∞–ª–º–∞–∑–Ω–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –ê–ª–º–∞–∑–Ω–∞—è –ø—Ä–æ—á–Ω–æ—Å—Ç—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_37')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 6700 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üöÄ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üöÄ Rocket Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 250,000 QuanHash –¥–ª—è —Ä–∞–∫–µ—Ç–Ω–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –†–∞–∫–µ—Ç–Ω–∞—è –º–æ—â—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_38')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 7400 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üëë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üëë Crown Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 500,000 QuanHash –¥–ª—è –∫–æ—Ä–æ–ª–µ–≤—Å–∫–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π —Ö—ç—à</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_39')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 8100 ‚≠ê</button>
                        </div>
                        
                        <div data-category="limited" style="background:rgba(255,0,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,0,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üí´</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üí´ Ultimate Hash</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 1,000,000 QuanHash –¥–ª—è –∞–±—Å–æ–ª—é—Ç–Ω–æ–≥–æ –º–∞–π–Ω–∏–Ω–≥–∞</div>
                                    <div style="font-size:10px;color:255,0,0;margin-top:4px;">‚úÖ –£–ª—å—Ç–∏–º–µ–π—Ç –º–æ—â—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_40')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ff0000,#ff0000);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 9000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">üéÅ –ö–û–ú–ë–û –°–ï–¢–´</div>

                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üéÅ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üéÅ –°—Ç–∞—Ä—Ç–æ–≤—ã–π –º–µ–≥–∞—Å–µ—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 10 –∫–∞—Ä—Ç–æ—á–µ–∫ + 1,000,000 –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –°—Ç–∞—Ä—Ç–æ–≤—ã–π –∫–æ–º–±–æ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_41')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 5000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üî•</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üî• –ì–æ—Ä—è—á–∏–π –∫–æ–º–±–æ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 20 –∫–∞—Ä—Ç–æ—á–µ–∫ + 10,000,000 –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –ì–æ—Ä—è—á–∞—è —Å–≤—è–∑–∫–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_42')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 7000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé –≠–ª–∏—Ç–Ω—ã–π –Ω–∞–±–æ—Ä</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 50 –∫–∞—Ä—Ç–æ—á–µ–∫ + 50,000,000 –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –≠–ª–∏—Ç–Ω–∞—è –∫–æ–º–±–∏–Ω–∞—Ü–∏—è</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_43')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 9000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üöÄ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üöÄ –ú–µ–≥–∞ —Å–≤—è–∑–∫–∞</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 100 –∫–∞—Ä—Ç–æ—á–µ–∫ + 100,000,000 –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –ú–µ–≥–∞ —Å–∏–ª–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_44')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 11000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üåü</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üåü –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω—ã–π –º–µ–≥–∞—Å–µ—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü–æ–ª—É—á–∏—Ç–µ 200 –∫–∞—Ä—Ç–æ—á–µ–∫ + 200,000,000 –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–∞—è –º–æ—â—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_45')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 13000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé –ë—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤–∞—è —Å–≤—è–∑–∫–∞</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">VIP –∫–∞—Ä—Ç—ã + –±–µ–∑–ª–∏–º–∏—Ç–Ω—ã–µ –±–æ–Ω—É—Å—ã + 75M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –ë—Ä–∏–ª–ª–∏–∞–Ω—Ç–æ–≤—ã–π –ø–∞–∫–µ—Ç</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_46')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 15000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üëë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üëë –ö–æ—Ä–æ–ª–µ–≤—Å–∫–∏–π –∫–æ–º–±–æ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">300 –∫–∞—Ä—Ç–æ—á–µ–∫ + VIP –¥–æ—Å—Ç—É–ø + 85M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –ö–æ—Ä–æ–ª–µ–≤—Å–∫–∞—è –º–æ—â—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_47')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 17000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üî•</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üî• –û–≥–Ω–µ–Ω–Ω—ã–π –º–µ–≥–∞—Å–µ—Ç</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">500 –∫–∞—Ä—Ç–æ—á–µ–∫ + 500,000,000 –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –û–≥–Ω–µ–Ω–Ω–∞—è –º–æ—â—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_48')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 19000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üí´</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üí´ –ö–æ—Å–º–∏—á–µ—Å–∫–∏–π –∫–æ–º–±–æ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">1000 –∫–∞—Ä—Ç–æ—á–µ–∫ + –≤—Å—ë VIP + 105M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –ö–æ—Å–º–∏—á–µ—Å–∫–∞—è —Å–∏–ª–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_49')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 21000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="ultra" style="background:rgba(128,0,128,0.25);padding:12px;border-radius:10px;border:1px solid rgba(128,0,128,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üéØ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üéØ –ê–ë–°–û–õ–Æ–¢ –í–°–Å</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–í–°–Å —á—Ç–æ –µ—Å—Ç—å –≤ –∏–≥—Ä–µ! –ê–±—Å–æ–ª—é—Ç–Ω—ã–π –ø–∞–∫–µ—Ç</div>
                                    <div style="font-size:10px;color:128,0,128;margin-top:4px;">‚úÖ –ê–±—Å–æ–ª—é—Ç–Ω–∞—è –º–æ—â—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_50')" style="width:100%;padding:9px;background:linear-gradient(135deg,#800080,#800080);color:#fff;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 24000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="display:block;text-align:center;font-size:13px;font-weight:700;color:#fff;margin:8px 0 4px;">üëë VIP –§–£–ù–ö–¶–ò–ò</div>

                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üëë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üëë VIP –í—Å—ë –≤–∫–ª—é—á–µ–Ω–æ</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ + —ç–∫—Å–∫–ª—é–∑–∏–≤ + 50M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –°–∫–∏–¥–∫–∞ 50%</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_51')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 5000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚≠ê</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">‚≠ê –≠–∫—Å–∫–ª—é–∑–∏–≤–Ω—ã–π –±–µ–π–¥–∂</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–£–Ω–∏–∫–∞–ª—å–Ω–∞—è –º–µ—Ç–∫–∞ –ø—Ä–æ—Ñ–∏–ª—è + 100M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –í—ã–¥–µ–ª—è–π—Å—è</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_52')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 2500 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üèÜ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üèÜ –ì–∞—Ä–∞–Ω—Ç–∏—Ä–æ–≤–∞–Ω —Ç–æ–ø</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ú–µ—Å—Ç–æ –≤ —Ç–æ–ø-100 –∏–≥—Ä–æ–∫–æ–≤ + 150M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ù–∞–≤—Å–µ–≥–¥–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_53')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 4000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">‚ö°</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">‚ö° –ú–≥–Ω–æ–≤–µ–Ω–Ω—ã–π –¥–æ—Ö–æ–¥</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–£—Å–∫–æ—Ä–µ–Ω–∏–µ x100 + 200M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ú–∞–∫—Å–∏–º—É–º –≤—ã–≥–æ–¥–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_54')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 6000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üîì</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üîì –°–Ω—è—Ç—å –ª–∏–º–∏—Ç—ã</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ù–∏–∫–∞–∫–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π + 250M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ë–µ—Å–∫–æ–Ω–µ—á–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_55')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 8000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üöÄ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üöÄ –ê–≤—Ç–æ–ø—Ä–æ–∫–∞—á–∫–∞</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–í—Å—ë –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ + 300M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ë–µ–∑ —É—á–∞—Å—Ç–∏—è</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_56')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 10000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üíé</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üíé –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –ø–æ–º–æ—â—å</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">VIP –ø–æ–¥–¥–µ—Ä–∂–∫–∞ 24/7 + 350M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ü–µ—Ä–≤—ã–º –æ—Ç–≤–µ—á–∞–µ–º</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_57')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 3500 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üëë</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üëë –ó–æ–ª–æ—Ç–æ–π –ø—Ä–æ—Ñ–∏–ª—å</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–£–Ω–∏–∫–∞–ª—å–Ω—ã–π –¥–∏–∑–∞–π–Ω –ø—Ä–æ—Ñ–∏–ª—è + 400M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ò–º–ø–µ—Ä–∞—Ç–æ—Ä—Å–∫–∏–π —Å—Ç–∏–ª—å</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_58')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 4500 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üåü</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üåü –°—É–ø–µ—Ä —Å—Ç–∞—Ç—É—Å</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–ü—Ä–µ–º–∏—É–º –ø—Ä–∞–≤–∞ –≤–µ–∑–¥–µ + 450M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –í—Å—ë —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_59')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 7000 ‚≠ê</button>
                        </div>
                        
                        <div data-category="mega" style="background:rgba(255,215,0,0.25);padding:12px;border-radius:10px;border:1px solid rgba(255,215,0,0.5);">
                            <div style="display:flex;align-items:center;gap:10px;margin-bottom:8px;">
                                <div style="font-size:32px;">üéØ</div>
                                <div style="flex:1;">
                                    <div style="font-size:15px;font-weight:700;color:#fff;">üéØ –ê–ë–°–û–õ–Æ–¢ –í–°–Å VIP</div>
                                    <div style="font-size:11px;color:#94a3b8;margin-top:4px;">–í—Å–µ –ø—Ä–µ–º–∏—É–º —Å—Ä–∞–∑—É + 500M –∫–æ–∏–Ω–æ–≤</div>
                                    <div style="font-size:10px;color:255,215,0;margin-top:4px;">‚úÖ –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è —Å–∫–∏–¥–∫–∞</div>
                                </div>
                            </div>
                            <button onclick="window.open('https://t.me/qanexus_bot?start=buy_stars_60')" style="width:100%;padding:9px;background:linear-gradient(135deg,#ffd700,#ffd700);color:#000;border:none;border-radius:8px;cursor:pointer;font-weight:700;font-size:12px;">üí∞ 15000 ‚≠ê</button>
                        </div>
                        
                    </div>
                </div>
            `;
            document.body.appendChild(modal);
            
            // Set initial active category after modal is attached
            setTimeout(() => window.filterCategory('starter'), 100);
        }
        
        window.filterCategory = function(category) {
            try {
                // Update button states
                document.querySelectorAll('#buyCurrencyModal .category-btn').forEach(btn => {
                    btn.classList.remove('active');
                });
                if(event?.target) {
                    event.target.classList.add('active');
                }
                
                // Filter and show products
                const products = document.querySelectorAll('#currencyProductsList [data-category]');
                products.forEach(product => {
                    if(product.dataset.category === category) {
                        product.style.display = 'block';
                    } else {
                        product.style.display = 'none';
                    }
                });
            } catch(err) {
                console.error('filterCategory error:', err);
            }
        }
    </script>
</body>
</html>